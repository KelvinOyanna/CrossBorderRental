[0m12:41:49.843382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ec3c2cad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ec3d46810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ec3fd0a70>]}


============================== 12:41:49.851045 | 1d9f8f3f-4649-404d-90b6-c8b628c30933 ==============================
[0m12:41:49.851045 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:41:49.851885 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/gitpod/.dbt', 'log_path': 'logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt init crossborder_sql', 'send_anonymous_usage_stats': 'True'}
[0m12:41:49.852632 [warn ] [MainThread]: [ConfigFolderDirectory]: Unable to parse dict {'dir': PosixPath('/home/gitpod/.dbt')}
[0m12:41:49.853228 [info ] [MainThread]: Creating dbt configuration folder at 
[0m12:41:49.854384 [debug] [MainThread]: Starter project path: /workspace/.pyenv_mirror/user/current/lib/python3.12/site-packages/dbt/include/starter_project
[0m12:41:49.857606 [info ] [MainThread]: 
Your new dbt project "crossborder_sql" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m12:41:49.858244 [info ] [MainThread]: Setting up your profile.
[0m12:41:59.617357 [error] [MainThread]: Encountered an error:

[0m12:41:59.621017 [error] [MainThread]: Traceback (most recent call last):
  File "/workspace/.pyenv_mirror/user/current/lib/python3.12/site-packages/dbt/cli/requires.py", line 91, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.12/site-packages/dbt/cli/requires.py", line 76, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.12/site-packages/dbt/cli/main.py", line 515, in init
    results = task.run()
              ^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.12/site-packages/dbt/task/init.py", line 344, in run
    self.setup_profile(profile_name)
  File "/workspace/.pyenv_mirror/user/current/lib/python3.12/site-packages/dbt/task/init.py", line 264, in setup_profile
    self.create_profile_from_target(adapter, profile_name=profile_name)
  File "/workspace/.pyenv_mirror/user/current/lib/python3.12/site-packages/dbt/task/init.py", line 181, in create_profile_from_target
    self.create_profile_from_profile_template(profile_template, profile_name)
  File "/workspace/.pyenv_mirror/user/current/lib/python3.12/site-packages/dbt/task/init.py", line 165, in create_profile_from_profile_template
    target = self.generate_target_from_input(prompts, initial_target)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.12/site-packages/dbt/task/init.py", line 131, in generate_target_from_input
    target[key] = click.prompt(
                  ^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.12/site-packages/click/termui.py", line 164, in prompt
    value = prompt_func(prompt)
            ^^^^^^^^^^^^^^^^^^^
  File "/workspace/.pyenv_mirror/user/current/lib/python3.12/site-packages/click/termui.py", line 147, in prompt_func
    raise Abort() from None
click.exceptions.Abort

[0m12:41:59.623710 [debug] [MainThread]: Resource report: {"command_name": "init", "command_wall_clock_time": 9.783747, "process_user_time": 2.634841, "process_kernel_time": 0.140364, "process_mem_max_rss": "108464", "process_in_blocks": "31432", "process_out_blocks": "80", "command_success": false}
[0m12:41:59.625037 [debug] [MainThread]: Command `dbt init` failed at 12:41:59.624700 after 9.79 seconds
[0m12:41:59.626044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ec3e34560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ec2e4f770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f5ec2c6f4a0>]}
[0m12:41:59.627103 [debug] [MainThread]: Flushing usage events
[0m12:50:36.505619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd45c69cb30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd45c8f6300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd45c69ccb0>]}


============================== 12:50:36.510402 | f2d3a911-f3f6-4c8d-bea9-3bf3b3603e9d ==============================
[0m12:50:36.510402 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:50:36.511250 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'logs', 'profiles_dir': '/home/gitpod/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt init crossborder_sql', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m12:50:36.512450 [info ] [MainThread]: A project called crossborder_sql already exists here.
[0m12:50:36.513563 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": true, "command_wall_clock_time": 0.011250239, "process_user_time": 2.502316, "process_kernel_time": 0.135691, "process_mem_max_rss": "92360", "process_in_blocks": "24080", "process_out_blocks": "8"}
[0m12:50:36.514393 [debug] [MainThread]: Command `dbt init` succeeded at 12:50:36.514168 after 0.01 seconds
[0m12:50:36.515033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd46047bdd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd45e0516a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7fd45c7b4230>]}
[0m12:50:36.515688 [debug] [MainThread]: Flushing usage events
[0m12:51:02.521241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b1f3a0a70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b1f484b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b1f5e8b60>]}


============================== 12:51:02.529796 | 0fb73640-f36e-45d8-bcaa-8f2dfb68dd87 ==============================
[0m12:51:02.529796 [info ] [MainThread]: Running with dbt=1.7.10
[0m12:51:02.531226 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/gitpod/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt debug', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m12:51:02.532756 [info ] [MainThread]: dbt version: 1.7.10
[0m12:51:02.533841 [info ] [MainThread]: python version: 3.12.2
[0m12:51:02.534878 [info ] [MainThread]: python path: /home/gitpod/.pyenv/versions/3.12.2/bin/python3.12
[0m12:51:02.535918 [info ] [MainThread]: os info: Linux-6.1.75-060175-generic-x86_64-with-glibc2.35
[0m12:51:02.537053 [info ] [MainThread]: Using profiles dir at /home/gitpod/.dbt
[0m12:51:02.538116 [info ] [MainThread]: Using profiles.yml file at /home/gitpod/.dbt/profiles.yml
[0m12:51:02.539029 [info ] [MainThread]: Using dbt_project.yml file at /workspace/crossborder_project/dbt_project.yml
[0m12:51:02.539830 [info ] [MainThread]: Configuration:
[0m12:51:02.540862 [info ] [MainThread]:   profiles.yml file [[31mERROR not found[0m]
[0m12:51:02.541805 [info ] [MainThread]:   dbt_project.yml file [[31mERROR not found[0m]
[0m12:51:02.542690 [info ] [MainThread]: Required dependencies:
[0m12:51:02.543665 [debug] [MainThread]: Executing "git --help"
[0m12:51:02.547871 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m12:51:02.549054 [debug] [MainThread]: STDERR: "b''"
[0m12:51:02.550047 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m12:51:02.551019 [info ] [MainThread]: Connection test skipped since no profile was found
[0m12:51:02.552150 [info ] [MainThread]: [31m2 checks failed:[0m
[0m12:51:02.553270 [info ] [MainThread]: dbt looked for a profiles.yml file in /home/gitpod/.dbt/profiles.yml, but did
not find one. For more information on configuring your profile, consult the
documentation:

https://docs.getdbt.com/docs/configure-your-profile


[0m12:51:02.554388 [info ] [MainThread]: Project loading failed for the following reason:
 project path </workspace/crossborder_project/dbt_project.yml> not found

[0m12:51:02.556237 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_wall_clock_time": 0.04061616, "process_user_time": 2.862227, "process_kernel_time": 0.196152, "process_mem_max_rss": "92172", "process_in_blocks": "11896", "process_out_blocks": "24", "command_success": false}
[0m12:51:02.557589 [debug] [MainThread]: Command `dbt debug` failed at 12:51:02.557215 after 0.04 seconds
[0m12:51:02.558693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b1f5ebd70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b1f60c950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x7f1b1f60f9e0>]}
[0m12:51:02.559823 [debug] [MainThread]: Flushing usage events
[0m04:25:30.760456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e57510>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e5c7d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e89d50>]}


============================== 04:25:30.765703 | 34b3e78b-a060-4814-b6fd-1ef77785852a ==============================
[0m04:25:30.765703 [info ] [MainThread]: Running with dbt=1.8.1
[0m04:25:30.768942 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/kelvin/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/kelvin/Documents/DBTProjects/CrossBorder/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt debug', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:25:30.783086 [info ] [MainThread]: dbt version: 1.8.1
[0m04:25:30.783481 [info ] [MainThread]: python version: 3.11.5
[0m04:25:30.783734 [info ] [MainThread]: python path: /Users/kelvin/Documents/DBTProjects/dbt-env/bin/python
[0m04:25:30.784271 [info ] [MainThread]: os info: macOS-14.4-arm64-arm-64bit
[0m04:25:31.206993 [info ] [MainThread]: Using profiles dir at /Users/kelvin/.dbt
[0m04:25:31.207407 [info ] [MainThread]: Using profiles.yml file at /Users/kelvin/.dbt/profiles.yml
[0m04:25:31.207614 [info ] [MainThread]: Using dbt_project.yml file at /Users/kelvin/Documents/DBTProjects/CrossBorder/dbt_project.yml
[0m04:25:31.207981 [info ] [MainThread]: adapter type: postgres
[0m04:25:31.208168 [info ] [MainThread]: adapter version: 1.8.1
[0m04:25:31.259483 [info ] [MainThread]: Configuration:
[0m04:25:31.259951 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m04:25:31.260146 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m04:25:31.260314 [info ] [MainThread]: Required dependencies:
[0m04:25:31.260943 [debug] [MainThread]: Executing "git --help"
[0m04:25:31.282426 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m04:25:31.283366 [debug] [MainThread]: STDERR: "b''"
[0m04:25:31.283646 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m04:25:31.284047 [info ] [MainThread]: Connection:
[0m04:25:31.284401 [info ] [MainThread]:   host: localhost
[0m04:25:31.284680 [info ] [MainThread]:   port: 5432
[0m04:25:31.284944 [info ] [MainThread]:   user: postgres
[0m04:25:31.285107 [info ] [MainThread]:   database: dvdrental
[0m04:25:31.285330 [info ] [MainThread]:   schema: transformation
[0m04:25:31.285500 [info ] [MainThread]:   connect_timeout: 10
[0m04:25:31.285663 [info ] [MainThread]:   role: None
[0m04:25:31.285834 [info ] [MainThread]:   search_path: None
[0m04:25:31.285990 [info ] [MainThread]:   keepalives_idle: 0
[0m04:25:31.286145 [info ] [MainThread]:   sslmode: None
[0m04:25:31.286295 [info ] [MainThread]:   sslcert: None
[0m04:25:31.286519 [info ] [MainThread]:   sslkey: None
[0m04:25:31.286734 [info ] [MainThread]:   sslrootcert: None
[0m04:25:31.286907 [info ] [MainThread]:   application_name: dbt
[0m04:25:31.287064 [info ] [MainThread]:   retries: 1
[0m04:25:31.287560 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m04:25:31.293797 [debug] [MainThread]: Acquiring new postgres connection 'debug'
[0m04:25:31.345014 [debug] [MainThread]: Using postgres connection "debug"
[0m04:25:31.345768 [debug] [MainThread]: On debug: select 1 as id
[0m04:25:31.346039 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:25:31.642589 [debug] [MainThread]: SQL status: SELECT 1 in 0.0 seconds
[0m04:25:31.643856 [debug] [MainThread]: On debug: Close
[0m04:25:31.644255 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m04:25:31.644527 [info ] [MainThread]: [32mAll checks passed![0m
[0m04:25:31.646516 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 1.2052274, "process_user_time": 0.961136, "process_kernel_time": 0.199967, "process_mem_max_rss": "110723072", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m04:25:31.647144 [debug] [MainThread]: Command `dbt debug` succeeded at 04:25:31.647003 after 1.21 seconds
[0m04:25:31.647422 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m04:25:31.647953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111e56910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1036e2110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11293a990>]}
[0m04:25:31.648340 [debug] [MainThread]: Flushing usage events
[0m04:25:50.197089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106618b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10667dbd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10667e2d0>]}


============================== 04:25:50.200632 | d361ecb3-8108-48fc-ad14-0ecd21ef6484 ==============================
[0m04:25:50.200632 [info ] [MainThread]: Running with dbt=1.8.1
[0m04:25:50.201071 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/kelvin/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/kelvin/Documents/DBTProjects/CrossBorder/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:25:50.326526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd361ecb3-8108-48fc-ad14-0ecd21ef6484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1066ff350>]}
[0m04:25:50.357526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd361ecb3-8108-48fc-ad14-0ecd21ef6484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10423ad50>]}
[0m04:25:50.358451 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m04:25:50.376352 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m04:25:50.377190 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m04:25:50.377896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd361ecb3-8108-48fc-ad14-0ecd21ef6484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107214890>]}
[0m04:25:50.975034 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crossborder_sql.core
[0m04:25:50.978463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd361ecb3-8108-48fc-ad14-0ecd21ef6484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c78ad0>]}
[0m04:25:51.088017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd361ecb3-8108-48fc-ad14-0ecd21ef6484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10746f750>]}
[0m04:25:51.088481 [info ] [MainThread]: Found 5 models, 413 macros
[0m04:25:51.088751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd361ecb3-8108-48fc-ad14-0ecd21ef6484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107445250>]}
[0m04:25:51.090132 [info ] [MainThread]: 
[0m04:25:51.091040 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:25:51.094152 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m04:25:51.135111 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m04:25:51.135461 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m04:25:51.135681 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:25:51.184629 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m04:25:51.185799 [debug] [ThreadPool]: On list_dvdrental: Close
[0m04:25:51.186807 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dvdrental, now list_dvdrental_transformation)
[0m04:25:51.191005 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_transformation"
[0m04:25:51.191258 [debug] [ThreadPool]: On list_dvdrental_transformation: BEGIN
[0m04:25:51.191432 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:25:51.199585 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m04:25:51.199955 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_transformation"
[0m04:25:51.200196 [debug] [ThreadPool]: On list_dvdrental_transformation: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "list_dvdrental_transformation"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'transformation'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'transformation'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'transformation'
  
[0m04:25:51.215451 [debug] [ThreadPool]: SQL status: SELECT 0 in 0.0 seconds
[0m04:25:51.216401 [debug] [ThreadPool]: On list_dvdrental_transformation: ROLLBACK
[0m04:25:51.217679 [debug] [ThreadPool]: On list_dvdrental_transformation: Close
[0m04:25:51.220787 [debug] [MainThread]: Using postgres connection "master"
[0m04:25:51.221000 [debug] [MainThread]: On master: BEGIN
[0m04:25:51.221166 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:25:51.231273 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:25:51.231466 [debug] [MainThread]: Using postgres connection "master"
[0m04:25:51.231737 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:25:51.262682 [debug] [MainThread]: SQL status: SELECT 42 in 0.0 seconds
[0m04:25:51.263873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd361ecb3-8108-48fc-ad14-0ecd21ef6484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10424c990>]}
[0m04:25:51.264173 [debug] [MainThread]: On master: ROLLBACK
[0m04:25:51.264493 [debug] [MainThread]: Using postgres connection "master"
[0m04:25:51.264657 [debug] [MainThread]: On master: BEGIN
[0m04:25:51.264975 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:25:51.265142 [debug] [MainThread]: On master: COMMIT
[0m04:25:51.265294 [debug] [MainThread]: Using postgres connection "master"
[0m04:25:51.265447 [debug] [MainThread]: On master: COMMIT
[0m04:25:51.265664 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:25:51.265827 [debug] [MainThread]: On master: Close
[0m04:25:51.266091 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m04:25:51.266288 [info ] [MainThread]: 
[0m04:25:51.268285 [debug] [Thread-1 (]: Began running node model.crossborder.bottom_five_customer_base_by_country
[0m04:25:51.268671 [debug] [Thread-2 (]: Began running node model.crossborder.film_rental_perfomance
[0m04:25:51.268943 [debug] [Thread-3 (]: Began running node model.crossborder.top_five_volume_sales_by_country
[0m04:25:51.269166 [debug] [Thread-4 (]: Began running node model.crossborder.top_loyal_customers
[0m04:25:51.269465 [info ] [Thread-1 (]: 1 of 5 START sql view model transformation.bottom_five_customer_base_by_country  [RUN]
[0m04:25:51.269704 [debug] [Thread-5 (]: Began running node model.crossborder.top_three_in_demand_genres
[0m04:25:51.270009 [info ] [Thread-2 (]: 2 of 5 START sql view model transformation.film_rental_perfomance .............. [RUN]
[0m04:25:51.270305 [info ] [Thread-3 (]: 3 of 5 START sql view model transformation.top_five_volume_sales_by_country .... [RUN]
[0m04:25:51.270595 [info ] [Thread-4 (]: 4 of 5 START sql view model transformation.top_loyal_customers ................. [RUN]
[0m04:25:51.270882 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dvdrental_transformation, now model.crossborder.bottom_five_customer_base_by_country)
[0m04:25:51.271155 [info ] [Thread-5 (]: 5 of 5 START sql view model transformation.top_three_in_demand_genres .......... [RUN]
[0m04:25:51.271471 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.crossborder.film_rental_perfomance'
[0m04:25:51.272103 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.crossborder.top_five_volume_sales_by_country'
[0m04:25:51.272674 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.crossborder.top_loyal_customers'
[0m04:25:51.272951 [debug] [Thread-1 (]: Began compiling node model.crossborder.bottom_five_customer_base_by_country
[0m04:25:51.273275 [debug] [Thread-5 (]: Acquiring new postgres connection 'model.crossborder.top_three_in_demand_genres'
[0m04:25:51.273503 [debug] [Thread-2 (]: Began compiling node model.crossborder.film_rental_perfomance
[0m04:25:51.273712 [debug] [Thread-3 (]: Began compiling node model.crossborder.top_five_volume_sales_by_country
[0m04:25:51.273912 [debug] [Thread-4 (]: Began compiling node model.crossborder.top_loyal_customers
[0m04:25:51.278449 [debug] [Thread-1 (]: Writing injected SQL for node "model.crossborder.bottom_five_customer_base_by_country"
[0m04:25:51.278810 [debug] [Thread-5 (]: Began compiling node model.crossborder.top_three_in_demand_genres
[0m04:25:51.281667 [debug] [Thread-2 (]: Writing injected SQL for node "model.crossborder.film_rental_perfomance"
[0m04:25:51.282722 [debug] [Thread-3 (]: Writing injected SQL for node "model.crossborder.top_five_volume_sales_by_country"
[0m04:25:51.328934 [debug] [Thread-4 (]: Writing injected SQL for node "model.crossborder.top_loyal_customers"
[0m04:25:51.330340 [debug] [Thread-5 (]: Writing injected SQL for node "model.crossborder.top_three_in_demand_genres"
[0m04:25:51.331321 [debug] [Thread-4 (]: Began executing node model.crossborder.top_loyal_customers
[0m04:25:51.331569 [debug] [Thread-5 (]: Began executing node model.crossborder.top_three_in_demand_genres
[0m04:25:51.331813 [debug] [Thread-2 (]: Began executing node model.crossborder.film_rental_perfomance
[0m04:25:51.332086 [debug] [Thread-3 (]: Began executing node model.crossborder.top_five_volume_sales_by_country
[0m04:25:51.345668 [debug] [Thread-1 (]: Began executing node model.crossborder.bottom_five_customer_base_by_country
[0m04:25:51.356433 [debug] [Thread-4 (]: Writing runtime sql for node "model.crossborder.top_loyal_customers"
[0m04:25:51.359276 [debug] [Thread-5 (]: Writing runtime sql for node "model.crossborder.top_three_in_demand_genres"
[0m04:25:51.361640 [debug] [Thread-2 (]: Writing runtime sql for node "model.crossborder.film_rental_perfomance"
[0m04:25:51.363842 [debug] [Thread-3 (]: Writing runtime sql for node "model.crossborder.top_five_volume_sales_by_country"
[0m04:25:51.366114 [debug] [Thread-1 (]: Writing runtime sql for node "model.crossborder.bottom_five_customer_base_by_country"
[0m04:25:51.367541 [debug] [Thread-3 (]: Using postgres connection "model.crossborder.top_five_volume_sales_by_country"
[0m04:25:51.367815 [debug] [Thread-2 (]: Using postgres connection "model.crossborder.film_rental_perfomance"
[0m04:25:51.368054 [debug] [Thread-4 (]: Using postgres connection "model.crossborder.top_loyal_customers"
[0m04:25:51.368311 [debug] [Thread-5 (]: Using postgres connection "model.crossborder.top_three_in_demand_genres"
[0m04:25:51.368560 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.bottom_five_customer_base_by_country"
[0m04:25:51.368796 [debug] [Thread-3 (]: On model.crossborder.top_five_volume_sales_by_country: BEGIN
[0m04:25:51.369043 [debug] [Thread-2 (]: On model.crossborder.film_rental_perfomance: BEGIN
[0m04:25:51.369272 [debug] [Thread-4 (]: On model.crossborder.top_loyal_customers: BEGIN
[0m04:25:51.369500 [debug] [Thread-5 (]: On model.crossborder.top_three_in_demand_genres: BEGIN
[0m04:25:51.369742 [debug] [Thread-1 (]: On model.crossborder.bottom_five_customer_base_by_country: BEGIN
[0m04:25:51.369976 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m04:25:51.370181 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m04:25:51.370396 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m04:25:51.370608 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m04:25:51.370828 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:25:51.464330 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m04:25:51.464700 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.bottom_five_customer_base_by_country"
[0m04:25:51.464950 [debug] [Thread-1 (]: On model.crossborder.bottom_five_customer_base_by_country: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.bottom_five_customer_base_by_country"} */

  create view "dvdrental"."transformation"."bottom_five_customer_base_by_country__dbt_tmp"
    
    
  as (
    with final as (select cntry.country, count(customer_id) as customers
from country cntry
inner join city on cntry.country_id = city.country_id
inner join address addr on city.city_id = addr.city_id
inner join customer cstmr on addr.address_id = cstmr.address_id
group by cntry.country
order by customers
limit 5)

select *
from final
  );
[0m04:25:51.480664 [debug] [Thread-5 (]: SQL status: BEGIN in 0.0 seconds
[0m04:25:51.481033 [debug] [Thread-5 (]: Using postgres connection "model.crossborder.top_three_in_demand_genres"
[0m04:25:51.481302 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m04:25:51.481642 [debug] [Thread-5 (]: On model.crossborder.top_three_in_demand_genres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_three_in_demand_genres"} */

  create view "dvdrental"."transformation"."top_three_in_demand_genres__dbt_tmp"
    
    
  as (
    with final as (
    select distinct ctgry.name as genre,
        count(cstmr.customer_id) as demand, sum(pymnt.amount) as total_sales
from category ctgry
inner join film_category flm_ctgry on ctgry.category_id = flm_ctgry.category_id
inner join film on flm_ctgry.film_id = film.film_id
inner join inventory invtry on film.film_id = invtry.film_id
inner join rental rntl on invtry.inventory_id = rntl.inventory_id
inner join customer cstmr on rntl.customer_id = cstmr.customer_id
inner join payment pymnt on rntl.rental_id = pymnt.rental_id
group by ctgry.category_id, ctgry.name
order by demand desc, total_sales desc
limit 3
)

select *
from final
  );
[0m04:25:51.481886 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m04:25:51.482112 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m04:25:51.482379 [debug] [Thread-2 (]: Using postgres connection "model.crossborder.film_rental_perfomance"
[0m04:25:51.482651 [debug] [Thread-3 (]: Using postgres connection "model.crossborder.top_five_volume_sales_by_country"
[0m04:25:51.483973 [debug] [Thread-3 (]: On model.crossborder.top_five_volume_sales_by_country: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_five_volume_sales_by_country"} */

  create view "dvdrental"."transformation"."top_five_volume_sales_by_country__dbt_tmp"
    
    
  as (
    with final as (
    select cntry.country, sum(pymnt.amount) as vol_sales, count(cstmr.customer_id) as customers
from country cntry
inner join city on cntry.country_id = city.country_id
inner join address addr on city.city_id = addr.city_id
inner join customer cstmr on addr.address_id = cstmr.address_id
inner join payment pymnt on cstmr.customer_id = pymnt.customer_id
group by cntry.country
order by vol_sales desc, customers desc
limit 5
)

select *
from final
  );
[0m04:25:51.482854 [debug] [Thread-4 (]: Using postgres connection "model.crossborder.top_loyal_customers"
[0m04:25:51.484433 [debug] [Thread-4 (]: On model.crossborder.top_loyal_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_loyal_customers"} */

  create view "dvdrental"."transformation"."top_loyal_customers__dbt_tmp"
    
    
  as (
    with final as (
    select distinct concat(cstmr.first_name, ' ', cstmr.last_name) as loyal_customer,
        concat(cntry.country, ' | ', city.city, ', ', addr.address) as full_address,
        
        sum(pymnt.total_amount) as total_payments
from rental rntl
inner join customer cstmr on cstmr.customer_id = rntl.customer_id
inner join address addr on cstmr.address_id = addr.address_id
inner join city on city.city_id = addr.city_id
inner join country cntry on cntry.country_id = city.country_id
group by loyal_customer
order by rentals desc)

select *
from final
  );
[0m04:25:51.483393 [debug] [Thread-2 (]: On model.crossborder.film_rental_perfomance: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.film_rental_perfomance"} */

  create view "dvdrental"."transformation"."film_rental_perfomance__dbt_tmp"
    
    
  as (
    with final as (
    select
        case when datediff(day, rntl.rental_date, rntl.return_date) > flm.rental_duration 
            then 'early_return'
        when datediff(day, rntl.rental_date, rntl.return_date) < flm.rental_duration
            then 'late_return'
        else 'on_time'
        end as rental_return_type,
        
        count(1) as total_rental_status
from rental rntl
inner join inventory invntry on rntl.inventory_id = invntry.inventory_id
inner join film flm on invntry.film_id = flm.film_id
order by rental_performance desc)

select  * 
from final
  );
[0m04:25:51.519269 [debug] [Thread-4 (]: Postgres adapter: Postgres error: missing FROM-clause entry for table "pymnt"
LINE 11:         sum(pymnt.total_amount) as total_payments
                     ^

[0m04:25:51.519629 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "day" does not exist
LINE 9:         case when datediff(day, rntl.rental_date, rntl.retur...
                                   ^

[0m04:25:51.519971 [debug] [Thread-4 (]: On model.crossborder.top_loyal_customers: ROLLBACK
[0m04:25:51.520209 [debug] [Thread-2 (]: On model.crossborder.film_rental_perfomance: ROLLBACK
[0m04:25:51.520706 [debug] [Thread-4 (]: On model.crossborder.top_loyal_customers: Close
[0m04:25:51.521050 [debug] [Thread-2 (]: On model.crossborder.film_rental_perfomance: Close
[0m04:25:51.529060 [debug] [Thread-2 (]: Database Error in model film_rental_perfomance (models/core/film_rental_perfomance.sql)
  column "day" does not exist
  LINE 9:         case when datediff(day, rntl.rental_date, rntl.retur...
                                     ^
  compiled Code at target/run/crossborder/models/core/film_rental_perfomance.sql
[0m04:25:51.530296 [debug] [Thread-4 (]: Database Error in model top_loyal_customers (models/core/top_loyal_customers.sql)
  missing FROM-clause entry for table "pymnt"
  LINE 11:         sum(pymnt.total_amount) as total_payments
                       ^
  compiled Code at target/run/crossborder/models/core/top_loyal_customers.sql
[0m04:25:51.532016 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd361ecb3-8108-48fc-ad14-0ecd21ef6484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107404f50>]}
[0m04:25:51.532372 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd361ecb3-8108-48fc-ad14-0ecd21ef6484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107876510>]}
[0m04:25:51.532947 [error] [Thread-2 (]: 2 of 5 ERROR creating sql view model transformation.film_rental_perfomance ..... [[31mERROR[0m in 0.26s]
[0m04:25:51.533439 [error] [Thread-4 (]: 4 of 5 ERROR creating sql view model transformation.top_loyal_customers ........ [[31mERROR[0m in 0.26s]
[0m04:25:51.533859 [debug] [Thread-2 (]: Finished running node model.crossborder.film_rental_perfomance
[0m04:25:51.534193 [debug] [Thread-4 (]: Finished running node model.crossborder.top_loyal_customers
[0m04:25:51.537591 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m04:25:51.537827 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m04:25:51.543350 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.bottom_five_customer_base_by_country"
[0m04:25:51.543660 [debug] [Thread-5 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m04:25:51.548564 [debug] [Thread-3 (]: Using postgres connection "model.crossborder.top_five_volume_sales_by_country"
[0m04:25:51.549033 [debug] [Thread-1 (]: On model.crossborder.bottom_five_customer_base_by_country: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.bottom_five_customer_base_by_country"} */
alter table "dvdrental"."transformation"."bottom_five_customer_base_by_country__dbt_tmp" rename to "bottom_five_customer_base_by_country"
[0m04:25:51.551069 [debug] [Thread-5 (]: Using postgres connection "model.crossborder.top_three_in_demand_genres"
[0m04:25:51.551342 [debug] [Thread-3 (]: On model.crossborder.top_five_volume_sales_by_country: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_five_volume_sales_by_country"} */
alter table "dvdrental"."transformation"."top_five_volume_sales_by_country__dbt_tmp" rename to "top_five_volume_sales_by_country"
[0m04:25:51.551754 [debug] [Thread-5 (]: On model.crossborder.top_three_in_demand_genres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_three_in_demand_genres"} */
alter table "dvdrental"."transformation"."top_three_in_demand_genres__dbt_tmp" rename to "top_three_in_demand_genres"
[0m04:25:51.553187 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:25:51.559421 [debug] [Thread-5 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:25:51.564641 [debug] [Thread-1 (]: On model.crossborder.bottom_five_customer_base_by_country: COMMIT
[0m04:25:51.565101 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:25:51.566218 [debug] [Thread-5 (]: On model.crossborder.top_three_in_demand_genres: COMMIT
[0m04:25:51.566503 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.bottom_five_customer_base_by_country"
[0m04:25:51.567420 [debug] [Thread-3 (]: On model.crossborder.top_five_volume_sales_by_country: COMMIT
[0m04:25:51.568185 [debug] [Thread-3 (]: Using postgres connection "model.crossborder.top_five_volume_sales_by_country"
[0m04:25:51.567690 [debug] [Thread-5 (]: Using postgres connection "model.crossborder.top_three_in_demand_genres"
[0m04:25:51.568387 [debug] [Thread-3 (]: On model.crossborder.top_five_volume_sales_by_country: COMMIT
[0m04:25:51.567969 [debug] [Thread-1 (]: On model.crossborder.bottom_five_customer_base_by_country: COMMIT
[0m04:25:51.568644 [debug] [Thread-5 (]: On model.crossborder.top_three_in_demand_genres: COMMIT
[0m04:25:51.570254 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m04:25:51.570639 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m04:25:51.570866 [debug] [Thread-5 (]: SQL status: COMMIT in 0.0 seconds
[0m04:25:51.575318 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."transformation"."top_five_volume_sales_by_country__dbt_backup"
[0m04:25:51.576972 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."transformation"."bottom_five_customer_base_by_country__dbt_backup"
[0m04:25:51.578469 [debug] [Thread-5 (]: Applying DROP to: "dvdrental"."transformation"."top_three_in_demand_genres__dbt_backup"
[0m04:25:51.582074 [debug] [Thread-3 (]: Using postgres connection "model.crossborder.top_five_volume_sales_by_country"
[0m04:25:51.582652 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.bottom_five_customer_base_by_country"
[0m04:25:51.583124 [debug] [Thread-5 (]: Using postgres connection "model.crossborder.top_three_in_demand_genres"
[0m04:25:51.583366 [debug] [Thread-3 (]: On model.crossborder.top_five_volume_sales_by_country: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_five_volume_sales_by_country"} */
drop view if exists "dvdrental"."transformation"."top_five_volume_sales_by_country__dbt_backup" cascade
[0m04:25:51.583600 [debug] [Thread-1 (]: On model.crossborder.bottom_five_customer_base_by_country: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.bottom_five_customer_base_by_country"} */
drop view if exists "dvdrental"."transformation"."bottom_five_customer_base_by_country__dbt_backup" cascade
[0m04:25:51.583819 [debug] [Thread-5 (]: On model.crossborder.top_three_in_demand_genres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_three_in_demand_genres"} */
drop view if exists "dvdrental"."transformation"."top_three_in_demand_genres__dbt_backup" cascade
[0m04:25:51.585277 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m04:25:51.585497 [debug] [Thread-5 (]: SQL status: DROP VIEW in 0.0 seconds
[0m04:25:51.585709 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m04:25:51.587327 [debug] [Thread-1 (]: On model.crossborder.bottom_five_customer_base_by_country: Close
[0m04:25:51.588129 [debug] [Thread-5 (]: On model.crossborder.top_three_in_demand_genres: Close
[0m04:25:51.589119 [debug] [Thread-3 (]: On model.crossborder.top_five_volume_sales_by_country: Close
[0m04:25:51.589562 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd361ecb3-8108-48fc-ad14-0ecd21ef6484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10446a750>]}
[0m04:25:51.589873 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd361ecb3-8108-48fc-ad14-0ecd21ef6484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10787dbd0>]}
[0m04:25:51.590153 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd361ecb3-8108-48fc-ad14-0ecd21ef6484', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106395ad0>]}
[0m04:25:51.590584 [info ] [Thread-1 (]: 1 of 5 OK created sql view model transformation.bottom_five_customer_base_by_country  [[32mCREATE VIEW[0m in 0.32s]
[0m04:25:51.591683 [debug] [Thread-1 (]: Finished running node model.crossborder.bottom_five_customer_base_by_country
[0m04:25:51.590945 [info ] [Thread-5 (]: 5 of 5 OK created sql view model transformation.top_three_in_demand_genres ..... [[32mCREATE VIEW[0m in 0.32s]
[0m04:25:51.592182 [debug] [Thread-5 (]: Finished running node model.crossborder.top_three_in_demand_genres
[0m04:25:51.591348 [info ] [Thread-3 (]: 3 of 5 OK created sql view model transformation.top_five_volume_sales_by_country  [[32mCREATE VIEW[0m in 0.32s]
[0m04:25:51.592637 [debug] [Thread-3 (]: Finished running node model.crossborder.top_five_volume_sales_by_country
[0m04:25:51.593656 [debug] [MainThread]: Using postgres connection "master"
[0m04:25:51.593867 [debug] [MainThread]: On master: BEGIN
[0m04:25:51.594043 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:25:51.608014 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:25:51.608416 [debug] [MainThread]: On master: COMMIT
[0m04:25:51.608613 [debug] [MainThread]: Using postgres connection "master"
[0m04:25:51.608787 [debug] [MainThread]: On master: COMMIT
[0m04:25:51.609157 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:25:51.609334 [debug] [MainThread]: On master: Close
[0m04:25:51.609624 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:25:51.609795 [debug] [MainThread]: Connection 'model.crossborder.bottom_five_customer_base_by_country' was properly closed.
[0m04:25:51.609952 [debug] [MainThread]: Connection 'model.crossborder.film_rental_perfomance' was properly closed.
[0m04:25:51.610100 [debug] [MainThread]: Connection 'model.crossborder.top_five_volume_sales_by_country' was properly closed.
[0m04:25:51.610243 [debug] [MainThread]: Connection 'model.crossborder.top_loyal_customers' was properly closed.
[0m04:25:51.610384 [debug] [MainThread]: Connection 'model.crossborder.top_three_in_demand_genres' was properly closed.
[0m04:25:51.610639 [info ] [MainThread]: 
[0m04:25:51.610935 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.52 seconds (0.52s).
[0m04:25:51.611627 [debug] [MainThread]: Command end result
[0m04:25:51.633996 [info ] [MainThread]: 
[0m04:25:51.634701 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m04:25:51.634913 [info ] [MainThread]: 
[0m04:25:51.635182 [error] [MainThread]:   Database Error in model film_rental_perfomance (models/core/film_rental_perfomance.sql)
  column "day" does not exist
  LINE 9:         case when datediff(day, rntl.rental_date, rntl.retur...
                                     ^
  compiled Code at target/run/crossborder/models/core/film_rental_perfomance.sql
[0m04:25:51.635394 [info ] [MainThread]: 
[0m04:25:51.635632 [error] [MainThread]:   Database Error in model top_loyal_customers (models/core/top_loyal_customers.sql)
  missing FROM-clause entry for table "pymnt"
  LINE 11:         sum(pymnt.total_amount) as total_payments
                       ^
  compiled Code at target/run/crossborder/models/core/top_loyal_customers.sql
[0m04:25:51.635853 [info ] [MainThread]: 
[0m04:25:51.636143 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m04:25:51.637664 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.4816767, "process_user_time": 1.793231, "process_kernel_time": 0.221887, "process_mem_max_rss": "119832576", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m04:25:51.638069 [debug] [MainThread]: Command `dbt run` failed at 04:25:51.638008 after 1.48 seconds
[0m04:25:51.638367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10124a110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10667d650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10667dfd0>]}
[0m04:25:51.638630 [debug] [MainThread]: Flushing usage events
[0m04:39:48.238026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113bd65d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c1ffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c42a10>]}


============================== 04:39:48.241871 | 51cf64f4-7110-4961-a876-ffb679996b49 ==============================
[0m04:39:48.241871 [info ] [MainThread]: Running with dbt=1.8.1
[0m04:39:48.242284 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/kelvin/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/kelvin/Documents/DBTProjects/CrossBorderRental/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m04:39:48.356096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '51cf64f4-7110-4961-a876-ffb679996b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c57f50>]}
[0m04:39:48.385615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '51cf64f4-7110-4961-a876-ffb679996b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110e372d0>]}
[0m04:39:48.386265 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m04:39:48.400838 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m04:39:48.462501 [debug] [MainThread]: Partial parsing enabled: 5 files deleted, 5 files added, 0 files changed.
[0m04:39:48.462937 [debug] [MainThread]: Partial parsing: added file: crossborder://models/film_rental_perfomance.sql
[0m04:39:48.463161 [debug] [MainThread]: Partial parsing: added file: crossborder://models/top_three_in_demand_genres.sql
[0m04:39:48.463353 [debug] [MainThread]: Partial parsing: added file: crossborder://models/bottom_five_customer_base_by_country.sql
[0m04:39:48.463542 [debug] [MainThread]: Partial parsing: added file: crossborder://models/top_loyal_customers.sql
[0m04:39:48.463723 [debug] [MainThread]: Partial parsing: added file: crossborder://models/top_five_volume_sales_by_country.sql
[0m04:39:48.463906 [debug] [MainThread]: Partial parsing: deleted file: crossborder://models/core/bottom_five_customer_base_by_country.sql
[0m04:39:48.464072 [debug] [MainThread]: Partial parsing: deleted file: crossborder://models/core/top_five_volume_sales_by_country.sql
[0m04:39:48.464233 [debug] [MainThread]: Partial parsing: deleted file: crossborder://models/core/top_loyal_customers.sql
[0m04:39:48.464397 [debug] [MainThread]: Partial parsing: deleted file: crossborder://models/core/top_three_in_demand_genres.sql
[0m04:39:48.464557 [debug] [MainThread]: Partial parsing: deleted file: crossborder://models/core/film_rental_perfomance.sql
[0m04:39:48.584183 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crossborder_sql.core
[0m04:39:48.587470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '51cf64f4-7110-4961-a876-ffb679996b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1141d2cd0>]}
[0m04:39:48.643084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '51cf64f4-7110-4961-a876-ffb679996b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114b634d0>]}
[0m04:39:48.643483 [info ] [MainThread]: Found 5 models, 413 macros
[0m04:39:48.643707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51cf64f4-7110-4961-a876-ffb679996b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a5bc10>]}
[0m04:39:48.644932 [info ] [MainThread]: 
[0m04:39:48.645294 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:39:48.647719 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m04:39:48.684153 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m04:39:48.684482 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m04:39:48.684683 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:39:48.738188 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m04:39:48.739213 [debug] [ThreadPool]: On list_dvdrental: Close
[0m04:39:48.740125 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dvdrental, now list_dvdrental_transformation)
[0m04:39:48.744063 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_transformation"
[0m04:39:48.744277 [debug] [ThreadPool]: On list_dvdrental_transformation: BEGIN
[0m04:39:48.744445 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:39:48.755098 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m04:39:48.755278 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_transformation"
[0m04:39:48.755471 [debug] [ThreadPool]: On list_dvdrental_transformation: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "list_dvdrental_transformation"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'transformation'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'transformation'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'transformation'
  
[0m04:39:48.762851 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m04:39:48.763614 [debug] [ThreadPool]: On list_dvdrental_transformation: ROLLBACK
[0m04:39:48.764487 [debug] [ThreadPool]: On list_dvdrental_transformation: Close
[0m04:39:48.767489 [debug] [MainThread]: Using postgres connection "master"
[0m04:39:48.767671 [debug] [MainThread]: On master: BEGIN
[0m04:39:48.767827 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:39:48.776642 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:39:48.776814 [debug] [MainThread]: Using postgres connection "master"
[0m04:39:48.777078 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:39:48.804565 [debug] [MainThread]: SQL status: SELECT 58 in 0.0 seconds
[0m04:39:48.805902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '51cf64f4-7110-4961-a876-ffb679996b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149ccf50>]}
[0m04:39:48.806182 [debug] [MainThread]: On master: ROLLBACK
[0m04:39:48.807627 [debug] [MainThread]: Using postgres connection "master"
[0m04:39:48.807792 [debug] [MainThread]: On master: BEGIN
[0m04:39:48.808453 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:39:48.808617 [debug] [MainThread]: On master: COMMIT
[0m04:39:48.808772 [debug] [MainThread]: Using postgres connection "master"
[0m04:39:48.808923 [debug] [MainThread]: On master: COMMIT
[0m04:39:48.809267 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:39:48.809435 [debug] [MainThread]: On master: Close
[0m04:39:48.809702 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m04:39:48.809899 [info ] [MainThread]: 
[0m04:39:48.812033 [debug] [Thread-1 (]: Began running node model.crossborder.bottom_five_customer_base_by_country
[0m04:39:48.812297 [debug] [Thread-2 (]: Began running node model.crossborder.film_rental_perfomance
[0m04:39:48.812519 [debug] [Thread-3 (]: Began running node model.crossborder.top_five_volume_sales_by_country
[0m04:39:48.812733 [debug] [Thread-4 (]: Began running node model.crossborder.top_loyal_customers
[0m04:39:48.812966 [debug] [Thread-5 (]: Began running node model.crossborder.top_three_in_demand_genres
[0m04:39:48.813315 [info ] [Thread-1 (]: 1 of 5 START sql view model transformation.bottom_five_customer_base_by_country  [RUN]
[0m04:39:48.813716 [info ] [Thread-2 (]: 2 of 5 START sql view model transformation.film_rental_perfomance .............. [RUN]
[0m04:39:48.814074 [info ] [Thread-3 (]: 3 of 5 START sql view model transformation.top_five_volume_sales_by_country .... [RUN]
[0m04:39:48.814377 [info ] [Thread-4 (]: 4 of 5 START sql view model transformation.top_loyal_customers ................. [RUN]
[0m04:39:48.814674 [info ] [Thread-5 (]: 5 of 5 START sql view model transformation.top_three_in_demand_genres .......... [RUN]
[0m04:39:48.815359 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dvdrental_transformation, now model.crossborder.bottom_five_customer_base_by_country)
[0m04:39:48.815722 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.crossborder.film_rental_perfomance'
[0m04:39:48.816016 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.crossborder.top_five_volume_sales_by_country'
[0m04:39:48.816299 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.crossborder.top_loyal_customers'
[0m04:39:48.816568 [debug] [Thread-5 (]: Acquiring new postgres connection 'model.crossborder.top_three_in_demand_genres'
[0m04:39:48.816794 [debug] [Thread-1 (]: Began compiling node model.crossborder.bottom_five_customer_base_by_country
[0m04:39:48.817001 [debug] [Thread-2 (]: Began compiling node model.crossborder.film_rental_perfomance
[0m04:39:48.817195 [debug] [Thread-3 (]: Began compiling node model.crossborder.top_five_volume_sales_by_country
[0m04:39:48.817386 [debug] [Thread-4 (]: Began compiling node model.crossborder.top_loyal_customers
[0m04:39:48.817582 [debug] [Thread-5 (]: Began compiling node model.crossborder.top_three_in_demand_genres
[0m04:39:48.821842 [debug] [Thread-1 (]: Writing injected SQL for node "model.crossborder.bottom_five_customer_base_by_country"
[0m04:39:48.823465 [debug] [Thread-2 (]: Writing injected SQL for node "model.crossborder.film_rental_perfomance"
[0m04:39:48.824642 [debug] [Thread-3 (]: Writing injected SQL for node "model.crossborder.top_five_volume_sales_by_country"
[0m04:39:48.826083 [debug] [Thread-4 (]: Writing injected SQL for node "model.crossborder.top_loyal_customers"
[0m04:39:48.827225 [debug] [Thread-5 (]: Writing injected SQL for node "model.crossborder.top_three_in_demand_genres"
[0m04:39:48.827981 [debug] [Thread-1 (]: Began executing node model.crossborder.bottom_five_customer_base_by_country
[0m04:39:48.828199 [debug] [Thread-2 (]: Began executing node model.crossborder.film_rental_perfomance
[0m04:39:48.828449 [debug] [Thread-4 (]: Began executing node model.crossborder.top_loyal_customers
[0m04:39:48.840363 [debug] [Thread-3 (]: Began executing node model.crossborder.top_five_volume_sales_by_country
[0m04:39:48.846951 [debug] [Thread-5 (]: Began executing node model.crossborder.top_three_in_demand_genres
[0m04:39:48.851134 [debug] [Thread-1 (]: Writing runtime sql for node "model.crossborder.bottom_five_customer_base_by_country"
[0m04:39:48.853382 [debug] [Thread-2 (]: Writing runtime sql for node "model.crossborder.film_rental_perfomance"
[0m04:39:48.855561 [debug] [Thread-4 (]: Writing runtime sql for node "model.crossborder.top_loyal_customers"
[0m04:39:48.857646 [debug] [Thread-3 (]: Writing runtime sql for node "model.crossborder.top_five_volume_sales_by_country"
[0m04:39:48.859678 [debug] [Thread-5 (]: Writing runtime sql for node "model.crossborder.top_three_in_demand_genres"
[0m04:39:48.860745 [debug] [Thread-2 (]: Using postgres connection "model.crossborder.film_rental_perfomance"
[0m04:39:48.861000 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.bottom_five_customer_base_by_country"
[0m04:39:48.861255 [debug] [Thread-5 (]: Using postgres connection "model.crossborder.top_three_in_demand_genres"
[0m04:39:48.861506 [debug] [Thread-2 (]: On model.crossborder.film_rental_perfomance: BEGIN
[0m04:39:48.861756 [debug] [Thread-4 (]: Using postgres connection "model.crossborder.top_loyal_customers"
[0m04:39:48.861989 [debug] [Thread-3 (]: Using postgres connection "model.crossborder.top_five_volume_sales_by_country"
[0m04:39:48.862220 [debug] [Thread-1 (]: On model.crossborder.bottom_five_customer_base_by_country: BEGIN
[0m04:39:48.862433 [debug] [Thread-5 (]: On model.crossborder.top_three_in_demand_genres: BEGIN
[0m04:39:48.862659 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m04:39:48.862874 [debug] [Thread-4 (]: On model.crossborder.top_loyal_customers: BEGIN
[0m04:39:48.863086 [debug] [Thread-3 (]: On model.crossborder.top_five_volume_sales_by_country: BEGIN
[0m04:39:48.863288 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:39:48.863488 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m04:39:48.863780 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m04:39:48.863979 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m04:39:48.878110 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m04:39:48.878347 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m04:39:48.878582 [debug] [Thread-2 (]: Using postgres connection "model.crossborder.film_rental_perfomance"
[0m04:39:48.878785 [debug] [Thread-3 (]: Using postgres connection "model.crossborder.top_five_volume_sales_by_country"
[0m04:39:48.879023 [debug] [Thread-2 (]: On model.crossborder.film_rental_perfomance: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.film_rental_perfomance"} */

  create view "dvdrental"."transformation"."film_rental_perfomance__dbt_tmp"
    
    
  as (
    with final as (
    select
        case when datediff(day, rntl.rental_date, rntl.return_date) > flm.rental_duration 
            then 'early_return'
        when datediff(day, rntl.rental_date, rntl.return_date) < flm.rental_duration
            then 'late_return'
        else 'on_time'
        end as rental_return_type,
        
        count(1) as total_rental_status
from rental rntl
inner join inventory invntry on rntl.inventory_id = invntry.inventory_id
inner join film flm on invntry.film_id = flm.film_id
order by rental_performance desc)

select  * 
from final
  );
[0m04:39:48.879295 [debug] [Thread-3 (]: On model.crossborder.top_five_volume_sales_by_country: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_five_volume_sales_by_country"} */

  create view "dvdrental"."transformation"."top_five_volume_sales_by_country__dbt_tmp"
    
    
  as (
    with final as (
    select cntry.country, sum(pymnt.amount) as vol_sales, count(cstmr.customer_id) as customers
from country cntry
inner join city on cntry.country_id = city.country_id
inner join address addr on city.city_id = addr.city_id
inner join customer cstmr on addr.address_id = cstmr.address_id
inner join payment pymnt on cstmr.customer_id = pymnt.customer_id
group by cntry.country
order by vol_sales desc, customers desc
limit 5
)

select *
from final
  );
[0m04:39:48.879930 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m04:39:48.880193 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m04:39:48.880388 [debug] [Thread-4 (]: Using postgres connection "model.crossborder.top_loyal_customers"
[0m04:39:48.880598 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.bottom_five_customer_base_by_country"
[0m04:39:48.880840 [debug] [Thread-4 (]: On model.crossborder.top_loyal_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_loyal_customers"} */

  create view "dvdrental"."transformation"."top_loyal_customers__dbt_tmp"
    
    
  as (
    with final as (
    select distinct concat(cstmr.first_name, ' ', cstmr.last_name) as loyal_customer,
        concat(cntry.country, ' | ', city.city, ', ', addr.address) as full_address,
        
        sum(pymnt.total_amount) as total_payments
from rental rntl
inner join customer cstmr on cstmr.customer_id = rntl.customer_id
inner join address addr on cstmr.address_id = addr.address_id
inner join city on city.city_id = addr.city_id
inner join country cntry on cntry.country_id = city.country_id
group by loyal_customer
order by rentals desc)

select *
from final
  );
[0m04:39:48.881106 [debug] [Thread-1 (]: On model.crossborder.bottom_five_customer_base_by_country: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.bottom_five_customer_base_by_country"} */

  create view "dvdrental"."transformation"."bottom_five_customer_base_by_country__dbt_tmp"
    
    
  as (
    with final as (select cntry.country, count(customer_id) as customers
from country cntry
inner join city on cntry.country_id = city.country_id
inner join address addr on city.city_id = addr.city_id
inner join customer cstmr on addr.address_id = cstmr.address_id
group by cntry.country
order by customers
limit 5)

select *
from final
  );
[0m04:39:48.882508 [debug] [Thread-5 (]: SQL status: BEGIN in 0.0 seconds
[0m04:39:48.882727 [debug] [Thread-5 (]: Using postgres connection "model.crossborder.top_three_in_demand_genres"
[0m04:39:48.882965 [debug] [Thread-5 (]: On model.crossborder.top_three_in_demand_genres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_three_in_demand_genres"} */

  create view "dvdrental"."transformation"."top_three_in_demand_genres__dbt_tmp"
    
    
  as (
    with final as (
    select distinct ctgry.name as genre,
        count(cstmr.customer_id) as demand, sum(pymnt.amount) as total_sales
from category ctgry
inner join film_category flm_ctgry on ctgry.category_id = flm_ctgry.category_id
inner join film on flm_ctgry.film_id = film.film_id
inner join inventory invtry on film.film_id = invtry.film_id
inner join rental rntl on invtry.inventory_id = rntl.inventory_id
inner join customer cstmr on rntl.customer_id = cstmr.customer_id
inner join payment pymnt on rntl.rental_id = pymnt.rental_id
group by ctgry.category_id, ctgry.name
order by demand desc, total_sales desc
limit 3
)

select *
from final
  );
[0m04:39:48.894056 [debug] [Thread-2 (]: Postgres adapter: Postgres error: column "day" does not exist
LINE 9:         case when datediff(day, rntl.rental_date, rntl.retur...
                                   ^

[0m04:39:48.894279 [debug] [Thread-2 (]: On model.crossborder.film_rental_perfomance: ROLLBACK
[0m04:39:48.895356 [debug] [Thread-4 (]: Postgres adapter: Postgres error: missing FROM-clause entry for table "pymnt"
LINE 11:         sum(pymnt.total_amount) as total_payments
                     ^

[0m04:39:48.895659 [debug] [Thread-2 (]: On model.crossborder.film_rental_perfomance: Close
[0m04:39:48.895846 [debug] [Thread-4 (]: On model.crossborder.top_loyal_customers: ROLLBACK
[0m04:39:48.896934 [debug] [Thread-4 (]: On model.crossborder.top_loyal_customers: Close
[0m04:39:48.903225 [debug] [Thread-4 (]: Database Error in model top_loyal_customers (models/top_loyal_customers.sql)
  missing FROM-clause entry for table "pymnt"
  LINE 11:         sum(pymnt.total_amount) as total_payments
                       ^
  compiled Code at target/run/crossborder/models/top_loyal_customers.sql
[0m04:39:48.904119 [debug] [Thread-2 (]: Database Error in model film_rental_perfomance (models/film_rental_perfomance.sql)
  column "day" does not exist
  LINE 9:         case when datediff(day, rntl.rental_date, rntl.retur...
                                     ^
  compiled Code at target/run/crossborder/models/film_rental_perfomance.sql
[0m04:39:48.905135 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51cf64f4-7110-4961-a876-ffb679996b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114fd0650>]}
[0m04:39:48.905433 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51cf64f4-7110-4961-a876-ffb679996b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114ed6fd0>]}
[0m04:39:48.905890 [error] [Thread-4 (]: 4 of 5 ERROR creating sql view model transformation.top_loyal_customers ........ [[31mERROR[0m in 0.09s]
[0m04:39:48.906288 [error] [Thread-2 (]: 2 of 5 ERROR creating sql view model transformation.film_rental_perfomance ..... [[31mERROR[0m in 0.09s]
[0m04:39:48.906544 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m04:39:48.906877 [debug] [Thread-4 (]: Finished running node model.crossborder.top_loyal_customers
[0m04:39:48.907081 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m04:39:48.907384 [debug] [Thread-2 (]: Finished running node model.crossborder.film_rental_perfomance
[0m04:39:48.907573 [debug] [Thread-5 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m04:39:48.911568 [debug] [Thread-3 (]: Using postgres connection "model.crossborder.top_five_volume_sales_by_country"
[0m04:39:48.914018 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.bottom_five_customer_base_by_country"
[0m04:39:48.915906 [debug] [Thread-5 (]: Using postgres connection "model.crossborder.top_three_in_demand_genres"
[0m04:39:48.916166 [debug] [Thread-3 (]: On model.crossborder.top_five_volume_sales_by_country: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_five_volume_sales_by_country"} */
alter table "dvdrental"."transformation"."top_five_volume_sales_by_country" rename to "top_five_volume_sales_by_country__dbt_backup"
[0m04:39:48.916434 [debug] [Thread-1 (]: On model.crossborder.bottom_five_customer_base_by_country: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.bottom_five_customer_base_by_country"} */
alter table "dvdrental"."transformation"."bottom_five_customer_base_by_country" rename to "bottom_five_customer_base_by_country__dbt_backup"
[0m04:39:48.916668 [debug] [Thread-5 (]: On model.crossborder.top_three_in_demand_genres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_three_in_demand_genres"} */
alter table "dvdrental"."transformation"."top_three_in_demand_genres" rename to "top_three_in_demand_genres__dbt_backup"
[0m04:39:48.917524 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:39:48.917819 [debug] [Thread-5 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:39:48.918049 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:39:48.919769 [debug] [Thread-3 (]: Using postgres connection "model.crossborder.top_five_volume_sales_by_country"
[0m04:39:48.921600 [debug] [Thread-5 (]: Using postgres connection "model.crossborder.top_three_in_demand_genres"
[0m04:39:48.926906 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.bottom_five_customer_base_by_country"
[0m04:39:48.927307 [debug] [Thread-3 (]: On model.crossborder.top_five_volume_sales_by_country: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_five_volume_sales_by_country"} */
alter table "dvdrental"."transformation"."top_five_volume_sales_by_country__dbt_tmp" rename to "top_five_volume_sales_by_country"
[0m04:39:48.927738 [debug] [Thread-5 (]: On model.crossborder.top_three_in_demand_genres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_three_in_demand_genres"} */
alter table "dvdrental"."transformation"."top_three_in_demand_genres__dbt_tmp" rename to "top_three_in_demand_genres"
[0m04:39:48.928103 [debug] [Thread-1 (]: On model.crossborder.bottom_five_customer_base_by_country: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.bottom_five_customer_base_by_country"} */
alter table "dvdrental"."transformation"."bottom_five_customer_base_by_country__dbt_tmp" rename to "bottom_five_customer_base_by_country"
[0m04:39:48.941962 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:39:48.942555 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:39:48.949170 [debug] [Thread-5 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m04:39:48.977053 [debug] [Thread-3 (]: On model.crossborder.top_five_volume_sales_by_country: COMMIT
[0m04:39:48.977512 [debug] [Thread-3 (]: Using postgres connection "model.crossborder.top_five_volume_sales_by_country"
[0m04:39:48.977752 [debug] [Thread-3 (]: On model.crossborder.top_five_volume_sales_by_country: COMMIT
[0m04:39:48.979524 [debug] [Thread-5 (]: On model.crossborder.top_three_in_demand_genres: COMMIT
[0m04:39:48.979847 [debug] [Thread-5 (]: Using postgres connection "model.crossborder.top_three_in_demand_genres"
[0m04:39:48.980080 [debug] [Thread-5 (]: On model.crossborder.top_three_in_demand_genres: COMMIT
[0m04:39:48.983452 [debug] [Thread-1 (]: On model.crossborder.bottom_five_customer_base_by_country: COMMIT
[0m04:39:48.984130 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.bottom_five_customer_base_by_country"
[0m04:39:48.984526 [debug] [Thread-1 (]: On model.crossborder.bottom_five_customer_base_by_country: COMMIT
[0m04:39:49.028624 [debug] [Thread-5 (]: SQL status: COMMIT in 0.0 seconds
[0m04:39:49.029340 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m04:39:49.029587 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m04:39:49.036762 [debug] [Thread-5 (]: Applying DROP to: "dvdrental"."transformation"."top_three_in_demand_genres__dbt_backup"
[0m04:39:49.039311 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."transformation"."top_five_volume_sales_by_country__dbt_backup"
[0m04:39:49.041142 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."transformation"."bottom_five_customer_base_by_country__dbt_backup"
[0m04:39:49.048196 [debug] [Thread-5 (]: Using postgres connection "model.crossborder.top_three_in_demand_genres"
[0m04:39:49.048739 [debug] [Thread-3 (]: Using postgres connection "model.crossborder.top_five_volume_sales_by_country"
[0m04:39:49.049246 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.bottom_five_customer_base_by_country"
[0m04:39:49.049553 [debug] [Thread-5 (]: On model.crossborder.top_three_in_demand_genres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_three_in_demand_genres"} */
drop view if exists "dvdrental"."transformation"."top_three_in_demand_genres__dbt_backup" cascade
[0m04:39:49.049812 [debug] [Thread-3 (]: On model.crossborder.top_five_volume_sales_by_country: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_five_volume_sales_by_country"} */
drop view if exists "dvdrental"."transformation"."top_five_volume_sales_by_country__dbt_backup" cascade
[0m04:39:49.050076 [debug] [Thread-1 (]: On model.crossborder.bottom_five_customer_base_by_country: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.bottom_five_customer_base_by_country"} */
drop view if exists "dvdrental"."transformation"."bottom_five_customer_base_by_country__dbt_backup" cascade
[0m04:39:49.087226 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m04:39:49.087544 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m04:39:49.087749 [debug] [Thread-5 (]: SQL status: DROP VIEW in 0.0 seconds
[0m04:39:49.089414 [debug] [Thread-3 (]: On model.crossborder.top_five_volume_sales_by_country: Close
[0m04:39:49.090208 [debug] [Thread-1 (]: On model.crossborder.bottom_five_customer_base_by_country: Close
[0m04:39:49.090899 [debug] [Thread-5 (]: On model.crossborder.top_three_in_demand_genres: Close
[0m04:39:49.091286 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51cf64f4-7110-4961-a876-ffb679996b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114fa5610>]}
[0m04:39:49.091582 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51cf64f4-7110-4961-a876-ffb679996b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114fad250>]}
[0m04:39:49.091912 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '51cf64f4-7110-4961-a876-ffb679996b49', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114929b90>]}
[0m04:39:49.092302 [info ] [Thread-3 (]: 3 of 5 OK created sql view model transformation.top_five_volume_sales_by_country  [[32mCREATE VIEW[0m in 0.28s]
[0m04:39:49.092666 [info ] [Thread-1 (]: 1 of 5 OK created sql view model transformation.bottom_five_customer_base_by_country  [[32mCREATE VIEW[0m in 0.28s]
[0m04:39:49.093017 [info ] [Thread-5 (]: 5 of 5 OK created sql view model transformation.top_three_in_demand_genres ..... [[32mCREATE VIEW[0m in 0.28s]
[0m04:39:49.093371 [debug] [Thread-3 (]: Finished running node model.crossborder.top_five_volume_sales_by_country
[0m04:39:49.093659 [debug] [Thread-1 (]: Finished running node model.crossborder.bottom_five_customer_base_by_country
[0m04:39:49.093942 [debug] [Thread-5 (]: Finished running node model.crossborder.top_three_in_demand_genres
[0m04:39:49.094925 [debug] [MainThread]: Using postgres connection "master"
[0m04:39:49.095124 [debug] [MainThread]: On master: BEGIN
[0m04:39:49.095291 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:39:49.106428 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:39:49.106739 [debug] [MainThread]: On master: COMMIT
[0m04:39:49.106910 [debug] [MainThread]: Using postgres connection "master"
[0m04:39:49.107078 [debug] [MainThread]: On master: COMMIT
[0m04:39:49.107358 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:39:49.107531 [debug] [MainThread]: On master: Close
[0m04:39:49.107796 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:39:49.107966 [debug] [MainThread]: Connection 'model.crossborder.bottom_five_customer_base_by_country' was properly closed.
[0m04:39:49.108120 [debug] [MainThread]: Connection 'model.crossborder.film_rental_perfomance' was properly closed.
[0m04:39:49.108268 [debug] [MainThread]: Connection 'model.crossborder.top_five_volume_sales_by_country' was properly closed.
[0m04:39:49.108406 [debug] [MainThread]: Connection 'model.crossborder.top_loyal_customers' was properly closed.
[0m04:39:49.108542 [debug] [MainThread]: Connection 'model.crossborder.top_three_in_demand_genres' was properly closed.
[0m04:39:49.108787 [info ] [MainThread]: 
[0m04:39:49.109006 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.46 seconds (0.46s).
[0m04:39:49.109680 [debug] [MainThread]: Command end result
[0m04:39:49.137919 [info ] [MainThread]: 
[0m04:39:49.138345 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m04:39:49.138578 [info ] [MainThread]: 
[0m04:39:49.138850 [error] [MainThread]:   Database Error in model top_loyal_customers (models/top_loyal_customers.sql)
  missing FROM-clause entry for table "pymnt"
  LINE 11:         sum(pymnt.total_amount) as total_payments
                       ^
  compiled Code at target/run/crossborder/models/top_loyal_customers.sql
[0m04:39:49.139060 [info ] [MainThread]: 
[0m04:39:49.139277 [error] [MainThread]:   Database Error in model film_rental_perfomance (models/film_rental_perfomance.sql)
  column "day" does not exist
  LINE 9:         case when datediff(day, rntl.rental_date, rntl.retur...
                                     ^
  compiled Code at target/run/crossborder/models/film_rental_perfomance.sql
[0m04:39:49.139471 [info ] [MainThread]: 
[0m04:39:49.139678 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m04:39:49.141405 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.94800335, "process_user_time": 1.354602, "process_kernel_time": 0.201489, "process_mem_max_rss": "126091264", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m04:39:49.141786 [debug] [MainThread]: Command `dbt run` failed at 04:39:49.141731 after 0.95 seconds
[0m04:39:49.142085 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c1f2d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105722110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113c42ed0>]}
[0m04:39:49.142332 [debug] [MainThread]: Flushing usage events
[0m04:43:38.795287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10781a390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10787df50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10787e690>]}


============================== 04:43:38.799140 | db7c2250-a360-4b47-830c-00a23f7b3c5c ==============================
[0m04:43:38.799140 [info ] [MainThread]: Running with dbt=1.8.1
[0m04:43:38.799595 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/kelvin/Documents/DBTProjects/CrossBorderRental/logs', 'version_check': 'True', 'profiles_dir': '/Users/kelvin/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s top_loyal_customers', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m04:43:38.932326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db7c2250-a360-4b47-830c-00a23f7b3c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10787ea10>]}
[0m04:43:38.960867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db7c2250-a360-4b47-830c-00a23f7b3c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10442b8d0>]}
[0m04:43:38.961501 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m04:43:38.973432 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m04:43:39.104608 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m04:43:39.105144 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m04:43:39.110424 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crossborder_sql.core
[0m04:43:39.134634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db7c2250-a360-4b47-830c-00a23f7b3c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ed82d0>]}
[0m04:43:39.196896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db7c2250-a360-4b47-830c-00a23f7b3c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1183817d0>]}
[0m04:43:39.197335 [info ] [MainThread]: Found 5 models, 413 macros
[0m04:43:39.197567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db7c2250-a360-4b47-830c-00a23f7b3c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ff8b10>]}
[0m04:43:39.198584 [info ] [MainThread]: 
[0m04:43:39.199160 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:43:39.199795 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m04:43:39.240586 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m04:43:39.240912 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m04:43:39.241115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:43:39.349122 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m04:43:39.350535 [debug] [ThreadPool]: On list_dvdrental: Close
[0m04:43:39.353374 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dvdrental, now list_dvdrental_transformation)
[0m04:43:39.357378 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_transformation"
[0m04:43:39.357603 [debug] [ThreadPool]: On list_dvdrental_transformation: BEGIN
[0m04:43:39.357776 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:43:39.366730 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m04:43:39.367041 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_transformation"
[0m04:43:39.367278 [debug] [ThreadPool]: On list_dvdrental_transformation: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "list_dvdrental_transformation"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'transformation'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'transformation'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'transformation'
  
[0m04:43:39.374588 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m04:43:39.375664 [debug] [ThreadPool]: On list_dvdrental_transformation: ROLLBACK
[0m04:43:39.376063 [debug] [ThreadPool]: On list_dvdrental_transformation: Close
[0m04:43:39.379479 [debug] [MainThread]: Using postgres connection "master"
[0m04:43:39.379676 [debug] [MainThread]: On master: BEGIN
[0m04:43:39.379838 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:43:39.393705 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:43:39.393972 [debug] [MainThread]: Using postgres connection "master"
[0m04:43:39.394241 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:43:39.455280 [debug] [MainThread]: SQL status: SELECT 58 in 0.0 seconds
[0m04:43:39.457120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db7c2250-a360-4b47-830c-00a23f7b3c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118381a90>]}
[0m04:43:39.457522 [debug] [MainThread]: On master: ROLLBACK
[0m04:43:39.458816 [debug] [MainThread]: Using postgres connection "master"
[0m04:43:39.459198 [debug] [MainThread]: On master: BEGIN
[0m04:43:39.459867 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:43:39.460058 [debug] [MainThread]: On master: COMMIT
[0m04:43:39.460295 [debug] [MainThread]: Using postgres connection "master"
[0m04:43:39.460499 [debug] [MainThread]: On master: COMMIT
[0m04:43:39.460950 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:43:39.461236 [debug] [MainThread]: On master: Close
[0m04:43:39.461879 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m04:43:39.462124 [info ] [MainThread]: 
[0m04:43:39.465485 [debug] [Thread-1 (]: Began running node model.crossborder.top_loyal_customers
[0m04:43:39.466144 [info ] [Thread-1 (]: 1 of 1 START sql view model transformation.top_loyal_customers ................. [RUN]
[0m04:43:39.466570 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dvdrental_transformation, now model.crossborder.top_loyal_customers)
[0m04:43:39.467372 [debug] [Thread-1 (]: Began compiling node model.crossborder.top_loyal_customers
[0m04:43:39.480497 [debug] [Thread-1 (]: Writing injected SQL for node "model.crossborder.top_loyal_customers"
[0m04:43:39.482497 [debug] [Thread-1 (]: Began executing node model.crossborder.top_loyal_customers
[0m04:43:39.524604 [debug] [Thread-1 (]: Writing runtime sql for node "model.crossborder.top_loyal_customers"
[0m04:43:39.525394 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_loyal_customers"
[0m04:43:39.525642 [debug] [Thread-1 (]: On model.crossborder.top_loyal_customers: BEGIN
[0m04:43:39.525863 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:43:39.559270 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m04:43:39.561159 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_loyal_customers"
[0m04:43:39.561893 [debug] [Thread-1 (]: On model.crossborder.top_loyal_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_loyal_customers"} */

  create view "dvdrental"."transformation"."top_loyal_customers__dbt_tmp"
    
    
  as (
    with final as (
    select distinct concat(cstmr.first_name, ' ', cstmr.last_name) as loyal_customer,
        concat(cntry.country, ' | ', city.city, ', ', addr.address) as full_address,
        
        sum(pymnt.total_amount) as total_payments
from rental rntl
inner join customer cstmr on cstmr.customer_id = rntl.customer_id
inner join address addr on cstmr.address_id = addr.address_id
inner join city on city.city_id = addr.city_id
inner join country cntry on cntry.country_id = city.country_id
group by loyal_customer
order by rentals desc)

select *
from final
  );
[0m04:43:39.563469 [debug] [Thread-1 (]: Postgres adapter: Postgres error: missing FROM-clause entry for table "pymnt"
LINE 11:         sum(pymnt.total_amount) as total_payments
                     ^

[0m04:43:39.563781 [debug] [Thread-1 (]: On model.crossborder.top_loyal_customers: ROLLBACK
[0m04:43:39.564299 [debug] [Thread-1 (]: On model.crossborder.top_loyal_customers: Close
[0m04:43:39.570885 [debug] [Thread-1 (]: Database Error in model top_loyal_customers (models/top_loyal_customers.sql)
  missing FROM-clause entry for table "pymnt"
  LINE 11:         sum(pymnt.total_amount) as total_payments
                       ^
  compiled Code at target/run/crossborder/models/top_loyal_customers.sql
[0m04:43:39.572118 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'db7c2250-a360-4b47-830c-00a23f7b3c5c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10785abd0>]}
[0m04:43:39.572774 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model transformation.top_loyal_customers ........ [[31mERROR[0m in 0.10s]
[0m04:43:39.573350 [debug] [Thread-1 (]: Finished running node model.crossborder.top_loyal_customers
[0m04:43:39.574954 [debug] [MainThread]: Using postgres connection "master"
[0m04:43:39.575185 [debug] [MainThread]: On master: BEGIN
[0m04:43:39.575357 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:43:39.619775 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:43:39.620182 [debug] [MainThread]: On master: COMMIT
[0m04:43:39.620395 [debug] [MainThread]: Using postgres connection "master"
[0m04:43:39.620569 [debug] [MainThread]: On master: COMMIT
[0m04:43:39.621061 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:43:39.621468 [debug] [MainThread]: On master: Close
[0m04:43:39.622884 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:43:39.624812 [debug] [MainThread]: Connection 'model.crossborder.top_loyal_customers' was properly closed.
[0m04:43:39.625100 [info ] [MainThread]: 
[0m04:43:39.625340 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m04:43:39.625790 [debug] [MainThread]: Command end result
[0m04:43:39.648746 [info ] [MainThread]: 
[0m04:43:39.649199 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:43:39.649459 [info ] [MainThread]: 
[0m04:43:39.649735 [error] [MainThread]:   Database Error in model top_loyal_customers (models/top_loyal_customers.sql)
  missing FROM-clause entry for table "pymnt"
  LINE 11:         sum(pymnt.total_amount) as total_payments
                       ^
  compiled Code at target/run/crossborder/models/top_loyal_customers.sql
[0m04:43:39.649934 [info ] [MainThread]: 
[0m04:43:39.650141 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m04:43:39.652149 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.9024766, "process_user_time": 1.239143, "process_kernel_time": 0.235261, "process_mem_max_rss": "117391360", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m04:43:39.652607 [debug] [MainThread]: Command `dbt run` failed at 04:43:39.652550 after 0.90 seconds
[0m04:43:39.653095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028ea090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10787e3d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102980690>]}
[0m04:43:39.653752 [debug] [MainThread]: Flushing usage events
[0m04:59:53.897963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046dfb10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10471fe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10471f1d0>]}


============================== 04:59:53.901986 | f39c8198-057e-429b-8905-c7d123f1510c ==============================
[0m04:59:53.901986 [info ] [MainThread]: Running with dbt=1.8.1
[0m04:59:53.902450 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/kelvin/Documents/DBTProjects/CrossBorderRental/logs', 'profiles_dir': '/Users/kelvin/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run -s top_loyal_customers', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m04:59:54.030676 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f39c8198-057e-429b-8905-c7d123f1510c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ba9710>]}
[0m04:59:54.081971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f39c8198-057e-429b-8905-c7d123f1510c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a0b310>]}
[0m04:59:54.083276 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m04:59:54.123284 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m04:59:54.240632 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m04:59:54.241363 [debug] [MainThread]: Partial parsing: updated file: crossborder://models/top_loyal_customers.sql
[0m04:59:54.375975 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crossborder_sql.core
[0m04:59:54.379584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f39c8198-057e-429b-8905-c7d123f1510c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10471f250>]}
[0m04:59:54.441316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f39c8198-057e-429b-8905-c7d123f1510c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10540be10>]}
[0m04:59:54.441848 [info ] [MainThread]: Found 5 models, 413 macros
[0m04:59:54.442121 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f39c8198-057e-429b-8905-c7d123f1510c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105115910>]}
[0m04:59:54.444770 [info ] [MainThread]: 
[0m04:59:54.445471 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m04:59:54.446276 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m04:59:54.487667 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m04:59:54.487998 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m04:59:54.488202 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m04:59:54.530212 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m04:59:54.531336 [debug] [ThreadPool]: On list_dvdrental: Close
[0m04:59:54.534180 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dvdrental, now list_dvdrental_transformation)
[0m04:59:54.538140 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_transformation"
[0m04:59:54.538385 [debug] [ThreadPool]: On list_dvdrental_transformation: BEGIN
[0m04:59:54.538572 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m04:59:54.547571 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m04:59:54.547797 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_transformation"
[0m04:59:54.548020 [debug] [ThreadPool]: On list_dvdrental_transformation: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "list_dvdrental_transformation"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'transformation'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'transformation'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'transformation'
  
[0m04:59:54.556456 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m04:59:54.557293 [debug] [ThreadPool]: On list_dvdrental_transformation: ROLLBACK
[0m04:59:54.557635 [debug] [ThreadPool]: On list_dvdrental_transformation: Close
[0m04:59:54.560627 [debug] [MainThread]: Using postgres connection "master"
[0m04:59:54.560826 [debug] [MainThread]: On master: BEGIN
[0m04:59:54.560990 [debug] [MainThread]: Opening a new connection, currently in state init
[0m04:59:54.572243 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:59:54.572443 [debug] [MainThread]: Using postgres connection "master"
[0m04:59:54.572708 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m04:59:54.605513 [debug] [MainThread]: SQL status: SELECT 58 in 0.0 seconds
[0m04:59:54.607017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f39c8198-057e-429b-8905-c7d123f1510c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050bd390>]}
[0m04:59:54.607363 [debug] [MainThread]: On master: ROLLBACK
[0m04:59:54.607721 [debug] [MainThread]: Using postgres connection "master"
[0m04:59:54.607895 [debug] [MainThread]: On master: BEGIN
[0m04:59:54.608235 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:59:54.608407 [debug] [MainThread]: On master: COMMIT
[0m04:59:54.608565 [debug] [MainThread]: Using postgres connection "master"
[0m04:59:54.608717 [debug] [MainThread]: On master: COMMIT
[0m04:59:54.608948 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:59:54.609119 [debug] [MainThread]: On master: Close
[0m04:59:54.609415 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m04:59:54.609614 [info ] [MainThread]: 
[0m04:59:54.612157 [debug] [Thread-1 (]: Began running node model.crossborder.top_loyal_customers
[0m04:59:54.612553 [info ] [Thread-1 (]: 1 of 1 START sql view model transformation.top_loyal_customers ................. [RUN]
[0m04:59:54.612874 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dvdrental_transformation, now model.crossborder.top_loyal_customers)
[0m04:59:54.613098 [debug] [Thread-1 (]: Began compiling node model.crossborder.top_loyal_customers
[0m04:59:54.617465 [debug] [Thread-1 (]: Writing injected SQL for node "model.crossborder.top_loyal_customers"
[0m04:59:54.618689 [debug] [Thread-1 (]: Began executing node model.crossborder.top_loyal_customers
[0m04:59:54.646249 [debug] [Thread-1 (]: Writing runtime sql for node "model.crossborder.top_loyal_customers"
[0m04:59:54.647248 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_loyal_customers"
[0m04:59:54.647516 [debug] [Thread-1 (]: On model.crossborder.top_loyal_customers: BEGIN
[0m04:59:54.647724 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m04:59:54.660549 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m04:59:54.661573 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_loyal_customers"
[0m04:59:54.661919 [debug] [Thread-1 (]: On model.crossborder.top_loyal_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_loyal_customers"} */

  create view "dvdrental"."transformation"."top_loyal_customers__dbt_tmp"
    
    
  as (
    with loyal_customers as (
select 
    customer.first_name,
    customer.last_name,
    concat(country.country, ' | ', city.city, ', ', address.address) as customer_address,
    count(rental_id) as total_rental,
    sum(payment.total_amount) as total_amount_paid
from rental
join customer
using(customer_id)
join payment
using(customer_id)
join address 
using(address_id)
join city
using(city_id)
join country
using (country_id)
group by loyal_customer
order by rentals desc
)

select *
from loyal_customers
  );
[0m04:59:54.663827 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column reference "rental_id" is ambiguous
LINE 12:     count(rental_id) as total_rental,
                   ^

[0m04:59:54.664129 [debug] [Thread-1 (]: On model.crossborder.top_loyal_customers: ROLLBACK
[0m04:59:54.664533 [debug] [Thread-1 (]: On model.crossborder.top_loyal_customers: Close
[0m04:59:54.670655 [debug] [Thread-1 (]: Database Error in model top_loyal_customers (models/top_loyal_customers.sql)
  column reference "rental_id" is ambiguous
  LINE 12:     count(rental_id) as total_rental,
                     ^
  compiled Code at target/run/crossborder/models/top_loyal_customers.sql
[0m04:59:54.671725 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f39c8198-057e-429b-8905-c7d123f1510c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053cc650>]}
[0m04:59:54.672183 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model transformation.top_loyal_customers ........ [[31mERROR[0m in 0.06s]
[0m04:59:54.672548 [debug] [Thread-1 (]: Finished running node model.crossborder.top_loyal_customers
[0m04:59:54.673799 [debug] [MainThread]: Using postgres connection "master"
[0m04:59:54.674013 [debug] [MainThread]: On master: BEGIN
[0m04:59:54.674180 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m04:59:54.693432 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m04:59:54.693736 [debug] [MainThread]: On master: COMMIT
[0m04:59:54.693925 [debug] [MainThread]: Using postgres connection "master"
[0m04:59:54.694092 [debug] [MainThread]: On master: COMMIT
[0m04:59:54.694371 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m04:59:54.694884 [debug] [MainThread]: On master: Close
[0m04:59:54.695224 [debug] [MainThread]: Connection 'master' was properly closed.
[0m04:59:54.695402 [debug] [MainThread]: Connection 'model.crossborder.top_loyal_customers' was properly closed.
[0m04:59:54.695622 [info ] [MainThread]: 
[0m04:59:54.695900 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m04:59:54.696394 [debug] [MainThread]: Command end result
[0m04:59:54.716580 [info ] [MainThread]: 
[0m04:59:54.717102 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m04:59:54.717367 [info ] [MainThread]: 
[0m04:59:54.717641 [error] [MainThread]:   Database Error in model top_loyal_customers (models/top_loyal_customers.sql)
  column reference "rental_id" is ambiguous
  LINE 12:     count(rental_id) as total_rental,
                     ^
  compiled Code at target/run/crossborder/models/top_loyal_customers.sql
[0m04:59:54.717836 [info ] [MainThread]: 
[0m04:59:54.718029 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m04:59:54.719699 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8650165, "process_user_time": 1.242018, "process_kernel_time": 0.210921, "process_mem_max_rss": "103333888", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m04:59:54.720070 [debug] [MainThread]: Command `dbt run` failed at 04:59:54.720019 after 0.87 seconds
[0m04:59:54.720348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10471e490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100eca090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10513a190>]}
[0m04:59:54.720571 [debug] [MainThread]: Flushing usage events
[0m05:02:01.373506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10465e350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046b9d50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046ba490>]}


============================== 05:02:01.377228 | 6a9a59e9-9ba4-452c-aee2-8d3746c5ec07 ==============================
[0m05:02:01.377228 [info ] [MainThread]: Running with dbt=1.8.1
[0m05:02:01.377671 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/kelvin/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/kelvin/Documents/DBTProjects/CrossBorderRental/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s top_loyal_customers', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:02:01.503951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6a9a59e9-9ba4-452c-aee2-8d3746c5ec07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040d3690>]}
[0m05:02:01.535269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6a9a59e9-9ba4-452c-aee2-8d3746c5ec07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10298b890>]}
[0m05:02:01.536056 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m05:02:01.550445 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m05:02:01.625396 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:02:01.625980 [debug] [MainThread]: Partial parsing: updated file: crossborder://models/top_loyal_customers.sql
[0m05:02:01.742825 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crossborder_sql.core
[0m05:02:01.746515 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6a9a59e9-9ba4-452c-aee2-8d3746c5ec07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104be06d0>]}
[0m05:02:01.798824 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6a9a59e9-9ba4-452c-aee2-8d3746c5ec07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10538f850>]}
[0m05:02:01.799236 [info ] [MainThread]: Found 5 models, 413 macros
[0m05:02:01.799461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a9a59e9-9ba4-452c-aee2-8d3746c5ec07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052f3650>]}
[0m05:02:01.800466 [info ] [MainThread]: 
[0m05:02:01.800864 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:02:01.801446 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m05:02:01.839527 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m05:02:01.839835 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m05:02:01.840026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:02:01.878827 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m05:02:01.879810 [debug] [ThreadPool]: On list_dvdrental: Close
[0m05:02:01.882602 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dvdrental, now list_dvdrental_transformation)
[0m05:02:01.886553 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_transformation"
[0m05:02:01.886757 [debug] [ThreadPool]: On list_dvdrental_transformation: BEGIN
[0m05:02:01.886919 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:02:01.905037 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:02:01.905286 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_transformation"
[0m05:02:01.905504 [debug] [ThreadPool]: On list_dvdrental_transformation: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "list_dvdrental_transformation"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'transformation'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'transformation'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'transformation'
  
[0m05:02:01.911355 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m05:02:01.912194 [debug] [ThreadPool]: On list_dvdrental_transformation: ROLLBACK
[0m05:02:01.912486 [debug] [ThreadPool]: On list_dvdrental_transformation: Close
[0m05:02:01.915489 [debug] [MainThread]: Using postgres connection "master"
[0m05:02:01.915676 [debug] [MainThread]: On master: BEGIN
[0m05:02:01.915836 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:02:01.924626 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:02:01.924889 [debug] [MainThread]: Using postgres connection "master"
[0m05:02:01.925162 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:02:01.947143 [debug] [MainThread]: SQL status: SELECT 58 in 0.0 seconds
[0m05:02:01.948488 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6a9a59e9-9ba4-452c-aee2-8d3746c5ec07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105618cd0>]}
[0m05:02:01.948775 [debug] [MainThread]: On master: ROLLBACK
[0m05:02:01.949146 [debug] [MainThread]: Using postgres connection "master"
[0m05:02:01.949314 [debug] [MainThread]: On master: BEGIN
[0m05:02:01.949643 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:02:01.949808 [debug] [MainThread]: On master: COMMIT
[0m05:02:01.949960 [debug] [MainThread]: Using postgres connection "master"
[0m05:02:01.950106 [debug] [MainThread]: On master: COMMIT
[0m05:02:01.950353 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:02:01.950520 [debug] [MainThread]: On master: Close
[0m05:02:01.950790 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m05:02:01.950983 [info ] [MainThread]: 
[0m05:02:01.953055 [debug] [Thread-1 (]: Began running node model.crossborder.top_loyal_customers
[0m05:02:01.953364 [info ] [Thread-1 (]: 1 of 1 START sql view model transformation.top_loyal_customers ................. [RUN]
[0m05:02:01.953650 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dvdrental_transformation, now model.crossborder.top_loyal_customers)
[0m05:02:01.953865 [debug] [Thread-1 (]: Began compiling node model.crossborder.top_loyal_customers
[0m05:02:01.958060 [debug] [Thread-1 (]: Writing injected SQL for node "model.crossborder.top_loyal_customers"
[0m05:02:01.958916 [debug] [Thread-1 (]: Began executing node model.crossborder.top_loyal_customers
[0m05:02:01.980548 [debug] [Thread-1 (]: Writing runtime sql for node "model.crossborder.top_loyal_customers"
[0m05:02:01.981481 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_loyal_customers"
[0m05:02:01.981828 [debug] [Thread-1 (]: On model.crossborder.top_loyal_customers: BEGIN
[0m05:02:01.982057 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:02:01.990931 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:02:01.991161 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_loyal_customers"
[0m05:02:01.991399 [debug] [Thread-1 (]: On model.crossborder.top_loyal_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_loyal_customers"} */

  create view "dvdrental"."transformation"."top_loyal_customers__dbt_tmp"
    
    
  as (
    with loyal_customers as (
select 
    customer.first_name,
    customer.last_name,
    concat(country.country, ' | ', city.city, ', ', address.address) as customer_address,
    count(payment.rental_id) as no_of_movies_rented,
    sum(payment.total_amount) as total_amount_paid
from rental
join customer
using(customer_id)
join payment
using(customer_id)
join address 
using(address_id)
join city
using(city_id)
join country
using (country_id)
group by loyal_customer
order by rentals desc
)

select *
from loyal_customers
  );
[0m05:02:01.994942 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column payment.total_amount does not exist
LINE 13:     sum(payment.total_amount) as total_amount_paid
                 ^

[0m05:02:01.995182 [debug] [Thread-1 (]: On model.crossborder.top_loyal_customers: ROLLBACK
[0m05:02:01.995590 [debug] [Thread-1 (]: On model.crossborder.top_loyal_customers: Close
[0m05:02:02.001778 [debug] [Thread-1 (]: Database Error in model top_loyal_customers (models/top_loyal_customers.sql)
  column payment.total_amount does not exist
  LINE 13:     sum(payment.total_amount) as total_amount_paid
                   ^
  compiled Code at target/run/crossborder/models/top_loyal_customers.sql
[0m05:02:02.002821 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6a9a59e9-9ba4-452c-aee2-8d3746c5ec07', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052f1bd0>]}
[0m05:02:02.003287 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model transformation.top_loyal_customers ........ [[31mERROR[0m in 0.05s]
[0m05:02:02.003668 [debug] [Thread-1 (]: Finished running node model.crossborder.top_loyal_customers
[0m05:02:02.004879 [debug] [MainThread]: Using postgres connection "master"
[0m05:02:02.005088 [debug] [MainThread]: On master: BEGIN
[0m05:02:02.005263 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:02:02.059173 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:02:02.059581 [debug] [MainThread]: On master: COMMIT
[0m05:02:02.059785 [debug] [MainThread]: Using postgres connection "master"
[0m05:02:02.059958 [debug] [MainThread]: On master: COMMIT
[0m05:02:02.061138 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:02:02.061345 [debug] [MainThread]: On master: Close
[0m05:02:02.061663 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:02:02.062033 [debug] [MainThread]: Connection 'model.crossborder.top_loyal_customers' was properly closed.
[0m05:02:02.062258 [info ] [MainThread]: 
[0m05:02:02.062491 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m05:02:02.069046 [debug] [MainThread]: Command end result
[0m05:02:02.091401 [info ] [MainThread]: 
[0m05:02:02.091854 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:02:02.092063 [info ] [MainThread]: 
[0m05:02:02.092308 [error] [MainThread]:   Database Error in model top_loyal_customers (models/top_loyal_customers.sql)
  column payment.total_amount does not exist
  LINE 13:     sum(payment.total_amount) as total_amount_paid
                   ^
  compiled Code at target/run/crossborder/models/top_loyal_customers.sql
[0m05:02:02.092553 [info ] [MainThread]: 
[0m05:02:02.092801 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m05:02:02.094891 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7624053, "process_user_time": 1.214882, "process_kernel_time": 0.191924, "process_mem_max_rss": "124223488", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m05:02:02.095334 [debug] [MainThread]: Command `dbt run` failed at 05:02:02.095271 after 0.76 seconds
[0m05:02:02.095641 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104664a50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100e4e090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100ee4690>]}
[0m05:02:02.095893 [debug] [MainThread]: Flushing usage events
[0m05:04:40.408389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aadf310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aadfe50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ab36410>]}


============================== 05:04:40.413101 | 856402f7-c9e4-4241-bcd7-afba03fd88ac ==============================
[0m05:04:40.413101 [info ] [MainThread]: Running with dbt=1.8.1
[0m05:04:40.413682 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/kelvin/Documents/DBTProjects/CrossBorderRental/logs', 'profiles_dir': '/Users/kelvin/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s top_loyal_customers', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:04:40.595384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '856402f7-c9e4-4241-bcd7-afba03fd88ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10af14510>]}
[0m05:04:40.625880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '856402f7-c9e4-4241-bcd7-afba03fd88ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10848b1d0>]}
[0m05:04:40.626758 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m05:04:40.639907 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m05:04:40.705752 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:04:40.706272 [debug] [MainThread]: Partial parsing: updated file: crossborder://models/top_loyal_customers.sql
[0m05:04:40.820597 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crossborder_sql.core
[0m05:04:40.823940 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '856402f7-c9e4-4241-bcd7-afba03fd88ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b3f3f50>]}
[0m05:04:40.873814 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '856402f7-c9e4-4241-bcd7-afba03fd88ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b88b090>]}
[0m05:04:40.874223 [info ] [MainThread]: Found 5 models, 413 macros
[0m05:04:40.874451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '856402f7-c9e4-4241-bcd7-afba03fd88ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6836d0>]}
[0m05:04:40.875453 [info ] [MainThread]: 
[0m05:04:40.875835 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:04:40.876410 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m05:04:40.919616 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m05:04:40.919995 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m05:04:40.920209 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:04:40.972104 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m05:04:40.973171 [debug] [ThreadPool]: On list_dvdrental: Close
[0m05:04:40.975933 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dvdrental, now list_dvdrental_transformation)
[0m05:04:40.979832 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_transformation"
[0m05:04:40.980035 [debug] [ThreadPool]: On list_dvdrental_transformation: BEGIN
[0m05:04:40.980200 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:04:40.989894 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:04:40.990125 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_transformation"
[0m05:04:40.990340 [debug] [ThreadPool]: On list_dvdrental_transformation: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "list_dvdrental_transformation"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'transformation'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'transformation'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'transformation'
  
[0m05:04:40.996415 [debug] [ThreadPool]: SQL status: SELECT 3 in 0.0 seconds
[0m05:04:40.997250 [debug] [ThreadPool]: On list_dvdrental_transformation: ROLLBACK
[0m05:04:40.997595 [debug] [ThreadPool]: On list_dvdrental_transformation: Close
[0m05:04:41.000610 [debug] [MainThread]: Using postgres connection "master"
[0m05:04:41.000805 [debug] [MainThread]: On master: BEGIN
[0m05:04:41.000965 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:04:41.010255 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:04:41.010435 [debug] [MainThread]: Using postgres connection "master"
[0m05:04:41.010698 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:04:41.038736 [debug] [MainThread]: SQL status: SELECT 58 in 0.0 seconds
[0m05:04:41.040359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '856402f7-c9e4-4241-bcd7-afba03fd88ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b5c1f10>]}
[0m05:04:41.040755 [debug] [MainThread]: On master: ROLLBACK
[0m05:04:41.041154 [debug] [MainThread]: Using postgres connection "master"
[0m05:04:41.041344 [debug] [MainThread]: On master: BEGIN
[0m05:04:41.041713 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:04:41.041893 [debug] [MainThread]: On master: COMMIT
[0m05:04:41.042056 [debug] [MainThread]: Using postgres connection "master"
[0m05:04:41.042215 [debug] [MainThread]: On master: COMMIT
[0m05:04:41.042480 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:04:41.042666 [debug] [MainThread]: On master: Close
[0m05:04:41.042970 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m05:04:41.043181 [info ] [MainThread]: 
[0m05:04:41.046429 [debug] [Thread-1 (]: Began running node model.crossborder.top_loyal_customers
[0m05:04:41.046844 [info ] [Thread-1 (]: 1 of 1 START sql view model transformation.top_loyal_customers ................. [RUN]
[0m05:04:41.047179 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dvdrental_transformation, now model.crossborder.top_loyal_customers)
[0m05:04:41.047434 [debug] [Thread-1 (]: Began compiling node model.crossborder.top_loyal_customers
[0m05:04:41.053623 [debug] [Thread-1 (]: Writing injected SQL for node "model.crossborder.top_loyal_customers"
[0m05:04:41.055111 [debug] [Thread-1 (]: Began executing node model.crossborder.top_loyal_customers
[0m05:04:41.080601 [debug] [Thread-1 (]: Writing runtime sql for node "model.crossborder.top_loyal_customers"
[0m05:04:41.081523 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_loyal_customers"
[0m05:04:41.081779 [debug] [Thread-1 (]: On model.crossborder.top_loyal_customers: BEGIN
[0m05:04:41.081987 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:04:41.090812 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:04:41.091174 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_loyal_customers"
[0m05:04:41.091438 [debug] [Thread-1 (]: On model.crossborder.top_loyal_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_loyal_customers"} */

  create view "dvdrental"."transformation"."top_loyal_customers__dbt_tmp"
    
    
  as (
    with customer_activity as (
select 
    customer.first_name,
    customer.last_name,
    concat(country.country, ' | ', city.city, ', ', address.address) as customer_address,
    count(payment.rental_id) as no_of_movies_rented,
    sum(payment.amount) as total_amount_paid
from rental
join customer
using(customer_id)
join payment
using(customer_id)
join address 
using(address_id)
join city
using(city_id)
join country
using (country_id)
group by 1, 2, 3
order by total_amount_paid desc
)

select *
from customer_activity
  );
[0m05:04:41.103796 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:04:41.108029 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_loyal_customers"
[0m05:04:41.108288 [debug] [Thread-1 (]: On model.crossborder.top_loyal_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_loyal_customers"} */
alter table "dvdrental"."transformation"."top_loyal_customers__dbt_tmp" rename to "top_loyal_customers"
[0m05:04:41.109373 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:04:41.118366 [debug] [Thread-1 (]: On model.crossborder.top_loyal_customers: COMMIT
[0m05:04:41.118691 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_loyal_customers"
[0m05:04:41.119021 [debug] [Thread-1 (]: On model.crossborder.top_loyal_customers: COMMIT
[0m05:04:41.120289 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:04:41.124330 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."transformation"."top_loyal_customers__dbt_backup"
[0m05:04:41.129290 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_loyal_customers"
[0m05:04:41.129573 [debug] [Thread-1 (]: On model.crossborder.top_loyal_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_loyal_customers"} */
drop view if exists "dvdrental"."transformation"."top_loyal_customers__dbt_backup" cascade
[0m05:04:41.130492 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:04:41.132138 [debug] [Thread-1 (]: On model.crossborder.top_loyal_customers: Close
[0m05:04:41.133155 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '856402f7-c9e4-4241-bcd7-afba03fd88ac', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b65da90>]}
[0m05:04:41.133612 [info ] [Thread-1 (]: 1 of 1 OK created sql view model transformation.top_loyal_customers ............ [[32mCREATE VIEW[0m in 0.09s]
[0m05:04:41.133984 [debug] [Thread-1 (]: Finished running node model.crossborder.top_loyal_customers
[0m05:04:41.134895 [debug] [MainThread]: Using postgres connection "master"
[0m05:04:41.135083 [debug] [MainThread]: On master: BEGIN
[0m05:04:41.135242 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:04:41.144535 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:04:41.144818 [debug] [MainThread]: On master: COMMIT
[0m05:04:41.144992 [debug] [MainThread]: Using postgres connection "master"
[0m05:04:41.145150 [debug] [MainThread]: On master: COMMIT
[0m05:04:41.145538 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:04:41.145711 [debug] [MainThread]: On master: Close
[0m05:04:41.145970 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:04:41.146133 [debug] [MainThread]: Connection 'model.crossborder.top_loyal_customers' was properly closed.
[0m05:04:41.146331 [info ] [MainThread]: 
[0m05:04:41.146538 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m05:04:41.146926 [debug] [MainThread]: Command end result
[0m05:04:41.166005 [info ] [MainThread]: 
[0m05:04:41.166398 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:04:41.166603 [info ] [MainThread]: 
[0m05:04:41.166809 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:04:41.168510 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.80811965, "process_user_time": 1.365164, "process_kernel_time": 0.255388, "process_mem_max_rss": "124108800", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m05:04:41.168889 [debug] [MainThread]: Command `dbt run` succeeded at 05:04:41.168834 after 0.81 seconds
[0m05:04:41.169155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103722150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aacffd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a44f910>]}
[0m05:04:41.169382 [debug] [MainThread]: Flushing usage events
[0m05:11:02.912915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104adfe90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b41f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b42690>]}


============================== 05:11:02.916928 | ae6427ed-b1c9-4653-8601-6aeee9389ba7 ==============================
[0m05:11:02.916928 [info ] [MainThread]: Running with dbt=1.8.1
[0m05:11:02.917378 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/kelvin/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/kelvin/Documents/DBTProjects/CrossBorderRental/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run -s top_loyal_customers', 'send_anonymous_usage_stats': 'True'}
[0m05:11:03.035260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae6427ed-b1c9-4653-8601-6aeee9389ba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104f11590>]}
[0m05:11:03.068463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae6427ed-b1c9-4653-8601-6aeee9389ba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1026532d0>]}
[0m05:11:03.069458 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m05:11:03.083770 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m05:11:03.149910 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:11:03.150383 [debug] [MainThread]: Partial parsing: updated file: crossborder://models/top_loyal_customers.sql
[0m05:11:03.263169 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crossborder_sql.core
[0m05:11:03.266462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae6427ed-b1c9-4653-8601-6aeee9389ba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bc2c90>]}
[0m05:11:03.314923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae6427ed-b1c9-4653-8601-6aeee9389ba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10588b290>]}
[0m05:11:03.315339 [info ] [MainThread]: Found 5 models, 413 macros
[0m05:11:03.315567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae6427ed-b1c9-4653-8601-6aeee9389ba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054d8f10>]}
[0m05:11:03.316489 [info ] [MainThread]: 
[0m05:11:03.316862 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:11:03.317414 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m05:11:03.354703 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m05:11:03.355039 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m05:11:03.355244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:11:03.468793 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m05:11:03.469895 [debug] [ThreadPool]: On list_dvdrental: Close
[0m05:11:03.473384 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dvdrental, now list_dvdrental_transformation)
[0m05:11:03.477898 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_transformation"
[0m05:11:03.478254 [debug] [ThreadPool]: On list_dvdrental_transformation: BEGIN
[0m05:11:03.478471 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:11:03.488899 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:11:03.490002 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_transformation"
[0m05:11:03.490468 [debug] [ThreadPool]: On list_dvdrental_transformation: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "list_dvdrental_transformation"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'transformation'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'transformation'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'transformation'
  
[0m05:11:03.505069 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m05:11:03.506692 [debug] [ThreadPool]: On list_dvdrental_transformation: ROLLBACK
[0m05:11:03.507195 [debug] [ThreadPool]: On list_dvdrental_transformation: Close
[0m05:11:03.511063 [debug] [MainThread]: Using postgres connection "master"
[0m05:11:03.511403 [debug] [MainThread]: On master: BEGIN
[0m05:11:03.511588 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:11:03.533113 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:11:03.533483 [debug] [MainThread]: Using postgres connection "master"
[0m05:11:03.533788 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:11:03.578537 [debug] [MainThread]: SQL status: SELECT 64 in 0.0 seconds
[0m05:11:03.580644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae6427ed-b1c9-4653-8601-6aeee9389ba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053f0f50>]}
[0m05:11:03.581087 [debug] [MainThread]: On master: ROLLBACK
[0m05:11:03.592877 [debug] [MainThread]: Using postgres connection "master"
[0m05:11:03.593651 [debug] [MainThread]: On master: BEGIN
[0m05:11:03.594516 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:11:03.595027 [debug] [MainThread]: On master: COMMIT
[0m05:11:03.595335 [debug] [MainThread]: Using postgres connection "master"
[0m05:11:03.595620 [debug] [MainThread]: On master: COMMIT
[0m05:11:03.596157 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:11:03.596378 [debug] [MainThread]: On master: Close
[0m05:11:03.597854 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m05:11:03.598315 [info ] [MainThread]: 
[0m05:11:03.601135 [debug] [Thread-1 (]: Began running node model.crossborder.top_loyal_customers
[0m05:11:03.601528 [info ] [Thread-1 (]: 1 of 1 START sql view model transformation.top_loyal_customers ................. [RUN]
[0m05:11:03.601865 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dvdrental_transformation, now model.crossborder.top_loyal_customers)
[0m05:11:03.602396 [debug] [Thread-1 (]: Began compiling node model.crossborder.top_loyal_customers
[0m05:11:03.610919 [debug] [Thread-1 (]: Writing injected SQL for node "model.crossborder.top_loyal_customers"
[0m05:11:03.611874 [debug] [Thread-1 (]: Began executing node model.crossborder.top_loyal_customers
[0m05:11:03.640964 [debug] [Thread-1 (]: Writing runtime sql for node "model.crossborder.top_loyal_customers"
[0m05:11:03.642100 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_loyal_customers"
[0m05:11:03.642403 [debug] [Thread-1 (]: On model.crossborder.top_loyal_customers: BEGIN
[0m05:11:03.642624 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:11:03.674822 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:11:03.675229 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_loyal_customers"
[0m05:11:03.675501 [debug] [Thread-1 (]: On model.crossborder.top_loyal_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_loyal_customers"} */

  create view "dvdrental"."transformation"."top_loyal_customers__dbt_tmp"
    
    
  as (
    with customer_activity as (
select 
    customer.first_name,
    customer.last_name,
    concat(country.country, ' | ', city.city, ', ', address.address) as customer_address,
    count(payment.rental_id) as no_of_rentals,
    sum(payment.amount) as total_amount_paid
from rental
join customer
using(customer_id)
join payment
using(customer_id)
left join address 
using(address_id)
left join city
using(city_id)
left join country
using (country_id)
group by 1, 2, 3
order by total_amount_paid desc
)

select *
from customer_activity
  );
[0m05:11:03.682289 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:11:03.686882 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_loyal_customers"
[0m05:11:03.687154 [debug] [Thread-1 (]: On model.crossborder.top_loyal_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_loyal_customers"} */
alter table "dvdrental"."transformation"."top_loyal_customers" rename to "top_loyal_customers__dbt_backup"
[0m05:11:03.688055 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:11:03.689821 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_loyal_customers"
[0m05:11:03.690045 [debug] [Thread-1 (]: On model.crossborder.top_loyal_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_loyal_customers"} */
alter table "dvdrental"."transformation"."top_loyal_customers__dbt_tmp" rename to "top_loyal_customers"
[0m05:11:03.690973 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:11:03.701159 [debug] [Thread-1 (]: On model.crossborder.top_loyal_customers: COMMIT
[0m05:11:03.701497 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_loyal_customers"
[0m05:11:03.701716 [debug] [Thread-1 (]: On model.crossborder.top_loyal_customers: COMMIT
[0m05:11:03.702679 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:11:03.707916 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."transformation"."top_loyal_customers__dbt_backup"
[0m05:11:03.711138 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_loyal_customers"
[0m05:11:03.711414 [debug] [Thread-1 (]: On model.crossborder.top_loyal_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_loyal_customers"} */
drop view if exists "dvdrental"."transformation"."top_loyal_customers__dbt_backup" cascade
[0m05:11:03.714699 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:11:03.716247 [debug] [Thread-1 (]: On model.crossborder.top_loyal_customers: Close
[0m05:11:03.717183 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae6427ed-b1c9-4653-8601-6aeee9389ba7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ee6d10>]}
[0m05:11:03.717627 [info ] [Thread-1 (]: 1 of 1 OK created sql view model transformation.top_loyal_customers ............ [[32mCREATE VIEW[0m in 0.11s]
[0m05:11:03.718001 [debug] [Thread-1 (]: Finished running node model.crossborder.top_loyal_customers
[0m05:11:03.719423 [debug] [MainThread]: Using postgres connection "master"
[0m05:11:03.719636 [debug] [MainThread]: On master: BEGIN
[0m05:11:03.719804 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:11:03.741801 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:11:03.742433 [debug] [MainThread]: On master: COMMIT
[0m05:11:03.743230 [debug] [MainThread]: Using postgres connection "master"
[0m05:11:03.743583 [debug] [MainThread]: On master: COMMIT
[0m05:11:03.744340 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:11:03.744703 [debug] [MainThread]: On master: Close
[0m05:11:03.745024 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:11:03.745192 [debug] [MainThread]: Connection 'model.crossborder.top_loyal_customers' was properly closed.
[0m05:11:03.745530 [info ] [MainThread]: 
[0m05:11:03.745862 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.43 seconds (0.43s).
[0m05:11:03.746410 [debug] [MainThread]: Command end result
[0m05:11:03.765771 [info ] [MainThread]: 
[0m05:11:03.766180 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:11:03.766387 [info ] [MainThread]: 
[0m05:11:03.766588 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:11:03.768314 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.9057774, "process_user_time": 1.267308, "process_kernel_time": 0.210544, "process_mem_max_rss": "125648896", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m05:11:03.768678 [debug] [MainThread]: Command `dbt run` succeeded at 05:11:03.768622 after 0.91 seconds
[0m05:11:03.768931 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105896590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b42590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100c55510>]}
[0m05:11:03.769169 [debug] [MainThread]: Flushing usage events
[0m05:14:38.910077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048d7dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10491f110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104936490>]}


============================== 05:14:38.914583 | f8a77f17-37f6-4714-b591-7c8a5a684131 ==============================
[0m05:14:38.914583 [info ] [MainThread]: Running with dbt=1.8.1
[0m05:14:38.915071 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/kelvin/Documents/DBTProjects/CrossBorderRental/logs', 'profiles_dir': '/Users/kelvin/.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt run -s rental_perfomance', 'send_anonymous_usage_stats': 'True'}
[0m05:14:39.182036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8a77f17-37f6-4714-b591-7c8a5a684131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a535d0>]}
[0m05:14:39.233442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f8a77f17-37f6-4714-b591-7c8a5a684131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1028ef2d0>]}
[0m05:14:39.238124 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m05:14:39.257301 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m05:14:39.333278 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m05:14:39.333761 [debug] [MainThread]: Partial parsing: added file: crossborder://models/rental_perfomance.sql
[0m05:14:39.333996 [debug] [MainThread]: Partial parsing: deleted file: crossborder://models/film_rental_perfomance.sql
[0m05:14:39.454074 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crossborder_sql.core
[0m05:14:39.457557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f8a77f17-37f6-4714-b591-7c8a5a684131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1054dc190>]}
[0m05:14:39.518016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f8a77f17-37f6-4714-b591-7c8a5a684131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10550ff50>]}
[0m05:14:39.518724 [info ] [MainThread]: Found 5 models, 413 macros
[0m05:14:39.518974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8a77f17-37f6-4714-b591-7c8a5a684131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104deba50>]}
[0m05:14:39.520054 [info ] [MainThread]: 
[0m05:14:39.520449 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:14:39.521052 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m05:14:39.595663 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m05:14:39.597875 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m05:14:39.598514 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:14:39.712494 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m05:14:39.713706 [debug] [ThreadPool]: On list_dvdrental: Close
[0m05:14:39.716864 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dvdrental, now list_dvdrental_transformation)
[0m05:14:39.721472 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_transformation"
[0m05:14:39.721784 [debug] [ThreadPool]: On list_dvdrental_transformation: BEGIN
[0m05:14:39.721981 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:14:39.730290 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:14:39.730669 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_transformation"
[0m05:14:39.730908 [debug] [ThreadPool]: On list_dvdrental_transformation: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "list_dvdrental_transformation"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'transformation'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'transformation'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'transformation'
  
[0m05:14:39.737869 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m05:14:39.739036 [debug] [ThreadPool]: On list_dvdrental_transformation: ROLLBACK
[0m05:14:39.739391 [debug] [ThreadPool]: On list_dvdrental_transformation: Close
[0m05:14:39.743226 [debug] [MainThread]: Using postgres connection "master"
[0m05:14:39.743500 [debug] [MainThread]: On master: BEGIN
[0m05:14:39.743678 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:14:39.751881 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:14:39.752307 [debug] [MainThread]: Using postgres connection "master"
[0m05:14:39.752625 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:14:39.786764 [debug] [MainThread]: SQL status: SELECT 64 in 0.0 seconds
[0m05:14:39.788419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f8a77f17-37f6-4714-b591-7c8a5a684131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10579a0d0>]}
[0m05:14:39.788858 [debug] [MainThread]: On master: ROLLBACK
[0m05:14:39.789266 [debug] [MainThread]: Using postgres connection "master"
[0m05:14:39.789448 [debug] [MainThread]: On master: BEGIN
[0m05:14:39.789797 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:14:39.789970 [debug] [MainThread]: On master: COMMIT
[0m05:14:39.790129 [debug] [MainThread]: Using postgres connection "master"
[0m05:14:39.790280 [debug] [MainThread]: On master: COMMIT
[0m05:14:39.790511 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:14:39.790688 [debug] [MainThread]: On master: Close
[0m05:14:39.792261 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m05:14:39.792468 [info ] [MainThread]: 
[0m05:14:39.794864 [debug] [Thread-1 (]: Began running node model.crossborder.rental_perfomance
[0m05:14:39.795322 [info ] [Thread-1 (]: 1 of 1 START sql view model transformation.rental_perfomance ................... [RUN]
[0m05:14:39.795667 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dvdrental_transformation, now model.crossborder.rental_perfomance)
[0m05:14:39.795898 [debug] [Thread-1 (]: Began compiling node model.crossborder.rental_perfomance
[0m05:14:39.801255 [debug] [Thread-1 (]: Writing injected SQL for node "model.crossborder.rental_perfomance"
[0m05:14:39.802008 [debug] [Thread-1 (]: Began executing node model.crossborder.rental_perfomance
[0m05:14:39.826447 [debug] [Thread-1 (]: Writing runtime sql for node "model.crossborder.rental_perfomance"
[0m05:14:39.827526 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.rental_perfomance"
[0m05:14:39.827834 [debug] [Thread-1 (]: On model.crossborder.rental_perfomance: BEGIN
[0m05:14:39.828058 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:14:39.852229 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:14:39.853041 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.rental_perfomance"
[0m05:14:39.854374 [debug] [Thread-1 (]: On model.crossborder.rental_perfomance: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.rental_perfomance"} */

  create view "dvdrental"."transformation"."rental_perfomance__dbt_tmp"
    
    
  as (
    with final as (
    select
        case when datediff(day, rntl.rental_date, rntl.return_date) > flm.rental_duration 
            then 'early_return'
        when datediff(day, rntl.rental_date, rntl.return_date) < flm.rental_duration
            then 'late_return'
        else 'on_time'
        end as rental_return_type,
        
        count(1) as total_rental_status
from rental rntl
inner join inventory invntry on rntl.inventory_id = invntry.inventory_id
inner join film flm on invntry.film_id = flm.film_id
order by rental_performance desc)

select  * 
from final
  );
[0m05:14:39.921722 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "day" does not exist
LINE 9:         case when datediff(day, rntl.rental_date, rntl.retur...
                                   ^

[0m05:14:39.922227 [debug] [Thread-1 (]: On model.crossborder.rental_perfomance: ROLLBACK
[0m05:14:39.922930 [debug] [Thread-1 (]: On model.crossborder.rental_perfomance: Close
[0m05:14:39.929267 [debug] [Thread-1 (]: Database Error in model rental_perfomance (models/rental_perfomance.sql)
  column "day" does not exist
  LINE 9:         case when datediff(day, rntl.rental_date, rntl.retur...
                                     ^
  compiled Code at target/run/crossborder/models/rental_perfomance.sql
[0m05:14:39.930312 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f8a77f17-37f6-4714-b591-7c8a5a684131', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058d6650>]}
[0m05:14:39.930776 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model transformation.rental_perfomance .......... [[31mERROR[0m in 0.13s]
[0m05:14:39.931162 [debug] [Thread-1 (]: Finished running node model.crossborder.rental_perfomance
[0m05:14:39.932487 [debug] [MainThread]: Using postgres connection "master"
[0m05:14:39.932722 [debug] [MainThread]: On master: BEGIN
[0m05:14:39.932895 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:14:40.120564 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:14:40.121228 [debug] [MainThread]: On master: COMMIT
[0m05:14:40.121481 [debug] [MainThread]: Using postgres connection "master"
[0m05:14:40.121692 [debug] [MainThread]: On master: COMMIT
[0m05:14:40.122224 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:14:40.122742 [debug] [MainThread]: On master: Close
[0m05:14:40.123314 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:14:40.123528 [debug] [MainThread]: Connection 'model.crossborder.rental_perfomance' was properly closed.
[0m05:14:40.123844 [info ] [MainThread]: 
[0m05:14:40.124224 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.60 seconds (0.60s).
[0m05:14:40.125003 [debug] [MainThread]: Command end result
[0m05:14:40.146718 [info ] [MainThread]: 
[0m05:14:40.147138 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:14:40.147397 [info ] [MainThread]: 
[0m05:14:40.147720 [error] [MainThread]:   Database Error in model rental_perfomance (models/rental_perfomance.sql)
  column "day" does not exist
  LINE 9:         case when datediff(day, rntl.rental_date, rntl.retur...
                                     ^
  compiled Code at target/run/crossborder/models/rental_perfomance.sql
[0m05:14:40.147991 [info ] [MainThread]: 
[0m05:14:40.148289 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m05:14:40.151927 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 1.2903432, "process_user_time": 1.324627, "process_kernel_time": 0.251822, "process_mem_max_rss": "120078336", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m05:14:40.152601 [debug] [MainThread]: Command `dbt run` failed at 05:14:40.152528 after 1.29 seconds
[0m05:14:40.153833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10338b290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100dae090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104936350>]}
[0m05:14:40.154257 [debug] [MainThread]: Flushing usage events
[0m05:15:52.775921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106baaf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bab790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bca550>]}


============================== 05:15:52.779516 | 83051f7b-0474-4129-b3b8-fa5ef2014c4d ==============================
[0m05:15:52.779516 [info ] [MainThread]: Running with dbt=1.8.1
[0m05:15:52.779980 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/kelvin/Documents/DBTProjects/CrossBorderRental/logs', 'version_check': 'True', 'profiles_dir': '/Users/kelvin/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s rental_perfomance', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:15:52.894737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83051f7b-0474-4129-b3b8-fa5ef2014c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bca250>]}
[0m05:15:52.923346 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83051f7b-0474-4129-b3b8-fa5ef2014c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e93310>]}
[0m05:15:52.923983 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m05:15:52.936408 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m05:15:52.997982 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:15:52.998461 [debug] [MainThread]: Partial parsing: updated file: crossborder://models/rental_perfomance.sql
[0m05:15:53.113829 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crossborder_sql.core
[0m05:15:53.117425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83051f7b-0474-4129-b3b8-fa5ef2014c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107114b90>]}
[0m05:15:53.167583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83051f7b-0474-4129-b3b8-fa5ef2014c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1077d2950>]}
[0m05:15:53.167997 [info ] [MainThread]: Found 5 models, 413 macros
[0m05:15:53.168226 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83051f7b-0474-4129-b3b8-fa5ef2014c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e93310>]}
[0m05:15:53.169172 [info ] [MainThread]: 
[0m05:15:53.169544 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:15:53.170104 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m05:15:53.208032 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m05:15:53.208343 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m05:15:53.208534 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:15:53.246251 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m05:15:53.247349 [debug] [ThreadPool]: On list_dvdrental: Close
[0m05:15:53.250196 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dvdrental, now list_dvdrental_transformation)
[0m05:15:53.254069 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_transformation"
[0m05:15:53.254288 [debug] [ThreadPool]: On list_dvdrental_transformation: BEGIN
[0m05:15:53.254466 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:15:53.266843 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:15:53.267065 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_transformation"
[0m05:15:53.267284 [debug] [ThreadPool]: On list_dvdrental_transformation: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "list_dvdrental_transformation"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'transformation'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'transformation'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'transformation'
  
[0m05:15:53.274468 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m05:15:53.275309 [debug] [ThreadPool]: On list_dvdrental_transformation: ROLLBACK
[0m05:15:53.275706 [debug] [ThreadPool]: On list_dvdrental_transformation: Close
[0m05:15:53.278806 [debug] [MainThread]: Using postgres connection "master"
[0m05:15:53.278994 [debug] [MainThread]: On master: BEGIN
[0m05:15:53.279155 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:15:53.288316 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:15:53.288507 [debug] [MainThread]: Using postgres connection "master"
[0m05:15:53.288785 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:15:53.313357 [debug] [MainThread]: SQL status: SELECT 64 in 0.0 seconds
[0m05:15:53.314707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83051f7b-0474-4129-b3b8-fa5ef2014c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107555f10>]}
[0m05:15:53.314993 [debug] [MainThread]: On master: ROLLBACK
[0m05:15:53.315338 [debug] [MainThread]: Using postgres connection "master"
[0m05:15:53.315518 [debug] [MainThread]: On master: BEGIN
[0m05:15:53.315861 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:15:53.316031 [debug] [MainThread]: On master: COMMIT
[0m05:15:53.316187 [debug] [MainThread]: Using postgres connection "master"
[0m05:15:53.316339 [debug] [MainThread]: On master: COMMIT
[0m05:15:53.316582 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:15:53.316748 [debug] [MainThread]: On master: Close
[0m05:15:53.317004 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m05:15:53.317191 [info ] [MainThread]: 
[0m05:15:53.319167 [debug] [Thread-1 (]: Began running node model.crossborder.rental_perfomance
[0m05:15:53.319475 [info ] [Thread-1 (]: 1 of 1 START sql view model transformation.rental_perfomance ................... [RUN]
[0m05:15:53.319742 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dvdrental_transformation, now model.crossborder.rental_perfomance)
[0m05:15:53.319946 [debug] [Thread-1 (]: Began compiling node model.crossborder.rental_perfomance
[0m05:15:53.324459 [debug] [Thread-1 (]: Writing injected SQL for node "model.crossborder.rental_perfomance"
[0m05:15:53.324989 [debug] [Thread-1 (]: Began executing node model.crossborder.rental_perfomance
[0m05:15:53.347071 [debug] [Thread-1 (]: Writing runtime sql for node "model.crossborder.rental_perfomance"
[0m05:15:53.348008 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.rental_perfomance"
[0m05:15:53.348295 [debug] [Thread-1 (]: On model.crossborder.rental_perfomance: BEGIN
[0m05:15:53.348512 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:15:53.358422 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:15:53.358670 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.rental_perfomance"
[0m05:15:53.358909 [debug] [Thread-1 (]: On model.crossborder.rental_perfomance: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.rental_perfomance"} */

  create view "dvdrental"."transformation"."rental_perfomance__dbt_tmp"
    
    
  as (
    with final as (
    select
        case when datediff('day', rntl.rental_date, rntl.return_date) > flm.rental_duration 
            then 'early_return'
        when datediff('day', rntl.rental_date, rntl.return_date) < flm.rental_duration
            then 'late_return'
        else 'on_time'
        end as rental_return_type,
        
        count(1) as total_rental_status
from rental rntl
inner join inventory invntry on rntl.inventory_id = invntry.inventory_id
inner join film flm on invntry.film_id = flm.film_id
order by rental_performance desc)

select  * 
from final
  );
[0m05:15:53.361293 [debug] [Thread-1 (]: Postgres adapter: Postgres error: function datediff(unknown, timestamp without time zone, timestamp without time zone) does not exist
LINE 9:         case when datediff('day', rntl.rental_date, rntl.ret...
                          ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[0m05:15:53.361533 [debug] [Thread-1 (]: On model.crossborder.rental_perfomance: ROLLBACK
[0m05:15:53.361936 [debug] [Thread-1 (]: On model.crossborder.rental_perfomance: Close
[0m05:15:53.368059 [debug] [Thread-1 (]: Database Error in model rental_perfomance (models/rental_perfomance.sql)
  function datediff(unknown, timestamp without time zone, timestamp without time zone) does not exist
  LINE 9:         case when datediff('day', rntl.rental_date, rntl.ret...
                            ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/crossborder/models/rental_perfomance.sql
[0m05:15:53.369096 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '83051f7b-0474-4129-b3b8-fa5ef2014c4d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107805e90>]}
[0m05:15:53.369550 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model transformation.rental_perfomance .......... [[31mERROR[0m in 0.05s]
[0m05:15:53.369936 [debug] [Thread-1 (]: Finished running node model.crossborder.rental_perfomance
[0m05:15:53.371107 [debug] [MainThread]: Using postgres connection "master"
[0m05:15:53.371294 [debug] [MainThread]: On master: BEGIN
[0m05:15:53.371454 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:15:53.396665 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:15:53.397018 [debug] [MainThread]: On master: COMMIT
[0m05:15:53.397192 [debug] [MainThread]: Using postgres connection "master"
[0m05:15:53.397360 [debug] [MainThread]: On master: COMMIT
[0m05:15:53.397667 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:15:53.397859 [debug] [MainThread]: On master: Close
[0m05:15:53.398170 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:15:53.398332 [debug] [MainThread]: Connection 'model.crossborder.rental_perfomance' was properly closed.
[0m05:15:53.398522 [info ] [MainThread]: 
[0m05:15:53.398730 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m05:15:53.399121 [debug] [MainThread]: Command end result
[0m05:15:53.417984 [info ] [MainThread]: 
[0m05:15:53.418382 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:15:53.418584 [info ] [MainThread]: 
[0m05:15:53.418844 [error] [MainThread]:   Database Error in model rental_perfomance (models/rental_perfomance.sql)
  function datediff(unknown, timestamp without time zone, timestamp without time zone) does not exist
  LINE 9:         case when datediff('day', rntl.rental_date, rntl.ret...
                            ^
  HINT:  No function matches the given name and argument types. You might need to add explicit type casts.
  compiled Code at target/run/crossborder/models/rental_perfomance.sql
[0m05:15:53.419056 [info ] [MainThread]: 
[0m05:15:53.419345 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m05:15:53.421490 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.68747145, "process_user_time": 1.210005, "process_kernel_time": 0.19145, "process_mem_max_rss": "124977152", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m05:15:53.422497 [debug] [MainThread]: Command `dbt run` failed at 05:15:53.422402 after 0.69 seconds
[0m05:15:53.422841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106baac90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107864350>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103352090>]}
[0m05:15:53.423096 [debug] [MainThread]: Flushing usage events
[0m05:30:03.921856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11431b810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114371d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114372450>]}


============================== 05:30:03.925898 | b77a5a1d-80e1-42ab-a475-bc3c71643a44 ==============================
[0m05:30:03.925898 [info ] [MainThread]: Running with dbt=1.8.1
[0m05:30:03.926348 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/kelvin/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/kelvin/Documents/DBTProjects/CrossBorderRental/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s rental_perfomance', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:30:04.145738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b77a5a1d-80e1-42ab-a475-bc3c71643a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114397750>]}
[0m05:30:04.178544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b77a5a1d-80e1-42ab-a475-bc3c71643a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f370d0>]}
[0m05:30:04.179400 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m05:30:04.192852 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m05:30:04.259013 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:30:04.259552 [debug] [MainThread]: Partial parsing: updated file: crossborder://models/rental_perfomance.sql
[0m05:30:04.380380 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crossborder_sql.core
[0m05:30:04.384464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b77a5a1d-80e1-42ab-a475-bc3c71643a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1148bf910>]}
[0m05:30:04.441216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b77a5a1d-80e1-42ab-a475-bc3c71643a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11525fcd0>]}
[0m05:30:04.441633 [info ] [MainThread]: Found 5 models, 413 macros
[0m05:30:04.441862 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b77a5a1d-80e1-42ab-a475-bc3c71643a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115122690>]}
[0m05:30:04.442829 [info ] [MainThread]: 
[0m05:30:04.443219 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:30:04.443808 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m05:30:04.482034 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m05:30:04.482364 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m05:30:04.482569 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:30:04.549362 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m05:30:04.550465 [debug] [ThreadPool]: On list_dvdrental: Close
[0m05:30:04.553393 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dvdrental, now list_dvdrental_transformation)
[0m05:30:04.557435 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_transformation"
[0m05:30:04.557674 [debug] [ThreadPool]: On list_dvdrental_transformation: BEGIN
[0m05:30:04.557848 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:30:04.568958 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:30:04.569199 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_transformation"
[0m05:30:04.569415 [debug] [ThreadPool]: On list_dvdrental_transformation: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "list_dvdrental_transformation"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'transformation'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'transformation'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'transformation'
  
[0m05:30:04.577384 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m05:30:04.578254 [debug] [ThreadPool]: On list_dvdrental_transformation: ROLLBACK
[0m05:30:04.578663 [debug] [ThreadPool]: On list_dvdrental_transformation: Close
[0m05:30:04.581937 [debug] [MainThread]: Using postgres connection "master"
[0m05:30:04.582134 [debug] [MainThread]: On master: BEGIN
[0m05:30:04.582300 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:30:04.593852 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:30:04.594062 [debug] [MainThread]: Using postgres connection "master"
[0m05:30:04.594340 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:30:04.621767 [debug] [MainThread]: SQL status: SELECT 64 in 0.0 seconds
[0m05:30:04.623115 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b77a5a1d-80e1-42ab-a475-bc3c71643a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1155f4e10>]}
[0m05:30:04.623382 [debug] [MainThread]: On master: ROLLBACK
[0m05:30:04.623753 [debug] [MainThread]: Using postgres connection "master"
[0m05:30:04.623918 [debug] [MainThread]: On master: BEGIN
[0m05:30:04.624308 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:30:04.624473 [debug] [MainThread]: On master: COMMIT
[0m05:30:04.624625 [debug] [MainThread]: Using postgres connection "master"
[0m05:30:04.624773 [debug] [MainThread]: On master: COMMIT
[0m05:30:04.625041 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:30:04.625207 [debug] [MainThread]: On master: Close
[0m05:30:04.625459 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m05:30:04.625655 [info ] [MainThread]: 
[0m05:30:04.627714 [debug] [Thread-1 (]: Began running node model.crossborder.rental_perfomance
[0m05:30:04.628045 [info ] [Thread-1 (]: 1 of 1 START sql view model transformation.rental_perfomance ................... [RUN]
[0m05:30:04.628334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dvdrental_transformation, now model.crossborder.rental_perfomance)
[0m05:30:04.628567 [debug] [Thread-1 (]: Began compiling node model.crossborder.rental_perfomance
[0m05:30:04.632890 [debug] [Thread-1 (]: Writing injected SQL for node "model.crossborder.rental_perfomance"
[0m05:30:04.633804 [debug] [Thread-1 (]: Began executing node model.crossborder.rental_perfomance
[0m05:30:04.658977 [debug] [Thread-1 (]: Writing runtime sql for node "model.crossborder.rental_perfomance"
[0m05:30:04.659779 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.rental_perfomance"
[0m05:30:04.660015 [debug] [Thread-1 (]: On model.crossborder.rental_perfomance: BEGIN
[0m05:30:04.660220 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:30:04.671291 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:30:04.671614 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.rental_perfomance"
[0m05:30:04.671886 [debug] [Thread-1 (]: On model.crossborder.rental_perfomance: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.rental_perfomance"} */

  create view "dvdrental"."transformation"."rental_perfomance__dbt_tmp"
    
    
  as (
    with days_difference as (
    select inventory_id,
    date_part('day', return_date - rental_date) as date_difference
    from rental
    ),

final as (
    select film.film_id,
        case when date_difference < rental_duration then 'Returned early',
        when date_difference = rental_duration then 'Returned on time'
        else 'Returned late'
        end AS return_status
    from film
    join inventory
    using(film_id)
    join days_difference
    USING(inventory_id)
    )

select 
    return_status, 
    count(film_id) total_films
from final
group by return_status
  );
[0m05:30:04.672479 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near ","
LINE 15: ...hen date_difference < rental_duration then 'Returned early',
                                                                       ^

[0m05:30:04.672715 [debug] [Thread-1 (]: On model.crossborder.rental_perfomance: ROLLBACK
[0m05:30:04.673228 [debug] [Thread-1 (]: On model.crossborder.rental_perfomance: Close
[0m05:30:04.679544 [debug] [Thread-1 (]: Database Error in model rental_perfomance (models/rental_perfomance.sql)
  syntax error at or near ","
  LINE 15: ...hen date_difference < rental_duration then 'Returned early',
                                                                         ^
  compiled Code at target/run/crossborder/models/rental_perfomance.sql
[0m05:30:04.680633 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b77a5a1d-80e1-42ab-a475-bc3c71643a44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1152945d0>]}
[0m05:30:04.681105 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model transformation.rental_perfomance .......... [[31mERROR[0m in 0.05s]
[0m05:30:04.681495 [debug] [Thread-1 (]: Finished running node model.crossborder.rental_perfomance
[0m05:30:04.682756 [debug] [MainThread]: Using postgres connection "master"
[0m05:30:04.682946 [debug] [MainThread]: On master: BEGIN
[0m05:30:04.683104 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:30:04.692663 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:30:04.692980 [debug] [MainThread]: On master: COMMIT
[0m05:30:04.693185 [debug] [MainThread]: Using postgres connection "master"
[0m05:30:04.693357 [debug] [MainThread]: On master: COMMIT
[0m05:30:04.693590 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:30:04.693771 [debug] [MainThread]: On master: Close
[0m05:30:04.694050 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:30:04.694215 [debug] [MainThread]: Connection 'model.crossborder.rental_perfomance' was properly closed.
[0m05:30:04.694428 [info ] [MainThread]: 
[0m05:30:04.694669 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.25 seconds (0.25s).
[0m05:30:04.695083 [debug] [MainThread]: Command end result
[0m05:30:04.715076 [info ] [MainThread]: 
[0m05:30:04.715549 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:30:04.715748 [info ] [MainThread]: 
[0m05:30:04.716003 [error] [MainThread]:   Database Error in model rental_perfomance (models/rental_perfomance.sql)
  syntax error at or near ","
  LINE 15: ...hen date_difference < rental_duration then 'Returned early',
                                                                         ^
  compiled Code at target/run/crossborder/models/rental_perfomance.sql
[0m05:30:04.716196 [info ] [MainThread]: 
[0m05:30:04.716384 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m05:30:04.718061 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.8376802, "process_user_time": 1.250235, "process_kernel_time": 0.20633, "process_mem_max_rss": "121389056", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m05:30:04.718446 [debug] [MainThread]: Command `dbt run` failed at 05:30:04.718392 after 0.84 seconds
[0m05:30:04.718724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053fe090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114372450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105494690>]}
[0m05:30:04.718956 [debug] [MainThread]: Flushing usage events
[0m05:30:35.319723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11011f4d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1101421d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110142910>]}


============================== 05:30:35.326850 | aefd200b-d7c2-4655-a049-70caa2236c98 ==============================
[0m05:30:35.326850 [info ] [MainThread]: Running with dbt=1.8.1
[0m05:30:35.327434 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/kelvin/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/kelvin/Documents/DBTProjects/CrossBorderRental/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s rental_perfomance', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:30:35.464343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aefd200b-d7c2-4655-a049-70caa2236c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11056cf50>]}
[0m05:30:35.496642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aefd200b-d7c2-4655-a049-70caa2236c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1052274d0>]}
[0m05:30:35.497533 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m05:30:35.510830 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m05:30:35.581871 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:30:35.582379 [debug] [MainThread]: Partial parsing: updated file: crossborder://models/rental_perfomance.sql
[0m05:30:35.696885 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crossborder_sql.core
[0m05:30:35.700451 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aefd200b-d7c2-4655-a049-70caa2236c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107c65250>]}
[0m05:30:35.751916 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aefd200b-d7c2-4655-a049-70caa2236c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11105f4d0>]}
[0m05:30:35.752350 [info ] [MainThread]: Found 5 models, 413 macros
[0m05:30:35.752586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aefd200b-d7c2-4655-a049-70caa2236c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110fc2550>]}
[0m05:30:35.753661 [info ] [MainThread]: 
[0m05:30:35.754073 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:30:35.754710 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m05:30:35.793755 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m05:30:35.794148 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m05:30:35.794375 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:30:35.839239 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m05:30:35.840272 [debug] [ThreadPool]: On list_dvdrental: Close
[0m05:30:35.843094 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dvdrental, now list_dvdrental_transformation)
[0m05:30:35.847038 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_transformation"
[0m05:30:35.847256 [debug] [ThreadPool]: On list_dvdrental_transformation: BEGIN
[0m05:30:35.847427 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:30:35.857582 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:30:35.857788 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_transformation"
[0m05:30:35.858006 [debug] [ThreadPool]: On list_dvdrental_transformation: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "list_dvdrental_transformation"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'transformation'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'transformation'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'transformation'
  
[0m05:30:35.865676 [debug] [ThreadPool]: SQL status: SELECT 4 in 0.0 seconds
[0m05:30:35.866532 [debug] [ThreadPool]: On list_dvdrental_transformation: ROLLBACK
[0m05:30:35.866987 [debug] [ThreadPool]: On list_dvdrental_transformation: Close
[0m05:30:35.870198 [debug] [MainThread]: Using postgres connection "master"
[0m05:30:35.870411 [debug] [MainThread]: On master: BEGIN
[0m05:30:35.870577 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:30:35.880935 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:30:35.881143 [debug] [MainThread]: Using postgres connection "master"
[0m05:30:35.881414 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:30:35.907845 [debug] [MainThread]: SQL status: SELECT 64 in 0.0 seconds
[0m05:30:35.909285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aefd200b-d7c2-4655-a049-70caa2236c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071e46d0>]}
[0m05:30:35.909576 [debug] [MainThread]: On master: ROLLBACK
[0m05:30:35.909928 [debug] [MainThread]: Using postgres connection "master"
[0m05:30:35.910120 [debug] [MainThread]: On master: BEGIN
[0m05:30:35.910566 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:30:35.910753 [debug] [MainThread]: On master: COMMIT
[0m05:30:35.910914 [debug] [MainThread]: Using postgres connection "master"
[0m05:30:35.911068 [debug] [MainThread]: On master: COMMIT
[0m05:30:35.911339 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:30:35.911510 [debug] [MainThread]: On master: Close
[0m05:30:35.911778 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m05:30:35.911977 [info ] [MainThread]: 
[0m05:30:35.914492 [debug] [Thread-1 (]: Began running node model.crossborder.rental_perfomance
[0m05:30:35.914812 [info ] [Thread-1 (]: 1 of 1 START sql view model transformation.rental_perfomance ................... [RUN]
[0m05:30:35.915092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dvdrental_transformation, now model.crossborder.rental_perfomance)
[0m05:30:35.915304 [debug] [Thread-1 (]: Began compiling node model.crossborder.rental_perfomance
[0m05:30:35.919526 [debug] [Thread-1 (]: Writing injected SQL for node "model.crossborder.rental_perfomance"
[0m05:30:35.920061 [debug] [Thread-1 (]: Began executing node model.crossborder.rental_perfomance
[0m05:30:35.941402 [debug] [Thread-1 (]: Writing runtime sql for node "model.crossborder.rental_perfomance"
[0m05:30:35.942081 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.rental_perfomance"
[0m05:30:35.942469 [debug] [Thread-1 (]: On model.crossborder.rental_perfomance: BEGIN
[0m05:30:35.942747 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:30:35.967102 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:30:35.967590 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.rental_perfomance"
[0m05:30:35.967878 [debug] [Thread-1 (]: On model.crossborder.rental_perfomance: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.rental_perfomance"} */

  create view "dvdrental"."transformation"."rental_perfomance__dbt_tmp"
    
    
  as (
    with days_difference as (
    select inventory_id,
    date_part('day', return_date - rental_date) as date_difference
    from rental
    ),

final as (
    select film.film_id,
        case when date_difference < rental_duration then 'Returned early'
        when date_difference = rental_duration then 'Returned on time'
        else 'Returned late'
        end AS return_status
    from film
    join inventory
    using(film_id)
    join days_difference
    USING(inventory_id)
    )

select 
    return_status, 
    count(film_id) total_films
from final
group by return_status
  );
[0m05:30:35.974930 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:30:35.979833 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.rental_perfomance"
[0m05:30:35.980173 [debug] [Thread-1 (]: On model.crossborder.rental_perfomance: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.rental_perfomance"} */
alter table "dvdrental"."transformation"."rental_perfomance__dbt_tmp" rename to "rental_perfomance"
[0m05:30:35.980934 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:30:35.989635 [debug] [Thread-1 (]: On model.crossborder.rental_perfomance: COMMIT
[0m05:30:35.989937 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.rental_perfomance"
[0m05:30:35.990144 [debug] [Thread-1 (]: On model.crossborder.rental_perfomance: COMMIT
[0m05:30:35.991935 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:30:35.995675 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."transformation"."rental_perfomance__dbt_backup"
[0m05:30:36.000554 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.rental_perfomance"
[0m05:30:36.000893 [debug] [Thread-1 (]: On model.crossborder.rental_perfomance: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.rental_perfomance"} */
drop view if exists "dvdrental"."transformation"."rental_perfomance__dbt_backup" cascade
[0m05:30:36.001509 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:30:36.003011 [debug] [Thread-1 (]: On model.crossborder.rental_perfomance: Close
[0m05:30:36.003951 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aefd200b-d7c2-4655-a049-70caa2236c98', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110d32cd0>]}
[0m05:30:36.004406 [info ] [Thread-1 (]: 1 of 1 OK created sql view model transformation.rental_perfomance .............. [[32mCREATE VIEW[0m in 0.09s]
[0m05:30:36.004780 [debug] [Thread-1 (]: Finished running node model.crossborder.rental_perfomance
[0m05:30:36.005651 [debug] [MainThread]: Using postgres connection "master"
[0m05:30:36.005845 [debug] [MainThread]: On master: BEGIN
[0m05:30:36.006015 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:30:36.016460 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:30:36.016712 [debug] [MainThread]: On master: COMMIT
[0m05:30:36.016888 [debug] [MainThread]: Using postgres connection "master"
[0m05:30:36.017053 [debug] [MainThread]: On master: COMMIT
[0m05:30:36.017338 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:30:36.017514 [debug] [MainThread]: On master: Close
[0m05:30:36.017766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:30:36.017927 [debug] [MainThread]: Connection 'model.crossborder.rental_perfomance' was properly closed.
[0m05:30:36.018124 [info ] [MainThread]: 
[0m05:30:36.018332 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m05:30:36.018705 [debug] [MainThread]: Command end result
[0m05:30:36.037197 [info ] [MainThread]: 
[0m05:30:36.037713 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:30:36.037931 [info ] [MainThread]: 
[0m05:30:36.038146 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:30:36.039702 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.77978206, "process_user_time": 1.299684, "process_kernel_time": 0.204236, "process_mem_max_rss": "125272064", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m05:30:36.040081 [debug] [MainThread]: Command `dbt run` succeeded at 05:30:36.040028 after 0.78 seconds
[0m05:30:36.042673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110156410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111499d10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110142750>]}
[0m05:30:36.044062 [debug] [MainThread]: Flushing usage events
[0m05:39:26.163516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b717bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b714ad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b77e6d0>]}


============================== 05:39:26.167218 | f62b564a-59e9-4bb6-895b-7129d1cb60a9 ==============================
[0m05:39:26.167218 [info ] [MainThread]: Running with dbt=1.8.1
[0m05:39:26.167685 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/kelvin/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/kelvin/Documents/DBTProjects/CrossBorderRental/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run -s top_5_in_demand_genres', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:39:26.303430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f62b564a-59e9-4bb6-895b-7129d1cb60a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c0bc950>]}
[0m05:39:26.334950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f62b564a-59e9-4bb6-895b-7129d1cb60a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1092ab2d0>]}
[0m05:39:26.335803 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m05:39:26.348218 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m05:39:26.425493 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m05:39:26.425934 [debug] [MainThread]: Partial parsing: added file: crossborder://models/top_5_in_demand_genres.sql
[0m05:39:26.426136 [debug] [MainThread]: Partial parsing: deleted file: crossborder://models/top_three_in_demand_genres.sql
[0m05:39:26.537049 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crossborder_sql.core
[0m05:39:26.540309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f62b564a-59e9-4bb6-895b-7129d1cb60a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1a2c90>]}
[0m05:39:26.595436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f62b564a-59e9-4bb6-895b-7129d1cb60a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c68b0d0>]}
[0m05:39:26.595858 [info ] [MainThread]: Found 5 models, 413 macros
[0m05:39:26.596142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f62b564a-59e9-4bb6-895b-7129d1cb60a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c647350>]}
[0m05:39:26.597233 [info ] [MainThread]: 
[0m05:39:26.597788 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:39:26.598584 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m05:39:26.637174 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m05:39:26.637535 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m05:39:26.637747 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:39:26.692176 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m05:39:26.693370 [debug] [ThreadPool]: On list_dvdrental: Close
[0m05:39:26.696318 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dvdrental, now list_dvdrental_transformation)
[0m05:39:26.700352 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_transformation"
[0m05:39:26.700658 [debug] [ThreadPool]: On list_dvdrental_transformation: BEGIN
[0m05:39:26.700848 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:39:26.711282 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:39:26.711551 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_transformation"
[0m05:39:26.711758 [debug] [ThreadPool]: On list_dvdrental_transformation: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "list_dvdrental_transformation"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'transformation'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'transformation'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'transformation'
  
[0m05:39:26.720783 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m05:39:26.721664 [debug] [ThreadPool]: On list_dvdrental_transformation: ROLLBACK
[0m05:39:26.721989 [debug] [ThreadPool]: On list_dvdrental_transformation: Close
[0m05:39:26.725262 [debug] [MainThread]: Using postgres connection "master"
[0m05:39:26.725463 [debug] [MainThread]: On master: BEGIN
[0m05:39:26.725623 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:39:26.737986 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:39:26.738199 [debug] [MainThread]: Using postgres connection "master"
[0m05:39:26.738467 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:39:26.762395 [debug] [MainThread]: SQL status: SELECT 67 in 0.0 seconds
[0m05:39:26.763817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f62b564a-59e9-4bb6-895b-7129d1cb60a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c8e9310>]}
[0m05:39:26.764087 [debug] [MainThread]: On master: ROLLBACK
[0m05:39:26.764384 [debug] [MainThread]: Using postgres connection "master"
[0m05:39:26.764548 [debug] [MainThread]: On master: BEGIN
[0m05:39:26.764892 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:39:26.765079 [debug] [MainThread]: On master: COMMIT
[0m05:39:26.765248 [debug] [MainThread]: Using postgres connection "master"
[0m05:39:26.765407 [debug] [MainThread]: On master: COMMIT
[0m05:39:26.765673 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:39:26.765844 [debug] [MainThread]: On master: Close
[0m05:39:26.766110 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m05:39:26.766305 [info ] [MainThread]: 
[0m05:39:26.768314 [debug] [Thread-1 (]: Began running node model.crossborder.top_5_in_demand_genres
[0m05:39:26.768640 [info ] [Thread-1 (]: 1 of 1 START sql view model transformation.top_5_in_demand_genres .............. [RUN]
[0m05:39:26.768914 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dvdrental_transformation, now model.crossborder.top_5_in_demand_genres)
[0m05:39:26.769123 [debug] [Thread-1 (]: Began compiling node model.crossborder.top_5_in_demand_genres
[0m05:39:26.773330 [debug] [Thread-1 (]: Writing injected SQL for node "model.crossborder.top_5_in_demand_genres"
[0m05:39:26.773874 [debug] [Thread-1 (]: Began executing node model.crossborder.top_5_in_demand_genres
[0m05:39:26.795265 [debug] [Thread-1 (]: Writing runtime sql for node "model.crossborder.top_5_in_demand_genres"
[0m05:39:26.795985 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_5_in_demand_genres"
[0m05:39:26.796221 [debug] [Thread-1 (]: On model.crossborder.top_5_in_demand_genres: BEGIN
[0m05:39:26.796422 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:39:26.805149 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:39:26.805520 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_5_in_demand_genres"
[0m05:39:26.805810 [debug] [Thread-1 (]: On model.crossborder.top_5_in_demand_genres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_5_in_demand_genres"} */

  create view "dvdrental"."transformation"."top_5_in_demand_genres__dbt_tmp"
    
    
  as (
    with final as (
    select distinct ctgry.name as genre,
        count(cstmr.customer_id) as demand, sum(pymnt.amount) as total_sales
from category ctgry
inner join film_category flm_ctgry on ctgry.category_id = flm_ctgry.category_id
inner join film on flm_ctgry.film_id = film.film_id
inner join inventory invtry on film.film_id = invtry.film_id
inner join rental rntl on invtry.inventory_id = rntl.inventory_id
inner join customer cstmr on rntl.customer_id = cstmr.customer_id
inner join payment pymnt on rntl.rental_id = pymnt.rental_id
group by ctgry.category_id, ctgry.name
order by demand desc, total_sales desc
limit 5
)

select *
from final
  );
[0m05:39:26.827073 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:39:26.831698 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_5_in_demand_genres"
[0m05:39:26.832241 [debug] [Thread-1 (]: On model.crossborder.top_5_in_demand_genres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_5_in_demand_genres"} */
alter table "dvdrental"."transformation"."top_5_in_demand_genres__dbt_tmp" rename to "top_5_in_demand_genres"
[0m05:39:26.833324 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:39:26.843625 [debug] [Thread-1 (]: On model.crossborder.top_5_in_demand_genres: COMMIT
[0m05:39:26.843954 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_5_in_demand_genres"
[0m05:39:26.844170 [debug] [Thread-1 (]: On model.crossborder.top_5_in_demand_genres: COMMIT
[0m05:39:26.845556 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:39:26.850121 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."transformation"."top_5_in_demand_genres__dbt_backup"
[0m05:39:26.854560 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_5_in_demand_genres"
[0m05:39:26.854851 [debug] [Thread-1 (]: On model.crossborder.top_5_in_demand_genres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_5_in_demand_genres"} */
drop view if exists "dvdrental"."transformation"."top_5_in_demand_genres__dbt_backup" cascade
[0m05:39:26.855489 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:39:26.856980 [debug] [Thread-1 (]: On model.crossborder.top_5_in_demand_genres: Close
[0m05:39:26.858404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f62b564a-59e9-4bb6-895b-7129d1cb60a9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1d6490>]}
[0m05:39:26.858875 [info ] [Thread-1 (]: 1 of 1 OK created sql view model transformation.top_5_in_demand_genres ......... [[32mCREATE VIEW[0m in 0.09s]
[0m05:39:26.859327 [debug] [Thread-1 (]: Finished running node model.crossborder.top_5_in_demand_genres
[0m05:39:26.860237 [debug] [MainThread]: Using postgres connection "master"
[0m05:39:26.860451 [debug] [MainThread]: On master: BEGIN
[0m05:39:26.860623 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:39:26.869088 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:39:26.869394 [debug] [MainThread]: On master: COMMIT
[0m05:39:26.869579 [debug] [MainThread]: Using postgres connection "master"
[0m05:39:26.869748 [debug] [MainThread]: On master: COMMIT
[0m05:39:26.870043 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:39:26.870223 [debug] [MainThread]: On master: Close
[0m05:39:26.870490 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:39:26.870658 [debug] [MainThread]: Connection 'model.crossborder.top_5_in_demand_genres' was properly closed.
[0m05:39:26.870860 [info ] [MainThread]: 
[0m05:39:26.871067 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.27 seconds (0.27s).
[0m05:39:26.871460 [debug] [MainThread]: Command end result
[0m05:39:26.889831 [info ] [MainThread]: 
[0m05:39:26.890231 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:39:26.890431 [info ] [MainThread]: 
[0m05:39:26.890630 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:39:26.892461 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.77549994, "process_user_time": 1.250451, "process_kernel_time": 0.196485, "process_mem_max_rss": "119111680", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m05:39:26.892834 [debug] [MainThread]: Command `dbt run` succeeded at 05:39:26.892779 after 0.78 seconds
[0m05:39:26.893091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105052090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b1a3b10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b542450>]}
[0m05:39:26.893324 [debug] [MainThread]: Flushing usage events
[0m05:54:36.402067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108d18c90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a21f1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a242b50>]}


============================== 05:54:36.406365 | 32b275c4-78d8-4da6-9f5a-dd5c8a17cb72 ==============================
[0m05:54:36.406365 [info ] [MainThread]: Running with dbt=1.8.1
[0m05:54:36.406820 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/kelvin/Documents/DBTProjects/CrossBorderRental/logs', 'profiles_dir': '/Users/kelvin/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s top_5_in_demand_genres', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m05:54:36.549308 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '32b275c4-78d8-4da6-9f5a-dd5c8a17cb72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a27d190>]}
[0m05:54:36.579097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '32b275c4-78d8-4da6-9f5a-dd5c8a17cb72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10692b6d0>]}
[0m05:54:36.579919 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m05:54:36.601655 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m05:54:36.670136 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m05:54:36.670642 [debug] [MainThread]: Partial parsing: added file: crossborder://models/top_5_in_demand_genre.sql
[0m05:54:36.670858 [debug] [MainThread]: Partial parsing: deleted file: crossborder://models/top_5_in_demand_genres.sql
[0m05:54:36.785493 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crossborder_sql.core
[0m05:54:36.788938 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '32b275c4-78d8-4da6-9f5a-dd5c8a17cb72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a631850>]}
[0m05:54:36.838585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '32b275c4-78d8-4da6-9f5a-dd5c8a17cb72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10be1f5d0>]}
[0m05:54:36.839040 [info ] [MainThread]: Found 5 models, 413 macros
[0m05:54:36.839281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '32b275c4-78d8-4da6-9f5a-dd5c8a17cb72', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a675110>]}
[0m05:54:36.839755 [warn ] [MainThread]: The selection criterion 'top_5_in_demand_genres' does not match any enabled nodes
[0m05:54:36.840504 [info ] [MainThread]: 
[0m05:54:36.840729 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m05:54:36.841028 [debug] [MainThread]: Command end result
[0m05:54:36.861125 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.524644, "process_user_time": 1.170378, "process_kernel_time": 0.187266, "process_mem_max_rss": "109789184", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m05:54:36.861770 [debug] [MainThread]: Command `dbt run` succeeded at 05:54:36.861671 after 0.53 seconds
[0m05:54:36.862167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aaa090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a2113d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104bed590>]}
[0m05:54:36.862491 [debug] [MainThread]: Flushing usage events
[0m05:55:08.533155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061d8550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1061d8e50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106225650>]}


============================== 05:55:08.537415 | 05bb4d27-088f-4e31-bd92-f7d8a36e3eb2 ==============================
[0m05:55:08.537415 [info ] [MainThread]: Running with dbt=1.8.1
[0m05:55:08.538042 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/kelvin/.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/kelvin/Documents/DBTProjects/CrossBorderRental/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s top_5_in_demand_genres', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:55:08.655583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05bb4d27-088f-4e31-bd92-f7d8a36e3eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106225350>]}
[0m05:55:08.684579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05bb4d27-088f-4e31-bd92-f7d8a36e3eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c37210>]}
[0m05:55:08.685339 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m05:55:08.698996 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m05:55:08.765633 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m05:55:08.766165 [debug] [MainThread]: Partial parsing: added file: crossborder://models/top_5_in_demand_genres.sql
[0m05:55:08.766396 [debug] [MainThread]: Partial parsing: deleted file: crossborder://models/top_5_in_demand_genre.sql
[0m05:55:08.889364 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crossborder_sql.core
[0m05:55:08.893069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05bb4d27-088f-4e31-bd92-f7d8a36e3eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cd8b50>]}
[0m05:55:08.945987 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05bb4d27-088f-4e31-bd92-f7d8a36e3eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e3b410>]}
[0m05:55:08.946411 [info ] [MainThread]: Found 5 models, 413 macros
[0m05:55:08.946645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05bb4d27-088f-4e31-bd92-f7d8a36e3eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bd9f50>]}
[0m05:55:08.947634 [info ] [MainThread]: 
[0m05:55:08.948031 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:55:08.948603 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m05:55:08.988155 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m05:55:08.988504 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m05:55:08.988713 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:55:09.119078 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m05:55:09.120234 [debug] [ThreadPool]: On list_dvdrental: Close
[0m05:55:09.123805 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dvdrental, now list_dvdrental_transformation)
[0m05:55:09.128469 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_transformation"
[0m05:55:09.128857 [debug] [ThreadPool]: On list_dvdrental_transformation: BEGIN
[0m05:55:09.129061 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:55:09.139235 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:55:09.140039 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_transformation"
[0m05:55:09.140292 [debug] [ThreadPool]: On list_dvdrental_transformation: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "list_dvdrental_transformation"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'transformation'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'transformation'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'transformation'
  
[0m05:55:09.152413 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m05:55:09.154072 [debug] [ThreadPool]: On list_dvdrental_transformation: ROLLBACK
[0m05:55:09.154736 [debug] [ThreadPool]: On list_dvdrental_transformation: Close
[0m05:55:09.160066 [debug] [MainThread]: Using postgres connection "master"
[0m05:55:09.160489 [debug] [MainThread]: On master: BEGIN
[0m05:55:09.161003 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:55:09.196460 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:55:09.196854 [debug] [MainThread]: Using postgres connection "master"
[0m05:55:09.197162 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:55:09.242670 [debug] [MainThread]: SQL status: SELECT 74 in 0.0 seconds
[0m05:55:09.246112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05bb4d27-088f-4e31-bd92-f7d8a36e3eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065c9410>]}
[0m05:55:09.247017 [debug] [MainThread]: On master: ROLLBACK
[0m05:55:09.247799 [debug] [MainThread]: Using postgres connection "master"
[0m05:55:09.248007 [debug] [MainThread]: On master: BEGIN
[0m05:55:09.248754 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:55:09.249287 [debug] [MainThread]: On master: COMMIT
[0m05:55:09.249531 [debug] [MainThread]: Using postgres connection "master"
[0m05:55:09.249738 [debug] [MainThread]: On master: COMMIT
[0m05:55:09.250457 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:55:09.251347 [debug] [MainThread]: On master: Close
[0m05:55:09.251976 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m05:55:09.252421 [info ] [MainThread]: 
[0m05:55:09.255460 [debug] [Thread-1 (]: Began running node model.crossborder.top_5_in_demand_genres
[0m05:55:09.256067 [info ] [Thread-1 (]: 1 of 1 START sql view model transformation.top_5_in_demand_genres .............. [RUN]
[0m05:55:09.256770 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dvdrental_transformation, now model.crossborder.top_5_in_demand_genres)
[0m05:55:09.257454 [debug] [Thread-1 (]: Began compiling node model.crossborder.top_5_in_demand_genres
[0m05:55:09.268857 [debug] [Thread-1 (]: Writing injected SQL for node "model.crossborder.top_5_in_demand_genres"
[0m05:55:09.272365 [debug] [Thread-1 (]: Began executing node model.crossborder.top_5_in_demand_genres
[0m05:55:09.299495 [debug] [Thread-1 (]: Writing runtime sql for node "model.crossborder.top_5_in_demand_genres"
[0m05:55:09.300432 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_5_in_demand_genres"
[0m05:55:09.300725 [debug] [Thread-1 (]: On model.crossborder.top_5_in_demand_genres: BEGIN
[0m05:55:09.300949 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:55:09.321586 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:55:09.321988 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_5_in_demand_genres"
[0m05:55:09.322421 [debug] [Thread-1 (]: On model.crossborder.top_5_in_demand_genres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_5_in_demand_genres"} */

  create view "dvdrental"."transformation"."top_5_in_demand_genres__dbt_tmp"
    
    
  as (
    with genre_movie_demand as (
    select 
        category.name as genre,
        count(cstmr.customer_id) as total_rent_demand,
        sum(pymnt.amount) as total_sales
    from category
    join film_category
    on using(category_id)
    join film
    using(film_id)
    join inventory
    using(film_id)
    join rental 
    on inventory.inventory_id = rental.inventory_id
    join customer 
    on rental.customer_id = customer.customer_id
    join payment
    on rental.rental_id = payment.rental_id
    group by category.category_id, category.name
    order by demand desc, total_sales desc
    limit 5
)

select *
from genre_movie_demand
  );
[0m05:55:09.323041 [debug] [Thread-1 (]: Postgres adapter: Postgres error: syntax error at or near "using"
LINE 14:     on using(category_id)
                ^

[0m05:55:09.323457 [debug] [Thread-1 (]: On model.crossborder.top_5_in_demand_genres: ROLLBACK
[0m05:55:09.324380 [debug] [Thread-1 (]: On model.crossborder.top_5_in_demand_genres: Close
[0m05:55:09.331742 [debug] [Thread-1 (]: Database Error in model top_5_in_demand_genres (models/top_5_in_demand_genres.sql)
  syntax error at or near "using"
  LINE 14:     on using(category_id)
                  ^
  compiled Code at target/run/crossborder/models/top_5_in_demand_genres.sql
[0m05:55:09.333334 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05bb4d27-088f-4e31-bd92-f7d8a36e3eb2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071b2e90>]}
[0m05:55:09.333946 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model transformation.top_5_in_demand_genres ..... [[31mERROR[0m in 0.08s]
[0m05:55:09.334387 [debug] [Thread-1 (]: Finished running node model.crossborder.top_5_in_demand_genres
[0m05:55:09.336127 [debug] [MainThread]: Using postgres connection "master"
[0m05:55:09.336477 [debug] [MainThread]: On master: BEGIN
[0m05:55:09.336682 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:55:09.345810 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:55:09.346180 [debug] [MainThread]: On master: COMMIT
[0m05:55:09.346411 [debug] [MainThread]: Using postgres connection "master"
[0m05:55:09.346590 [debug] [MainThread]: On master: COMMIT
[0m05:55:09.347285 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:55:09.347555 [debug] [MainThread]: On master: Close
[0m05:55:09.348233 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:55:09.348663 [debug] [MainThread]: Connection 'model.crossborder.top_5_in_demand_genres' was properly closed.
[0m05:55:09.348926 [info ] [MainThread]: 
[0m05:55:09.349468 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.40 seconds (0.40s).
[0m05:55:09.350030 [debug] [MainThread]: Command end result
[0m05:55:09.384403 [info ] [MainThread]: 
[0m05:55:09.385030 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:55:09.385312 [info ] [MainThread]: 
[0m05:55:09.385976 [error] [MainThread]:   Database Error in model top_5_in_demand_genres (models/top_5_in_demand_genres.sql)
  syntax error at or near "using"
  LINE 14:     on using(category_id)
                  ^
  compiled Code at target/run/crossborder/models/top_5_in_demand_genres.sql
[0m05:55:09.386456 [info ] [MainThread]: 
[0m05:55:09.387243 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m05:55:09.389442 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.9279106, "process_user_time": 1.262884, "process_kernel_time": 0.197827, "process_mem_max_rss": "120832000", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m05:55:09.390308 [debug] [MainThread]: Command `dbt run` failed at 05:55:09.390212 after 0.93 seconds
[0m05:55:09.390682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100a0e090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100aa5310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100aa4fd0>]}
[0m05:55:09.391017 [debug] [MainThread]: Flushing usage events
[0m05:55:48.901282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050dfd10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1050dca10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105111050>]}


============================== 05:55:48.905071 | bf901d3a-b7fb-41f9-8c28-ef4d5d3c6ff2 ==============================
[0m05:55:48.905071 [info ] [MainThread]: Running with dbt=1.8.1
[0m05:55:48.905495 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/Users/kelvin/.dbt', 'log_path': '/Users/kelvin/Documents/DBTProjects/CrossBorderRental/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s top_5_in_demand_genres', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:55:49.035554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf901d3a-b7fb-41f9-8c28-ef4d5d3c6ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a7cc50>]}
[0m05:55:49.065407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf901d3a-b7fb-41f9-8c28-ef4d5d3c6ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10301b990>]}
[0m05:55:49.066352 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m05:55:49.083118 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m05:55:49.151948 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:55:49.152434 [debug] [MainThread]: Partial parsing: updated file: crossborder://models/top_5_in_demand_genres.sql
[0m05:55:49.265070 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crossborder_sql.core
[0m05:55:49.268329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf901d3a-b7fb-41f9-8c28-ef4d5d3c6ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105125190>]}
[0m05:55:49.322527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf901d3a-b7fb-41f9-8c28-ef4d5d3c6ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10605f710>]}
[0m05:55:49.323001 [info ] [MainThread]: Found 5 models, 413 macros
[0m05:55:49.323267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf901d3a-b7fb-41f9-8c28-ef4d5d3c6ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a1f1d0>]}
[0m05:55:49.324384 [info ] [MainThread]: 
[0m05:55:49.324824 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:55:49.325463 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m05:55:49.369058 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m05:55:49.369414 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m05:55:49.369631 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:55:49.407636 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m05:55:49.408739 [debug] [ThreadPool]: On list_dvdrental: Close
[0m05:55:49.411802 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dvdrental, now list_dvdrental_transformation)
[0m05:55:49.416075 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_transformation"
[0m05:55:49.416348 [debug] [ThreadPool]: On list_dvdrental_transformation: BEGIN
[0m05:55:49.416528 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:55:49.427361 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:55:49.427629 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_transformation"
[0m05:55:49.427860 [debug] [ThreadPool]: On list_dvdrental_transformation: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "list_dvdrental_transformation"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'transformation'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'transformation'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'transformation'
  
[0m05:55:49.437551 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m05:55:49.438458 [debug] [ThreadPool]: On list_dvdrental_transformation: ROLLBACK
[0m05:55:49.438771 [debug] [ThreadPool]: On list_dvdrental_transformation: Close
[0m05:55:49.442165 [debug] [MainThread]: Using postgres connection "master"
[0m05:55:49.442358 [debug] [MainThread]: On master: BEGIN
[0m05:55:49.442517 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:55:49.451522 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:55:49.451730 [debug] [MainThread]: Using postgres connection "master"
[0m05:55:49.452011 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:55:49.477344 [debug] [MainThread]: SQL status: SELECT 74 in 0.0 seconds
[0m05:55:49.478866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf901d3a-b7fb-41f9-8c28-ef4d5d3c6ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a78650>]}
[0m05:55:49.479152 [debug] [MainThread]: On master: ROLLBACK
[0m05:55:49.479464 [debug] [MainThread]: Using postgres connection "master"
[0m05:55:49.479636 [debug] [MainThread]: On master: BEGIN
[0m05:55:49.479967 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:55:49.480160 [debug] [MainThread]: On master: COMMIT
[0m05:55:49.480329 [debug] [MainThread]: Using postgres connection "master"
[0m05:55:49.480489 [debug] [MainThread]: On master: COMMIT
[0m05:55:49.480732 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:55:49.480905 [debug] [MainThread]: On master: Close
[0m05:55:49.481175 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m05:55:49.481372 [info ] [MainThread]: 
[0m05:55:49.483382 [debug] [Thread-1 (]: Began running node model.crossborder.top_5_in_demand_genres
[0m05:55:49.483710 [info ] [Thread-1 (]: 1 of 1 START sql view model transformation.top_5_in_demand_genres .............. [RUN]
[0m05:55:49.483991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dvdrental_transformation, now model.crossborder.top_5_in_demand_genres)
[0m05:55:49.484205 [debug] [Thread-1 (]: Began compiling node model.crossborder.top_5_in_demand_genres
[0m05:55:49.488328 [debug] [Thread-1 (]: Writing injected SQL for node "model.crossborder.top_5_in_demand_genres"
[0m05:55:49.489016 [debug] [Thread-1 (]: Began executing node model.crossborder.top_5_in_demand_genres
[0m05:55:49.511035 [debug] [Thread-1 (]: Writing runtime sql for node "model.crossborder.top_5_in_demand_genres"
[0m05:55:49.511816 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_5_in_demand_genres"
[0m05:55:49.512066 [debug] [Thread-1 (]: On model.crossborder.top_5_in_demand_genres: BEGIN
[0m05:55:49.512279 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:55:49.532570 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:55:49.532956 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_5_in_demand_genres"
[0m05:55:49.533221 [debug] [Thread-1 (]: On model.crossborder.top_5_in_demand_genres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_5_in_demand_genres"} */

  create view "dvdrental"."transformation"."top_5_in_demand_genres__dbt_tmp"
    
    
  as (
    with genre_movie_demand as (
    select 
        category.name as genre,
        count(cstmr.customer_id) as total_rent_demand,
        sum(pymnt.amount) as total_sales
    from category
    join film_category
    using(category_id)
    join film
    using(film_id)
    join inventory
    using(film_id)
    join rental 
    on inventory.inventory_id = rental.inventory_id
    join customer 
    on rental.customer_id = customer.customer_id
    join payment
    on rental.rental_id = payment.rental_id
    group by category.category_id, category.name
    order by demand desc, total_sales desc
    limit 5
)

select *
from genre_movie_demand
  );
[0m05:55:49.535020 [debug] [Thread-1 (]: Postgres adapter: Postgres error: missing FROM-clause entry for table "cstmr"
LINE 10:         count(cstmr.customer_id) as total_rent_demand,
                       ^

[0m05:55:49.535250 [debug] [Thread-1 (]: On model.crossborder.top_5_in_demand_genres: ROLLBACK
[0m05:55:49.535622 [debug] [Thread-1 (]: On model.crossborder.top_5_in_demand_genres: Close
[0m05:55:49.541917 [debug] [Thread-1 (]: Database Error in model top_5_in_demand_genres (models/top_5_in_demand_genres.sql)
  missing FROM-clause entry for table "cstmr"
  LINE 10:         count(cstmr.customer_id) as total_rent_demand,
                         ^
  compiled Code at target/run/crossborder/models/top_5_in_demand_genres.sql
[0m05:55:49.543038 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bf901d3a-b7fb-41f9-8c28-ef4d5d3c6ff2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063ce650>]}
[0m05:55:49.543507 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model transformation.top_5_in_demand_genres ..... [[31mERROR[0m in 0.06s]
[0m05:55:49.543903 [debug] [Thread-1 (]: Finished running node model.crossborder.top_5_in_demand_genres
[0m05:55:49.545181 [debug] [MainThread]: Using postgres connection "master"
[0m05:55:49.545383 [debug] [MainThread]: On master: BEGIN
[0m05:55:49.545549 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:55:49.553999 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:55:49.554309 [debug] [MainThread]: On master: COMMIT
[0m05:55:49.554498 [debug] [MainThread]: Using postgres connection "master"
[0m05:55:49.554671 [debug] [MainThread]: On master: COMMIT
[0m05:55:49.554910 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:55:49.555094 [debug] [MainThread]: On master: Close
[0m05:55:49.555378 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:55:49.555544 [debug] [MainThread]: Connection 'model.crossborder.top_5_in_demand_genres' was properly closed.
[0m05:55:49.555748 [info ] [MainThread]: 
[0m05:55:49.555966 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m05:55:49.556370 [debug] [MainThread]: Command end result
[0m05:55:49.576358 [info ] [MainThread]: 
[0m05:55:49.576842 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:55:49.577049 [info ] [MainThread]: 
[0m05:55:49.577306 [error] [MainThread]:   Database Error in model top_5_in_demand_genres (models/top_5_in_demand_genres.sql)
  missing FROM-clause entry for table "cstmr"
  LINE 10:         count(cstmr.customer_id) as total_rent_demand,
                         ^
  compiled Code at target/run/crossborder/models/top_5_in_demand_genres.sql
[0m05:55:49.577504 [info ] [MainThread]: 
[0m05:55:49.577702 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m05:55:49.579891 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.7206294, "process_user_time": 1.25624, "process_kernel_time": 0.21117, "process_mem_max_rss": "122355712", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m05:55:49.580341 [debug] [MainThread]: Command `dbt run` failed at 05:55:49.580282 after 0.72 seconds
[0m05:55:49.580620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1014e6090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105142450>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10157ce90>]}
[0m05:55:49.580863 [debug] [MainThread]: Flushing usage events
[0m05:56:27.655215 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113cdfad0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d41e90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d425d0>]}


============================== 05:56:27.658820 | 5fc4e31d-2e63-49fd-8ce9-eca7d70e3327 ==============================
[0m05:56:27.658820 [info ] [MainThread]: Running with dbt=1.8.1
[0m05:56:27.659235 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/kelvin/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/kelvin/Documents/DBTProjects/CrossBorderRental/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s top_5_in_demand_genres', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m05:56:27.780165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fc4e31d-2e63-49fd-8ce9-eca7d70e3327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d424d0>]}
[0m05:56:27.809377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fc4e31d-2e63-49fd-8ce9-eca7d70e3327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b37390>]}
[0m05:56:27.810081 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m05:56:27.823786 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m05:56:27.886214 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:56:27.886734 [debug] [MainThread]: Partial parsing: updated file: crossborder://models/top_5_in_demand_genres.sql
[0m05:56:27.999582 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crossborder_sql.core
[0m05:56:28.002818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fc4e31d-2e63-49fd-8ce9-eca7d70e3327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114864310>]}
[0m05:56:28.052454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fc4e31d-2e63-49fd-8ce9-eca7d70e3327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114a3af10>]}
[0m05:56:28.052899 [info ] [MainThread]: Found 5 models, 413 macros
[0m05:56:28.053138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fc4e31d-2e63-49fd-8ce9-eca7d70e3327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113ded050>]}
[0m05:56:28.054205 [info ] [MainThread]: 
[0m05:56:28.054594 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:56:28.055182 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m05:56:28.105797 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m05:56:28.106254 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m05:56:28.106464 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:56:28.159190 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m05:56:28.160177 [debug] [ThreadPool]: On list_dvdrental: Close
[0m05:56:28.163012 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dvdrental, now list_dvdrental_transformation)
[0m05:56:28.166963 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_transformation"
[0m05:56:28.167201 [debug] [ThreadPool]: On list_dvdrental_transformation: BEGIN
[0m05:56:28.167383 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:56:28.178516 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:56:28.178709 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_transformation"
[0m05:56:28.178920 [debug] [ThreadPool]: On list_dvdrental_transformation: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "list_dvdrental_transformation"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'transformation'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'transformation'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'transformation'
  
[0m05:56:28.187955 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m05:56:28.188728 [debug] [ThreadPool]: On list_dvdrental_transformation: ROLLBACK
[0m05:56:28.189096 [debug] [ThreadPool]: On list_dvdrental_transformation: Close
[0m05:56:28.192367 [debug] [MainThread]: Using postgres connection "master"
[0m05:56:28.192556 [debug] [MainThread]: On master: BEGIN
[0m05:56:28.192711 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:56:28.203347 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:56:28.203531 [debug] [MainThread]: Using postgres connection "master"
[0m05:56:28.203798 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:56:28.231403 [debug] [MainThread]: SQL status: SELECT 74 in 0.0 seconds
[0m05:56:28.232817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fc4e31d-2e63-49fd-8ce9-eca7d70e3327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149ffed0>]}
[0m05:56:28.233089 [debug] [MainThread]: On master: ROLLBACK
[0m05:56:28.233451 [debug] [MainThread]: Using postgres connection "master"
[0m05:56:28.233617 [debug] [MainThread]: On master: BEGIN
[0m05:56:28.233998 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:56:28.234167 [debug] [MainThread]: On master: COMMIT
[0m05:56:28.234322 [debug] [MainThread]: Using postgres connection "master"
[0m05:56:28.234471 [debug] [MainThread]: On master: COMMIT
[0m05:56:28.234734 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:56:28.234901 [debug] [MainThread]: On master: Close
[0m05:56:28.235153 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m05:56:28.235349 [info ] [MainThread]: 
[0m05:56:28.237352 [debug] [Thread-1 (]: Began running node model.crossborder.top_5_in_demand_genres
[0m05:56:28.237684 [info ] [Thread-1 (]: 1 of 1 START sql view model transformation.top_5_in_demand_genres .............. [RUN]
[0m05:56:28.237973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dvdrental_transformation, now model.crossborder.top_5_in_demand_genres)
[0m05:56:28.238186 [debug] [Thread-1 (]: Began compiling node model.crossborder.top_5_in_demand_genres
[0m05:56:28.242402 [debug] [Thread-1 (]: Writing injected SQL for node "model.crossborder.top_5_in_demand_genres"
[0m05:56:28.243256 [debug] [Thread-1 (]: Began executing node model.crossborder.top_5_in_demand_genres
[0m05:56:28.265763 [debug] [Thread-1 (]: Writing runtime sql for node "model.crossborder.top_5_in_demand_genres"
[0m05:56:28.266518 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_5_in_demand_genres"
[0m05:56:28.266759 [debug] [Thread-1 (]: On model.crossborder.top_5_in_demand_genres: BEGIN
[0m05:56:28.266969 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:56:28.275143 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:56:28.275434 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_5_in_demand_genres"
[0m05:56:28.275688 [debug] [Thread-1 (]: On model.crossborder.top_5_in_demand_genres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_5_in_demand_genres"} */

  create view "dvdrental"."transformation"."top_5_in_demand_genres__dbt_tmp"
    
    
  as (
    with genre_movie_demand as (
    select 
        category.name as genre,
        count(customer.customer_id) as total_rent_demand,
        sum(payment.amount) as total_sales
    from category
    join film_category
    using(category_id)
    join film
    using(film_id)
    join inventory
    using(film_id)
    join rental 
    on inventory.inventory_id = rental.inventory_id
    join customer 
    on rental.customer_id = customer.customer_id
    join payment
    on rental.rental_id = payment.rental_id
    group by category.category_id, category.name
    order by demand desc, total_sales desc
    limit 5
)

select *
from genre_movie_demand
  );
[0m05:56:28.277296 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "demand" does not exist
LINE 26:     order by demand desc, total_sales desc
                      ^
HINT:  Perhaps you meant to reference the column "customer.email".

[0m05:56:28.277522 [debug] [Thread-1 (]: On model.crossborder.top_5_in_demand_genres: ROLLBACK
[0m05:56:28.277902 [debug] [Thread-1 (]: On model.crossborder.top_5_in_demand_genres: Close
[0m05:56:28.283954 [debug] [Thread-1 (]: Database Error in model top_5_in_demand_genres (models/top_5_in_demand_genres.sql)
  column "demand" does not exist
  LINE 26:     order by demand desc, total_sales desc
                        ^
  HINT:  Perhaps you meant to reference the column "customer.email".
  compiled Code at target/run/crossborder/models/top_5_in_demand_genres.sql
[0m05:56:28.284990 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fc4e31d-2e63-49fd-8ce9-eca7d70e3327', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112d8ef50>]}
[0m05:56:28.285443 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model transformation.top_5_in_demand_genres ..... [[31mERROR[0m in 0.05s]
[0m05:56:28.285817 [debug] [Thread-1 (]: Finished running node model.crossborder.top_5_in_demand_genres
[0m05:56:28.287042 [debug] [MainThread]: Using postgres connection "master"
[0m05:56:28.287237 [debug] [MainThread]: On master: BEGIN
[0m05:56:28.287400 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:56:28.296375 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:56:28.296585 [debug] [MainThread]: On master: COMMIT
[0m05:56:28.296751 [debug] [MainThread]: Using postgres connection "master"
[0m05:56:28.296907 [debug] [MainThread]: On master: COMMIT
[0m05:56:28.297144 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:56:28.297312 [debug] [MainThread]: On master: Close
[0m05:56:28.297539 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:56:28.297696 [debug] [MainThread]: Connection 'model.crossborder.top_5_in_demand_genres' was properly closed.
[0m05:56:28.297872 [info ] [MainThread]: 
[0m05:56:28.298063 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m05:56:28.298433 [debug] [MainThread]: Command end result
[0m05:56:28.317000 [info ] [MainThread]: 
[0m05:56:28.317489 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m05:56:28.317701 [info ] [MainThread]: 
[0m05:56:28.317956 [error] [MainThread]:   Database Error in model top_5_in_demand_genres (models/top_5_in_demand_genres.sql)
  column "demand" does not exist
  LINE 26:     order by demand desc, total_sales desc
                        ^
  HINT:  Perhaps you meant to reference the column "customer.email".
  compiled Code at target/run/crossborder/models/top_5_in_demand_genres.sql
[0m05:56:28.318156 [info ] [MainThread]: 
[0m05:56:28.318349 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m05:56:28.320160 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.70666456, "process_user_time": 1.204234, "process_kernel_time": 0.196812, "process_mem_max_rss": "124878848", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m05:56:28.320644 [debug] [MainThread]: Command `dbt run` failed at 05:56:28.320576 after 0.71 seconds
[0m05:56:28.320977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b4a090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d42910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113d40e10>]}
[0m05:56:28.321284 [debug] [MainThread]: Flushing usage events
[0m05:56:57.125677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a19950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a81c50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a82390>]}


============================== 05:56:57.129463 | 64285eed-d678-4ef8-892d-9597f6eced23 ==============================
[0m05:56:57.129463 [info ] [MainThread]: Running with dbt=1.8.1
[0m05:56:57.129899 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/kelvin/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/kelvin/Documents/DBTProjects/CrossBorderRental/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run -s top_5_in_demand_genres', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m05:56:57.236701 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64285eed-d678-4ef8-892d-9597f6eced23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a96bd0>]}
[0m05:56:57.265637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64285eed-d678-4ef8-892d-9597f6eced23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11062ae50>]}
[0m05:56:57.266261 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m05:56:57.279474 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m05:56:57.338712 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m05:56:57.339173 [debug] [MainThread]: Partial parsing: updated file: crossborder://models/top_5_in_demand_genres.sql
[0m05:56:57.449257 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crossborder_sql.core
[0m05:56:57.452480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64285eed-d678-4ef8-892d-9597f6eced23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1136183d0>]}
[0m05:56:57.502471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64285eed-d678-4ef8-892d-9597f6eced23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b5fa50>]}
[0m05:56:57.502885 [info ] [MainThread]: Found 5 models, 413 macros
[0m05:56:57.503112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64285eed-d678-4ef8-892d-9597f6eced23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b47450>]}
[0m05:56:57.504112 [info ] [MainThread]: 
[0m05:56:57.504498 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m05:56:57.505055 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m05:56:57.539198 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m05:56:57.539568 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m05:56:57.539790 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m05:56:57.586891 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m05:56:57.587871 [debug] [ThreadPool]: On list_dvdrental: Close
[0m05:56:57.590602 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dvdrental, now list_dvdrental_transformation)
[0m05:56:57.594430 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_transformation"
[0m05:56:57.594632 [debug] [ThreadPool]: On list_dvdrental_transformation: BEGIN
[0m05:56:57.594796 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m05:56:57.606749 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m05:56:57.606939 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_transformation"
[0m05:56:57.607137 [debug] [ThreadPool]: On list_dvdrental_transformation: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "list_dvdrental_transformation"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'transformation'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'transformation'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'transformation'
  
[0m05:56:57.613442 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m05:56:57.614266 [debug] [ThreadPool]: On list_dvdrental_transformation: ROLLBACK
[0m05:56:57.614637 [debug] [ThreadPool]: On list_dvdrental_transformation: Close
[0m05:56:57.617847 [debug] [MainThread]: Using postgres connection "master"
[0m05:56:57.618027 [debug] [MainThread]: On master: BEGIN
[0m05:56:57.618185 [debug] [MainThread]: Opening a new connection, currently in state init
[0m05:56:57.628473 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:56:57.628725 [debug] [MainThread]: Using postgres connection "master"
[0m05:56:57.629036 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m05:56:57.650649 [debug] [MainThread]: SQL status: SELECT 74 in 0.0 seconds
[0m05:56:57.652131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64285eed-d678-4ef8-892d-9597f6eced23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113a201d0>]}
[0m05:56:57.652420 [debug] [MainThread]: On master: ROLLBACK
[0m05:56:57.652804 [debug] [MainThread]: Using postgres connection "master"
[0m05:56:57.652978 [debug] [MainThread]: On master: BEGIN
[0m05:56:57.653401 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:56:57.653577 [debug] [MainThread]: On master: COMMIT
[0m05:56:57.653734 [debug] [MainThread]: Using postgres connection "master"
[0m05:56:57.653890 [debug] [MainThread]: On master: COMMIT
[0m05:56:57.654127 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:56:57.654301 [debug] [MainThread]: On master: Close
[0m05:56:57.654569 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m05:56:57.654769 [info ] [MainThread]: 
[0m05:56:57.656620 [debug] [Thread-1 (]: Began running node model.crossborder.top_5_in_demand_genres
[0m05:56:57.656932 [info ] [Thread-1 (]: 1 of 1 START sql view model transformation.top_5_in_demand_genres .............. [RUN]
[0m05:56:57.657211 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dvdrental_transformation, now model.crossborder.top_5_in_demand_genres)
[0m05:56:57.657419 [debug] [Thread-1 (]: Began compiling node model.crossborder.top_5_in_demand_genres
[0m05:56:57.661727 [debug] [Thread-1 (]: Writing injected SQL for node "model.crossborder.top_5_in_demand_genres"
[0m05:56:57.662529 [debug] [Thread-1 (]: Began executing node model.crossborder.top_5_in_demand_genres
[0m05:56:57.684835 [debug] [Thread-1 (]: Writing runtime sql for node "model.crossborder.top_5_in_demand_genres"
[0m05:56:57.685809 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_5_in_demand_genres"
[0m05:56:57.686047 [debug] [Thread-1 (]: On model.crossborder.top_5_in_demand_genres: BEGIN
[0m05:56:57.686257 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m05:56:57.706931 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m05:56:57.707281 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_5_in_demand_genres"
[0m05:56:57.707534 [debug] [Thread-1 (]: On model.crossborder.top_5_in_demand_genres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_5_in_demand_genres"} */

  create view "dvdrental"."transformation"."top_5_in_demand_genres__dbt_tmp"
    
    
  as (
    with genre_movie_demand as (
    select 
        category.name as genre,
        count(customer.customer_id) as total_rent_demand,
        sum(payment.amount) as total_sales
    from category
    join film_category
    using(category_id)
    join film
    using(film_id)
    join inventory
    using(film_id)
    join rental 
    on inventory.inventory_id = rental.inventory_id
    join customer 
    on rental.customer_id = customer.customer_id
    join payment
    on rental.rental_id = payment.rental_id
    group by category.category_id, category.name
    order by total_rent_demand desc, total_sales desc
    limit 5
)

select *
from genre_movie_demand
  );
[0m05:56:57.716584 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m05:56:57.721685 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_5_in_demand_genres"
[0m05:56:57.722030 [debug] [Thread-1 (]: On model.crossborder.top_5_in_demand_genres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_5_in_demand_genres"} */
alter table "dvdrental"."transformation"."top_5_in_demand_genres" rename to "top_5_in_demand_genres__dbt_backup"
[0m05:56:57.722873 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:56:57.724669 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_5_in_demand_genres"
[0m05:56:57.724889 [debug] [Thread-1 (]: On model.crossborder.top_5_in_demand_genres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_5_in_demand_genres"} */
alter table "dvdrental"."transformation"."top_5_in_demand_genres__dbt_tmp" rename to "top_5_in_demand_genres"
[0m05:56:57.725703 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m05:56:57.736481 [debug] [Thread-1 (]: On model.crossborder.top_5_in_demand_genres: COMMIT
[0m05:56:57.736929 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_5_in_demand_genres"
[0m05:56:57.737170 [debug] [Thread-1 (]: On model.crossborder.top_5_in_demand_genres: COMMIT
[0m05:56:57.738218 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m05:56:57.743563 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."transformation"."top_5_in_demand_genres__dbt_backup"
[0m05:56:57.746649 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_5_in_demand_genres"
[0m05:56:57.746929 [debug] [Thread-1 (]: On model.crossborder.top_5_in_demand_genres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_5_in_demand_genres"} */
drop view if exists "dvdrental"."transformation"."top_5_in_demand_genres__dbt_backup" cascade
[0m05:56:57.750636 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m05:56:57.752236 [debug] [Thread-1 (]: On model.crossborder.top_5_in_demand_genres: Close
[0m05:56:57.753172 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '64285eed-d678-4ef8-892d-9597f6eced23', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113f94b10>]}
[0m05:56:57.753609 [info ] [Thread-1 (]: 1 of 1 OK created sql view model transformation.top_5_in_demand_genres ......... [[32mCREATE VIEW[0m in 0.10s]
[0m05:56:57.753976 [debug] [Thread-1 (]: Finished running node model.crossborder.top_5_in_demand_genres
[0m05:56:57.754825 [debug] [MainThread]: Using postgres connection "master"
[0m05:56:57.755021 [debug] [MainThread]: On master: BEGIN
[0m05:56:57.755184 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m05:56:57.766508 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m05:56:57.766770 [debug] [MainThread]: On master: COMMIT
[0m05:56:57.766952 [debug] [MainThread]: Using postgres connection "master"
[0m05:56:57.767116 [debug] [MainThread]: On master: COMMIT
[0m05:56:57.767434 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m05:56:57.767609 [debug] [MainThread]: On master: Close
[0m05:56:57.767872 [debug] [MainThread]: Connection 'master' was properly closed.
[0m05:56:57.768038 [debug] [MainThread]: Connection 'model.crossborder.top_5_in_demand_genres' was properly closed.
[0m05:56:57.768225 [info ] [MainThread]: 
[0m05:56:57.768423 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m05:56:57.768799 [debug] [MainThread]: Command end result
[0m05:56:57.786553 [info ] [MainThread]: 
[0m05:56:57.786962 [info ] [MainThread]: [32mCompleted successfully[0m
[0m05:56:57.787159 [info ] [MainThread]: 
[0m05:56:57.787370 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m05:56:57.788960 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.70531464, "process_user_time": 1.257604, "process_kernel_time": 0.183028, "process_mem_max_rss": "124256256", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m05:56:57.789521 [debug] [MainThread]: Command `dbt run` succeeded at 05:56:57.789456 after 0.71 seconds
[0m05:56:57.789798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10566a090>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112a0bf50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1126ac550>]}
[0m05:56:57.790047 [debug] [MainThread]: Flushing usage events
[0m06:14:47.556968 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114410e10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11447df10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11447e650>]}


============================== 06:14:47.560585 | 5fb5f40a-c678-42d3-b594-6d647a5e1193 ==============================
[0m06:14:47.560585 [info ] [MainThread]: Running with dbt=1.8.1
[0m06:14:47.561048 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/kelvin/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/kelvin/Documents/DBTProjects/CrossBorderRental/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run -s top_5_volume_of_sales_by_country', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m06:14:47.682644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5fb5f40a-c678-42d3-b594-6d647a5e1193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e4f850>]}
[0m06:14:47.712371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5fb5f40a-c678-42d3-b594-6d647a5e1193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107e8b0d0>]}
[0m06:14:47.713232 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m06:14:47.726403 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m06:14:47.793600 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m06:14:47.794045 [debug] [MainThread]: Partial parsing: added file: crossborder://models/top_5_volume_of_sales_by_country.sql
[0m06:14:47.794253 [debug] [MainThread]: Partial parsing: deleted file: crossborder://models/top_five_volume_sales_by_country.sql
[0m06:14:47.908070 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crossborder_sql.core
[0m06:14:47.911295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5fb5f40a-c678-42d3-b594-6d647a5e1193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115220210>]}
[0m06:14:47.961040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5fb5f40a-c678-42d3-b594-6d647a5e1193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11535f590>]}
[0m06:14:47.961464 [info ] [MainThread]: Found 5 models, 413 macros
[0m06:14:47.961693 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fb5f40a-c678-42d3-b594-6d647a5e1193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11494aad0>]}
[0m06:14:47.962700 [info ] [MainThread]: 
[0m06:14:47.963090 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:14:47.963649 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m06:14:48.001347 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m06:14:48.001678 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m06:14:48.001875 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:14:48.133343 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m06:14:48.134497 [debug] [ThreadPool]: On list_dvdrental: Close
[0m06:14:48.137513 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dvdrental, now list_dvdrental_transformation)
[0m06:14:48.141699 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_transformation"
[0m06:14:48.141911 [debug] [ThreadPool]: On list_dvdrental_transformation: BEGIN
[0m06:14:48.142081 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:14:48.150120 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m06:14:48.150333 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_transformation"
[0m06:14:48.150544 [debug] [ThreadPool]: On list_dvdrental_transformation: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "list_dvdrental_transformation"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'transformation'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'transformation'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'transformation'
  
[0m06:14:48.155123 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m06:14:48.155968 [debug] [ThreadPool]: On list_dvdrental_transformation: ROLLBACK
[0m06:14:48.156313 [debug] [ThreadPool]: On list_dvdrental_transformation: Close
[0m06:14:48.159764 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:48.159983 [debug] [MainThread]: On master: BEGIN
[0m06:14:48.160149 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:14:48.170884 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:14:48.171064 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:48.171331 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:14:48.202815 [debug] [MainThread]: SQL status: SELECT 74 in 0.0 seconds
[0m06:14:48.204283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5fb5f40a-c678-42d3-b594-6d647a5e1193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1155e9610>]}
[0m06:14:48.204574 [debug] [MainThread]: On master: ROLLBACK
[0m06:14:48.205095 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:48.205258 [debug] [MainThread]: On master: BEGIN
[0m06:14:48.206036 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:14:48.206210 [debug] [MainThread]: On master: COMMIT
[0m06:14:48.206365 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:48.206516 [debug] [MainThread]: On master: COMMIT
[0m06:14:48.207207 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m06:14:48.207377 [debug] [MainThread]: On master: Close
[0m06:14:48.207647 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m06:14:48.207850 [info ] [MainThread]: 
[0m06:14:48.210200 [debug] [Thread-1 (]: Began running node model.crossborder.top_5_volume_of_sales_by_country
[0m06:14:48.210547 [info ] [Thread-1 (]: 1 of 1 START sql view model transformation.top_5_volume_of_sales_by_country .... [RUN]
[0m06:14:48.210853 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dvdrental_transformation, now model.crossborder.top_5_volume_of_sales_by_country)
[0m06:14:48.211075 [debug] [Thread-1 (]: Began compiling node model.crossborder.top_5_volume_of_sales_by_country
[0m06:14:48.215887 [debug] [Thread-1 (]: Writing injected SQL for node "model.crossborder.top_5_volume_of_sales_by_country"
[0m06:14:48.216550 [debug] [Thread-1 (]: Began executing node model.crossborder.top_5_volume_of_sales_by_country
[0m06:14:48.243215 [debug] [Thread-1 (]: Writing runtime sql for node "model.crossborder.top_5_volume_of_sales_by_country"
[0m06:14:48.244569 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_5_volume_of_sales_by_country"
[0m06:14:48.244943 [debug] [Thread-1 (]: On model.crossborder.top_5_volume_of_sales_by_country: BEGIN
[0m06:14:48.245442 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:14:48.254361 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m06:14:48.254752 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_5_volume_of_sales_by_country"
[0m06:14:48.255029 [debug] [Thread-1 (]: On model.crossborder.top_5_volume_of_sales_by_country: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_5_volume_of_sales_by_country"} */

  create view "dvdrental"."transformation"."top_5_volume_of_sales_by_country__dbt_tmp"
    
    
  as (
    with sales_by_country as (
    select country.country, 
    sum(payment.amount) as total_sales,
    count(customer.customer_id) as total_customers
from country
join city 
on country.country_id = city.country_id
join address
on city.city_id = address.city_id
join customer
on address.address_id = customer.address_id
join payment
on customer.customer_id = payment.customer_id
group by country_id.country
order by volume_of_sales desc, total_customers desc
limit 5
)

select *
from sales_by_country
  );
[0m06:14:48.256413 [debug] [Thread-1 (]: Postgres adapter: Postgres error: column "volume_of_sales" does not exist
LINE 21: order by volume_of_sales desc, total_customers desc
                  ^

[0m06:14:48.256665 [debug] [Thread-1 (]: On model.crossborder.top_5_volume_of_sales_by_country: ROLLBACK
[0m06:14:48.257106 [debug] [Thread-1 (]: On model.crossborder.top_5_volume_of_sales_by_country: Close
[0m06:14:48.263929 [debug] [Thread-1 (]: Database Error in model top_5_volume_of_sales_by_country (models/top_5_volume_of_sales_by_country.sql)
  column "volume_of_sales" does not exist
  LINE 21: order by volume_of_sales desc, total_customers desc
                    ^
  compiled Code at target/run/crossborder/models/top_5_volume_of_sales_by_country.sql
[0m06:14:48.266600 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '5fb5f40a-c678-42d3-b594-6d647a5e1193', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1156d7990>]}
[0m06:14:48.267124 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model transformation.top_5_volume_of_sales_by_country  [[31mERROR[0m in 0.05s]
[0m06:14:48.267535 [debug] [Thread-1 (]: Finished running node model.crossborder.top_5_volume_of_sales_by_country
[0m06:14:48.268833 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:48.269058 [debug] [MainThread]: On master: BEGIN
[0m06:14:48.269233 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:14:48.294054 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:14:48.294468 [debug] [MainThread]: On master: COMMIT
[0m06:14:48.294726 [debug] [MainThread]: Using postgres connection "master"
[0m06:14:48.294912 [debug] [MainThread]: On master: COMMIT
[0m06:14:48.295379 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m06:14:48.295660 [debug] [MainThread]: On master: Close
[0m06:14:48.296155 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:14:48.296331 [debug] [MainThread]: Connection 'model.crossborder.top_5_volume_of_sales_by_country' was properly closed.
[0m06:14:48.296544 [info ] [MainThread]: 
[0m06:14:48.296774 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.33 seconds (0.33s).
[0m06:14:48.297209 [debug] [MainThread]: Command end result
[0m06:14:48.325905 [info ] [MainThread]: 
[0m06:14:48.326383 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:14:48.326588 [info ] [MainThread]: 
[0m06:14:48.326860 [error] [MainThread]:   Database Error in model top_5_volume_of_sales_by_country (models/top_5_volume_of_sales_by_country.sql)
  column "volume_of_sales" does not exist
  LINE 21: order by volume_of_sales desc, total_customers desc
                    ^
  compiled Code at target/run/crossborder/models/top_5_volume_of_sales_by_country.sql
[0m06:14:48.327065 [info ] [MainThread]: 
[0m06:14:48.327333 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m06:14:48.329633 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.81409967, "process_user_time": 1.219783, "process_kernel_time": 0.199871, "process_mem_max_rss": "123977728", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:14:48.330104 [debug] [MainThread]: Command `dbt run` failed at 06:14:48.330043 after 0.81 seconds
[0m06:14:48.330398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11445a910>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056ee110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115660e90>]}
[0m06:14:48.330650 [debug] [MainThread]: Flushing usage events
[0m06:15:20.319438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060d6710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10611fc10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106132a90>]}


============================== 06:15:20.322891 | 554c8d7b-ae1e-4439-aa69-9223ec8eee96 ==============================
[0m06:15:20.322891 [info ] [MainThread]: Running with dbt=1.8.1
[0m06:15:20.323361 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/kelvin/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/kelvin/Documents/DBTProjects/CrossBorderRental/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run -s top_5_volume_of_sales_by_country', 'send_anonymous_usage_stats': 'True'}
[0m06:15:20.433175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '554c8d7b-ae1e-4439-aa69-9223ec8eee96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106485150>]}
[0m06:15:20.462557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '554c8d7b-ae1e-4439-aa69-9223ec8eee96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103c3a890>]}
[0m06:15:20.463227 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m06:15:20.476941 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m06:15:20.542903 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:15:20.543431 [debug] [MainThread]: Partial parsing: updated file: crossborder://models/top_5_volume_of_sales_by_country.sql
[0m06:15:20.661981 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crossborder_sql.core
[0m06:15:20.665528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '554c8d7b-ae1e-4439-aa69-9223ec8eee96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d20250>]}
[0m06:15:20.715122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '554c8d7b-ae1e-4439-aa69-9223ec8eee96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f554d0>]}
[0m06:15:20.715553 [info ] [MainThread]: Found 5 models, 413 macros
[0m06:15:20.715780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '554c8d7b-ae1e-4439-aa69-9223ec8eee96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c28590>]}
[0m06:15:20.716739 [info ] [MainThread]: 
[0m06:15:20.717118 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:15:20.717681 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m06:15:20.754090 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m06:15:20.754463 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m06:15:20.754682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:15:20.812039 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m06:15:20.813093 [debug] [ThreadPool]: On list_dvdrental: Close
[0m06:15:20.815845 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dvdrental, now list_dvdrental_transformation)
[0m06:15:20.819685 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_transformation"
[0m06:15:20.819889 [debug] [ThreadPool]: On list_dvdrental_transformation: BEGIN
[0m06:15:20.820053 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:15:20.828988 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m06:15:20.829173 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_transformation"
[0m06:15:20.829377 [debug] [ThreadPool]: On list_dvdrental_transformation: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "list_dvdrental_transformation"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'transformation'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'transformation'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'transformation'
  
[0m06:15:20.835736 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m06:15:20.836529 [debug] [ThreadPool]: On list_dvdrental_transformation: ROLLBACK
[0m06:15:20.836809 [debug] [ThreadPool]: On list_dvdrental_transformation: Close
[0m06:15:20.840000 [debug] [MainThread]: Using postgres connection "master"
[0m06:15:20.840243 [debug] [MainThread]: On master: BEGIN
[0m06:15:20.840423 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:15:20.851312 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:15:20.851508 [debug] [MainThread]: Using postgres connection "master"
[0m06:15:20.851782 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:15:20.878013 [debug] [MainThread]: SQL status: SELECT 74 in 0.0 seconds
[0m06:15:20.879522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '554c8d7b-ae1e-4439-aa69-9223ec8eee96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f4fd90>]}
[0m06:15:20.879795 [debug] [MainThread]: On master: ROLLBACK
[0m06:15:20.880208 [debug] [MainThread]: Using postgres connection "master"
[0m06:15:20.880375 [debug] [MainThread]: On master: BEGIN
[0m06:15:20.880915 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:15:20.881085 [debug] [MainThread]: On master: COMMIT
[0m06:15:20.881247 [debug] [MainThread]: Using postgres connection "master"
[0m06:15:20.881402 [debug] [MainThread]: On master: COMMIT
[0m06:15:20.881786 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m06:15:20.881956 [debug] [MainThread]: On master: Close
[0m06:15:20.882238 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m06:15:20.882433 [info ] [MainThread]: 
[0m06:15:20.884310 [debug] [Thread-1 (]: Began running node model.crossborder.top_5_volume_of_sales_by_country
[0m06:15:20.884634 [info ] [Thread-1 (]: 1 of 1 START sql view model transformation.top_5_volume_of_sales_by_country .... [RUN]
[0m06:15:20.884910 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dvdrental_transformation, now model.crossborder.top_5_volume_of_sales_by_country)
[0m06:15:20.885137 [debug] [Thread-1 (]: Began compiling node model.crossborder.top_5_volume_of_sales_by_country
[0m06:15:20.889317 [debug] [Thread-1 (]: Writing injected SQL for node "model.crossborder.top_5_volume_of_sales_by_country"
[0m06:15:20.890102 [debug] [Thread-1 (]: Began executing node model.crossborder.top_5_volume_of_sales_by_country
[0m06:15:20.911283 [debug] [Thread-1 (]: Writing runtime sql for node "model.crossborder.top_5_volume_of_sales_by_country"
[0m06:15:20.911960 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_5_volume_of_sales_by_country"
[0m06:15:20.912192 [debug] [Thread-1 (]: On model.crossborder.top_5_volume_of_sales_by_country: BEGIN
[0m06:15:20.912395 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:15:20.922640 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m06:15:20.923007 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_5_volume_of_sales_by_country"
[0m06:15:20.923284 [debug] [Thread-1 (]: On model.crossborder.top_5_volume_of_sales_by_country: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_5_volume_of_sales_by_country"} */

  create view "dvdrental"."transformation"."top_5_volume_of_sales_by_country__dbt_tmp"
    
    
  as (
    with sales_by_country as (
    select country.country, 
    sum(payment.amount) as total_sales,
    count(customer.customer_id) as total_customers
from country
join city 
on country.country_id = city.country_id
join address
on city.city_id = address.city_id
join customer
on address.address_id = customer.address_id
join payment
on customer.customer_id = payment.customer_id
group by country_id.country
order by total_sales desc, total_customers desc
limit 5
)

select *
from sales_by_country
  );
[0m06:15:20.925680 [debug] [Thread-1 (]: Postgres adapter: Postgres error: missing FROM-clause entry for table "country_id"
LINE 20: group by country_id.country
                  ^

[0m06:15:20.925952 [debug] [Thread-1 (]: On model.crossborder.top_5_volume_of_sales_by_country: ROLLBACK
[0m06:15:20.926370 [debug] [Thread-1 (]: On model.crossborder.top_5_volume_of_sales_by_country: Close
[0m06:15:20.932682 [debug] [Thread-1 (]: Database Error in model top_5_volume_of_sales_by_country (models/top_5_volume_of_sales_by_country.sql)
  missing FROM-clause entry for table "country_id"
  LINE 20: group by country_id.country
                    ^
  compiled Code at target/run/crossborder/models/top_5_volume_of_sales_by_country.sql
[0m06:15:20.933769 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '554c8d7b-ae1e-4439-aa69-9223ec8eee96', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f0c350>]}
[0m06:15:20.934233 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model transformation.top_5_volume_of_sales_by_country  [[31mERROR[0m in 0.05s]
[0m06:15:20.934626 [debug] [Thread-1 (]: Finished running node model.crossborder.top_5_volume_of_sales_by_country
[0m06:15:20.935858 [debug] [MainThread]: Using postgres connection "master"
[0m06:15:20.936049 [debug] [MainThread]: On master: BEGIN
[0m06:15:20.936212 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:15:20.945235 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:15:20.945481 [debug] [MainThread]: On master: COMMIT
[0m06:15:20.945657 [debug] [MainThread]: Using postgres connection "master"
[0m06:15:20.945818 [debug] [MainThread]: On master: COMMIT
[0m06:15:20.946081 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m06:15:20.946255 [debug] [MainThread]: On master: Close
[0m06:15:20.946508 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:15:20.946670 [debug] [MainThread]: Connection 'model.crossborder.top_5_volume_of_sales_by_country' was properly closed.
[0m06:15:20.946861 [info ] [MainThread]: 
[0m06:15:20.947068 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.23 seconds (0.23s).
[0m06:15:20.947455 [debug] [MainThread]: Command end result
[0m06:15:20.966208 [info ] [MainThread]: 
[0m06:15:20.966589 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m06:15:20.966788 [info ] [MainThread]: 
[0m06:15:20.967026 [error] [MainThread]:   Database Error in model top_5_volume_of_sales_by_country (models/top_5_volume_of_sales_by_country.sql)
  missing FROM-clause entry for table "country_id"
  LINE 20: group by country_id.country
                    ^
  compiled Code at target/run/crossborder/models/top_5_volume_of_sales_by_country.sql
[0m06:15:20.967218 [info ] [MainThread]: 
[0m06:15:20.967403 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m06:15:20.968811 [debug] [MainThread]: Resource report: {"command_name": "run", "command_wall_clock_time": 0.6899791, "process_user_time": 1.230207, "process_kernel_time": 0.195071, "process_mem_max_rss": "124239872", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:15:20.969164 [debug] [MainThread]: Command `dbt run` failed at 06:15:20.969112 after 0.69 seconds
[0m06:15:20.969417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x100cfa110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106132950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a4f990>]}
[0m06:15:20.969636 [debug] [MainThread]: Flushing usage events
[0m06:17:40.009149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bdc650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bdccd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d42690>]}


============================== 06:17:40.012942 | a309ced0-94cc-4d73-92e1-ecc0ca1f0406 ==============================
[0m06:17:40.012942 [info ] [MainThread]: Running with dbt=1.8.1
[0m06:17:40.013376 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/Users/kelvin/Documents/DBTProjects/CrossBorderRental/logs', 'profiles_dir': '/Users/kelvin/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run -s top_5_volume_of_sales_by_country', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m06:17:40.175173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a309ced0-94cc-4d73-92e1-ecc0ca1f0406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107033f50>]}
[0m06:17:40.206982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a309ced0-94cc-4d73-92e1-ecc0ca1f0406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10458b6d0>]}
[0m06:17:40.207825 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m06:17:40.222869 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m06:17:40.293650 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m06:17:40.294319 [debug] [MainThread]: Partial parsing: updated file: crossborder://models/top_5_volume_of_sales_by_country.sql
[0m06:17:40.411032 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crossborder_sql.core
[0m06:17:40.414496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a309ced0-94cc-4d73-92e1-ecc0ca1f0406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107528390>]}
[0m06:17:40.465198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a309ced0-94cc-4d73-92e1-ecc0ca1f0406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a5f810>]}
[0m06:17:40.465617 [info ] [MainThread]: Found 5 models, 413 macros
[0m06:17:40.465843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a309ced0-94cc-4d73-92e1-ecc0ca1f0406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107734310>]}
[0m06:17:40.466813 [info ] [MainThread]: 
[0m06:17:40.467190 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:17:40.467743 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m06:17:40.505208 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m06:17:40.505545 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m06:17:40.505747 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:17:40.555674 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m06:17:40.556681 [debug] [ThreadPool]: On list_dvdrental: Close
[0m06:17:40.559591 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dvdrental, now list_dvdrental_transformation)
[0m06:17:40.563528 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_transformation"
[0m06:17:40.563735 [debug] [ThreadPool]: On list_dvdrental_transformation: BEGIN
[0m06:17:40.563902 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:17:40.573697 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m06:17:40.573997 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_transformation"
[0m06:17:40.574220 [debug] [ThreadPool]: On list_dvdrental_transformation: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "list_dvdrental_transformation"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'transformation'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'transformation'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'transformation'
  
[0m06:17:40.583080 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m06:17:40.584182 [debug] [ThreadPool]: On list_dvdrental_transformation: ROLLBACK
[0m06:17:40.584656 [debug] [ThreadPool]: On list_dvdrental_transformation: Close
[0m06:17:40.588285 [debug] [MainThread]: Using postgres connection "master"
[0m06:17:40.588484 [debug] [MainThread]: On master: BEGIN
[0m06:17:40.588646 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:17:40.597980 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:17:40.598161 [debug] [MainThread]: Using postgres connection "master"
[0m06:17:40.598427 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:17:40.625272 [debug] [MainThread]: SQL status: SELECT 74 in 0.0 seconds
[0m06:17:40.626759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a309ced0-94cc-4d73-92e1-ecc0ca1f0406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10764c510>]}
[0m06:17:40.627036 [debug] [MainThread]: On master: ROLLBACK
[0m06:17:40.627414 [debug] [MainThread]: Using postgres connection "master"
[0m06:17:40.627578 [debug] [MainThread]: On master: BEGIN
[0m06:17:40.628067 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:17:40.628241 [debug] [MainThread]: On master: COMMIT
[0m06:17:40.628396 [debug] [MainThread]: Using postgres connection "master"
[0m06:17:40.628547 [debug] [MainThread]: On master: COMMIT
[0m06:17:40.628803 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m06:17:40.628973 [debug] [MainThread]: On master: Close
[0m06:17:40.629230 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m06:17:40.629423 [info ] [MainThread]: 
[0m06:17:40.631470 [debug] [Thread-1 (]: Began running node model.crossborder.top_5_volume_of_sales_by_country
[0m06:17:40.631795 [info ] [Thread-1 (]: 1 of 1 START sql view model transformation.top_5_volume_of_sales_by_country .... [RUN]
[0m06:17:40.632087 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dvdrental_transformation, now model.crossborder.top_5_volume_of_sales_by_country)
[0m06:17:40.632300 [debug] [Thread-1 (]: Began compiling node model.crossborder.top_5_volume_of_sales_by_country
[0m06:17:40.636442 [debug] [Thread-1 (]: Writing injected SQL for node "model.crossborder.top_5_volume_of_sales_by_country"
[0m06:17:40.637374 [debug] [Thread-1 (]: Began executing node model.crossborder.top_5_volume_of_sales_by_country
[0m06:17:40.662081 [debug] [Thread-1 (]: Writing runtime sql for node "model.crossborder.top_5_volume_of_sales_by_country"
[0m06:17:40.662813 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_5_volume_of_sales_by_country"
[0m06:17:40.663049 [debug] [Thread-1 (]: On model.crossborder.top_5_volume_of_sales_by_country: BEGIN
[0m06:17:40.663254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:17:40.673113 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m06:17:40.673470 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_5_volume_of_sales_by_country"
[0m06:17:40.673749 [debug] [Thread-1 (]: On model.crossborder.top_5_volume_of_sales_by_country: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_5_volume_of_sales_by_country"} */

  create view "dvdrental"."transformation"."top_5_volume_of_sales_by_country__dbt_tmp"
    
    
  as (
    with sales_by_country as (
    select distinct (country.country) country, 
    sum(payment.amount) as total_sales,
    count(customer.customer_id) as total_customers
from country
join city 
on country.country_id = city.country_id
join address
on city.city_id = address.city_id
join customer
on address.address_id = customer.address_id
join payment
on customer.customer_id = payment.customer_id
group by country
order by total_sales desc, total_customers desc
limit 5
)

select *
from sales_by_country
  );
[0m06:17:40.683514 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m06:17:40.687993 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_5_volume_of_sales_by_country"
[0m06:17:40.688283 [debug] [Thread-1 (]: On model.crossborder.top_5_volume_of_sales_by_country: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_5_volume_of_sales_by_country"} */
alter table "dvdrental"."transformation"."top_5_volume_of_sales_by_country__dbt_tmp" rename to "top_5_volume_of_sales_by_country"
[0m06:17:40.689232 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m06:17:40.698456 [debug] [Thread-1 (]: On model.crossborder.top_5_volume_of_sales_by_country: COMMIT
[0m06:17:40.698777 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_5_volume_of_sales_by_country"
[0m06:17:40.699004 [debug] [Thread-1 (]: On model.crossborder.top_5_volume_of_sales_by_country: COMMIT
[0m06:17:40.700331 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m06:17:40.704340 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."transformation"."top_5_volume_of_sales_by_country__dbt_backup"
[0m06:17:40.708407 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.top_5_volume_of_sales_by_country"
[0m06:17:40.708653 [debug] [Thread-1 (]: On model.crossborder.top_5_volume_of_sales_by_country: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_5_volume_of_sales_by_country"} */
drop view if exists "dvdrental"."transformation"."top_5_volume_of_sales_by_country__dbt_backup" cascade
[0m06:17:40.709276 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m06:17:40.710831 [debug] [Thread-1 (]: On model.crossborder.top_5_volume_of_sales_by_country: Close
[0m06:17:40.711782 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'a309ced0-94cc-4d73-92e1-ecc0ca1f0406', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a2c950>]}
[0m06:17:40.712211 [info ] [Thread-1 (]: 1 of 1 OK created sql view model transformation.top_5_volume_of_sales_by_country  [[32mCREATE VIEW[0m in 0.08s]
[0m06:17:40.712572 [debug] [Thread-1 (]: Finished running node model.crossborder.top_5_volume_of_sales_by_country
[0m06:17:40.713382 [debug] [MainThread]: Using postgres connection "master"
[0m06:17:40.713570 [debug] [MainThread]: On master: BEGIN
[0m06:17:40.713734 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:17:40.723123 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:17:40.723353 [debug] [MainThread]: On master: COMMIT
[0m06:17:40.723518 [debug] [MainThread]: Using postgres connection "master"
[0m06:17:40.723676 [debug] [MainThread]: On master: COMMIT
[0m06:17:40.723915 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m06:17:40.724076 [debug] [MainThread]: On master: Close
[0m06:17:40.724314 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:17:40.724475 [debug] [MainThread]: Connection 'model.crossborder.top_5_volume_of_sales_by_country' was properly closed.
[0m06:17:40.724662 [info ] [MainThread]: 
[0m06:17:40.724861 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m06:17:40.725298 [debug] [MainThread]: Command end result
[0m06:17:40.743263 [info ] [MainThread]: 
[0m06:17:40.743725 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:17:40.743923 [info ] [MainThread]: 
[0m06:17:40.744118 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m06:17:40.745798 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7788391, "process_user_time": 1.317073, "process_kernel_time": 0.2221, "process_mem_max_rss": "122322944", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:17:40.746265 [debug] [MainThread]: Command `dbt run` succeeded at 06:17:40.746198 after 0.78 seconds
[0m06:17:40.746564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d25750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10282e110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1029715d0>]}
[0m06:17:40.746822 [debug] [MainThread]: Flushing usage events
[0m06:22:31.282273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060049d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062d9b90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062da290>]}


============================== 06:22:31.286179 | c8bf579f-30d3-4aa2-89c5-843c32b50ac9 ==============================
[0m06:22:31.286179 [info ] [MainThread]: Running with dbt=1.8.1
[0m06:22:31.286727 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/kelvin/Documents/DBTProjects/CrossBorderRental/logs', 'debug': 'False', 'profiles_dir': '/Users/kelvin/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m06:22:31.406254 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8bf579f-30d3-4aa2-89c5-843c32b50ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102e6a310>]}
[0m06:22:31.436357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8bf579f-30d3-4aa2-89c5-843c32b50ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045a6f10>]}
[0m06:22:31.437179 [info ] [MainThread]: Registered adapter: postgres=1.8.1
[0m06:22:31.451330 [debug] [MainThread]: checksum: ebc509fb14e151ea268e89b60fd5abf912ed99129f87516462718fa2f14f4838, vars: {}, profile: , target: , version: 1.8.1
[0m06:22:31.519469 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m06:22:31.519831 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m06:22:31.523237 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.crossborder_sql.core
[0m06:22:31.535930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8bf579f-30d3-4aa2-89c5-843c32b50ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d3cdd0>]}
[0m06:22:31.586764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8bf579f-30d3-4aa2-89c5-843c32b50ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d7b5d0>]}
[0m06:22:31.587171 [info ] [MainThread]: Found 5 models, 413 macros
[0m06:22:31.587403 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8bf579f-30d3-4aa2-89c5-843c32b50ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106cb42d0>]}
[0m06:22:31.588632 [info ] [MainThread]: 
[0m06:22:31.589024 [debug] [MainThread]: Acquiring new postgres connection 'master'
[0m06:22:31.591497 [debug] [ThreadPool]: Acquiring new postgres connection 'list_dvdrental'
[0m06:22:31.630291 [debug] [ThreadPool]: Using postgres connection "list_dvdrental"
[0m06:22:31.630604 [debug] [ThreadPool]: On list_dvdrental: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "list_dvdrental"} */

    select distinct nspname from pg_namespace
  
[0m06:22:31.630802 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m06:22:31.689085 [debug] [ThreadPool]: SQL status: SELECT 5 in 0.0 seconds
[0m06:22:31.690128 [debug] [ThreadPool]: On list_dvdrental: Close
[0m06:22:31.691109 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dvdrental, now list_dvdrental_transformation)
[0m06:22:31.695282 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_transformation"
[0m06:22:31.695539 [debug] [ThreadPool]: On list_dvdrental_transformation: BEGIN
[0m06:22:31.695725 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m06:22:31.706610 [debug] [ThreadPool]: SQL status: BEGIN in 0.0 seconds
[0m06:22:31.706805 [debug] [ThreadPool]: Using postgres connection "list_dvdrental_transformation"
[0m06:22:31.707021 [debug] [ThreadPool]: On list_dvdrental_transformation: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "list_dvdrental_transformation"} */
select
      'dvdrental' as database,
      tablename as name,
      schemaname as schema,
      'table' as type
    from pg_tables
    where schemaname ilike 'transformation'
    union all
    select
      'dvdrental' as database,
      viewname as name,
      schemaname as schema,
      'view' as type
    from pg_views
    where schemaname ilike 'transformation'
    union all
    select
      'dvdrental' as database,
      matviewname as name,
      schemaname as schema,
      'materialized_view' as type
    from pg_matviews
    where schemaname ilike 'transformation'
  
[0m06:22:31.714000 [debug] [ThreadPool]: SQL status: SELECT 6 in 0.0 seconds
[0m06:22:31.714793 [debug] [ThreadPool]: On list_dvdrental_transformation: ROLLBACK
[0m06:22:31.715135 [debug] [ThreadPool]: On list_dvdrental_transformation: Close
[0m06:22:31.718400 [debug] [MainThread]: Using postgres connection "master"
[0m06:22:31.718595 [debug] [MainThread]: On master: BEGIN
[0m06:22:31.718756 [debug] [MainThread]: Opening a new connection, currently in state init
[0m06:22:31.729219 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:22:31.729399 [debug] [MainThread]: Using postgres connection "master"
[0m06:22:31.729662 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "connection_name": "master"} */
with relation as (
        select
            pg_rewrite.ev_class as class,
            pg_rewrite.oid as id
        from pg_rewrite
    ),
    class as (
        select
            oid as id,
            relname as name,
            relnamespace as schema,
            relkind as kind
        from pg_class
    ),
    dependency as (
        select distinct
            pg_depend.objid as id,
            pg_depend.refobjid as ref
        from pg_depend
    ),
    schema as (
        select
            pg_namespace.oid as id,
            pg_namespace.nspname as name
        from pg_namespace
        where nspname != 'information_schema' and nspname not like 'pg\_%'
    ),
    referenced as (
        select
            relation.id AS id,
            referenced_class.name ,
            referenced_class.schema ,
            referenced_class.kind
        from relation
        join class as referenced_class on relation.class=referenced_class.id
        where referenced_class.kind in ('r', 'v', 'm')
    ),
    relationships as (
        select
            referenced.name as referenced_name,
            referenced.schema as referenced_schema_id,
            dependent_class.name as dependent_name,
            dependent_class.schema as dependent_schema_id,
            referenced.kind as kind
        from referenced
        join dependency on referenced.id=dependency.id
        join class as dependent_class on dependency.ref=dependent_class.id
        where
            (referenced.name != dependent_class.name or
             referenced.schema != dependent_class.schema)
    )

    select
        referenced_schema.name as referenced_schema,
        relationships.referenced_name as referenced_name,
        dependent_schema.name as dependent_schema,
        relationships.dependent_name as dependent_name
    from relationships
    join schema as dependent_schema on relationships.dependent_schema_id=dependent_schema.id
    join schema as referenced_schema on relationships.referenced_schema_id=referenced_schema.id
    group by referenced_schema, referenced_name, dependent_schema, dependent_name
    order by referenced_schema, referenced_name, dependent_schema, dependent_name;
[0m06:22:31.754695 [debug] [MainThread]: SQL status: SELECT 74 in 0.0 seconds
[0m06:22:31.756123 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8bf579f-30d3-4aa2-89c5-843c32b50ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045b8b10>]}
[0m06:22:31.756385 [debug] [MainThread]: On master: ROLLBACK
[0m06:22:31.756694 [debug] [MainThread]: Using postgres connection "master"
[0m06:22:31.756858 [debug] [MainThread]: On master: BEGIN
[0m06:22:31.757183 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:22:31.757348 [debug] [MainThread]: On master: COMMIT
[0m06:22:31.757501 [debug] [MainThread]: Using postgres connection "master"
[0m06:22:31.757651 [debug] [MainThread]: On master: COMMIT
[0m06:22:31.757948 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m06:22:31.758113 [debug] [MainThread]: On master: Close
[0m06:22:31.758372 [info ] [MainThread]: Concurrency: 5 threads (target='dev')
[0m06:22:31.758568 [info ] [MainThread]: 
[0m06:22:31.761141 [debug] [Thread-1 (]: Began running node model.crossborder.bottom_five_customer_base_by_country
[0m06:22:31.761402 [debug] [Thread-2 (]: Began running node model.crossborder.rental_perfomance
[0m06:22:31.761728 [info ] [Thread-1 (]: 1 of 5 START sql view model transformation.bottom_five_customer_base_by_country  [RUN]
[0m06:22:31.761999 [debug] [Thread-3 (]: Began running node model.crossborder.top_5_in_demand_genres
[0m06:22:31.762263 [info ] [Thread-2 (]: 2 of 5 START sql view model transformation.rental_perfomance ................... [RUN]
[0m06:22:31.762542 [debug] [Thread-4 (]: Began running node model.crossborder.top_5_volume_of_sales_by_country
[0m06:22:31.762837 [debug] [Thread-5 (]: Began running node model.crossborder.top_loyal_customers
[0m06:22:31.763102 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_dvdrental_transformation, now model.crossborder.bottom_five_customer_base_by_country)
[0m06:22:31.763386 [info ] [Thread-3 (]: 3 of 5 START sql view model transformation.top_5_in_demand_genres .............. [RUN]
[0m06:22:31.763719 [debug] [Thread-2 (]: Acquiring new postgres connection 'model.crossborder.rental_perfomance'
[0m06:22:31.764120 [info ] [Thread-4 (]: 4 of 5 START sql view model transformation.top_5_volume_of_sales_by_country .... [RUN]
[0m06:22:31.764598 [info ] [Thread-5 (]: 5 of 5 START sql view model transformation.top_loyal_customers ................. [RUN]
[0m06:22:31.764850 [debug] [Thread-1 (]: Began compiling node model.crossborder.bottom_five_customer_base_by_country
[0m06:22:31.765197 [debug] [Thread-3 (]: Acquiring new postgres connection 'model.crossborder.top_5_in_demand_genres'
[0m06:22:31.765435 [debug] [Thread-2 (]: Began compiling node model.crossborder.rental_perfomance
[0m06:22:31.765718 [debug] [Thread-4 (]: Acquiring new postgres connection 'model.crossborder.top_5_volume_of_sales_by_country'
[0m06:22:31.765979 [debug] [Thread-5 (]: Acquiring new postgres connection 'model.crossborder.top_loyal_customers'
[0m06:22:31.770810 [debug] [Thread-1 (]: Writing injected SQL for node "model.crossborder.bottom_five_customer_base_by_country"
[0m06:22:31.771592 [debug] [Thread-3 (]: Began compiling node model.crossborder.top_5_in_demand_genres
[0m06:22:31.772989 [debug] [Thread-2 (]: Writing injected SQL for node "model.crossborder.rental_perfomance"
[0m06:22:31.773252 [debug] [Thread-4 (]: Began compiling node model.crossborder.top_5_volume_of_sales_by_country
[0m06:22:31.773478 [debug] [Thread-5 (]: Began compiling node model.crossborder.top_loyal_customers
[0m06:22:31.774752 [debug] [Thread-3 (]: Writing injected SQL for node "model.crossborder.top_5_in_demand_genres"
[0m06:22:31.776099 [debug] [Thread-4 (]: Writing injected SQL for node "model.crossborder.top_5_volume_of_sales_by_country"
[0m06:22:31.776354 [debug] [Thread-1 (]: Began executing node model.crossborder.bottom_five_customer_base_by_country
[0m06:22:31.777473 [debug] [Thread-5 (]: Writing injected SQL for node "model.crossborder.top_loyal_customers"
[0m06:22:31.777773 [debug] [Thread-2 (]: Began executing node model.crossborder.rental_perfomance
[0m06:22:31.798014 [debug] [Thread-4 (]: Began executing node model.crossborder.top_5_volume_of_sales_by_country
[0m06:22:31.801927 [debug] [Thread-1 (]: Writing runtime sql for node "model.crossborder.bottom_five_customer_base_by_country"
[0m06:22:31.802169 [debug] [Thread-3 (]: Began executing node model.crossborder.top_5_in_demand_genres
[0m06:22:31.804707 [debug] [Thread-2 (]: Writing runtime sql for node "model.crossborder.rental_perfomance"
[0m06:22:31.806926 [debug] [Thread-4 (]: Writing runtime sql for node "model.crossborder.top_5_volume_of_sales_by_country"
[0m06:22:31.807162 [debug] [Thread-5 (]: Began executing node model.crossborder.top_loyal_customers
[0m06:22:31.810360 [debug] [Thread-3 (]: Writing runtime sql for node "model.crossborder.top_5_in_demand_genres"
[0m06:22:31.810796 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.bottom_five_customer_base_by_country"
[0m06:22:31.812860 [debug] [Thread-5 (]: Writing runtime sql for node "model.crossborder.top_loyal_customers"
[0m06:22:31.813267 [debug] [Thread-4 (]: Using postgres connection "model.crossborder.top_5_volume_of_sales_by_country"
[0m06:22:31.813470 [debug] [Thread-2 (]: Using postgres connection "model.crossborder.rental_perfomance"
[0m06:22:31.813688 [debug] [Thread-1 (]: On model.crossborder.bottom_five_customer_base_by_country: BEGIN
[0m06:22:31.814053 [debug] [Thread-3 (]: Using postgres connection "model.crossborder.top_5_in_demand_genres"
[0m06:22:31.814264 [debug] [Thread-4 (]: On model.crossborder.top_5_volume_of_sales_by_country: BEGIN
[0m06:22:31.814512 [debug] [Thread-2 (]: On model.crossborder.rental_perfomance: BEGIN
[0m06:22:31.814731 [debug] [Thread-5 (]: Using postgres connection "model.crossborder.top_loyal_customers"
[0m06:22:31.814953 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m06:22:31.815177 [debug] [Thread-3 (]: On model.crossborder.top_5_in_demand_genres: BEGIN
[0m06:22:31.815389 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m06:22:31.815596 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m06:22:31.815803 [debug] [Thread-5 (]: On model.crossborder.top_loyal_customers: BEGIN
[0m06:22:31.816091 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m06:22:31.816430 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m06:22:31.840490 [debug] [Thread-1 (]: SQL status: BEGIN in 0.0 seconds
[0m06:22:31.840795 [debug] [Thread-4 (]: SQL status: BEGIN in 0.0 seconds
[0m06:22:31.841050 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.bottom_five_customer_base_by_country"
[0m06:22:31.841293 [debug] [Thread-4 (]: Using postgres connection "model.crossborder.top_5_volume_of_sales_by_country"
[0m06:22:31.841539 [debug] [Thread-1 (]: On model.crossborder.bottom_five_customer_base_by_country: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.bottom_five_customer_base_by_country"} */

  create view "dvdrental"."transformation"."bottom_five_customer_base_by_country__dbt_tmp"
    
    
  as (
    with final as (select cntry.country, count(customer_id) as customers
from country cntry
inner join city on cntry.country_id = city.country_id
inner join address addr on city.city_id = addr.city_id
inner join customer cstmr on addr.address_id = cstmr.address_id
group by cntry.country
order by customers
limit 5)

select *
from final
  );
[0m06:22:31.841763 [debug] [Thread-3 (]: SQL status: BEGIN in 0.0 seconds
[0m06:22:31.842023 [debug] [Thread-4 (]: On model.crossborder.top_5_volume_of_sales_by_country: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_5_volume_of_sales_by_country"} */

  create view "dvdrental"."transformation"."top_5_volume_of_sales_by_country__dbt_tmp"
    
    
  as (
    with sales_by_country as (
    select distinct (country.country) country, 
    sum(payment.amount) as total_sales,
    count(customer.customer_id) as total_customers
from country
join city 
on country.country_id = city.country_id
join address
on city.city_id = address.city_id
join customer
on address.address_id = customer.address_id
join payment
on customer.customer_id = payment.customer_id
group by country
order by total_sales desc, total_customers desc
limit 5
)

select *
from sales_by_country
  );
[0m06:22:31.842335 [debug] [Thread-3 (]: Using postgres connection "model.crossborder.top_5_in_demand_genres"
[0m06:22:31.842623 [debug] [Thread-3 (]: On model.crossborder.top_5_in_demand_genres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_5_in_demand_genres"} */

  create view "dvdrental"."transformation"."top_5_in_demand_genres__dbt_tmp"
    
    
  as (
    with genre_movie_demand as (
    select 
        category.name as genre,
        count(customer.customer_id) as total_rent_demand,
        sum(payment.amount) as total_sales
    from category
    join film_category
    using(category_id)
    join film
    using(film_id)
    join inventory
    using(film_id)
    join rental 
    on inventory.inventory_id = rental.inventory_id
    join customer 
    on rental.customer_id = customer.customer_id
    join payment
    on rental.rental_id = payment.rental_id
    group by category.category_id, category.name
    order by total_rent_demand desc, total_sales desc
    limit 5
)

select *
from genre_movie_demand
  );
[0m06:22:31.842883 [debug] [Thread-5 (]: SQL status: BEGIN in 0.0 seconds
[0m06:22:31.843097 [debug] [Thread-5 (]: Using postgres connection "model.crossborder.top_loyal_customers"
[0m06:22:31.843322 [debug] [Thread-5 (]: On model.crossborder.top_loyal_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_loyal_customers"} */

  create view "dvdrental"."transformation"."top_loyal_customers__dbt_tmp"
    
    
  as (
    with customer_activity as (
select 
    customer.first_name,
    customer.last_name,
    concat(country.country, ' | ', city.city, ', ', address.address) as customer_address,
    count(payment.rental_id) as no_of_rentals,
    sum(payment.amount) as total_amount_paid
from rental
join customer
using(customer_id)
join payment
using(customer_id)
left join address 
using(address_id)
left join city
using(city_id)
left join country
using (country_id)
group by 1, 2, 3
order by total_amount_paid desc
)

select *
from customer_activity
  );
[0m06:22:31.846182 [debug] [Thread-2 (]: SQL status: BEGIN in 0.0 seconds
[0m06:22:31.846475 [debug] [Thread-2 (]: Using postgres connection "model.crossborder.rental_perfomance"
[0m06:22:31.846735 [debug] [Thread-2 (]: On model.crossborder.rental_perfomance: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.rental_perfomance"} */

  create view "dvdrental"."transformation"."rental_perfomance__dbt_tmp"
    
    
  as (
    with days_difference as (
    select inventory_id,
    date_part('day', return_date - rental_date) as date_difference
    from rental
    ),

final as (
    select film.film_id,
        case when date_difference < rental_duration then 'Returned early'
        when date_difference = rental_duration then 'Returned on time'
        else 'Returned late'
        end AS return_status
    from film
    join inventory
    using(film_id)
    join days_difference
    USING(inventory_id)
    )

select 
    return_status, 
    count(film_id) total_films
from final
group by return_status
  );
[0m06:22:31.848109 [debug] [Thread-1 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m06:22:31.852515 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.bottom_five_customer_base_by_country"
[0m06:22:31.852742 [debug] [Thread-5 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m06:22:31.852922 [debug] [Thread-2 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m06:22:31.853094 [debug] [Thread-3 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m06:22:31.853264 [debug] [Thread-4 (]: SQL status: CREATE VIEW in 0.0 seconds
[0m06:22:31.853596 [debug] [Thread-1 (]: On model.crossborder.bottom_five_customer_base_by_country: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.bottom_five_customer_base_by_country"} */
alter table "dvdrental"."transformation"."bottom_five_customer_base_by_country" rename to "bottom_five_customer_base_by_country__dbt_backup"
[0m06:22:31.855682 [debug] [Thread-5 (]: Using postgres connection "model.crossborder.top_loyal_customers"
[0m06:22:31.857408 [debug] [Thread-2 (]: Using postgres connection "model.crossborder.rental_perfomance"
[0m06:22:31.859126 [debug] [Thread-3 (]: Using postgres connection "model.crossborder.top_5_in_demand_genres"
[0m06:22:31.860974 [debug] [Thread-4 (]: Using postgres connection "model.crossborder.top_5_volume_of_sales_by_country"
[0m06:22:31.861261 [debug] [Thread-5 (]: On model.crossborder.top_loyal_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_loyal_customers"} */
alter table "dvdrental"."transformation"."top_loyal_customers" rename to "top_loyal_customers__dbt_backup"
[0m06:22:31.861494 [debug] [Thread-2 (]: On model.crossborder.rental_perfomance: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.rental_perfomance"} */
alter table "dvdrental"."transformation"."rental_perfomance" rename to "rental_perfomance__dbt_backup"
[0m06:22:31.861712 [debug] [Thread-3 (]: On model.crossborder.top_5_in_demand_genres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_5_in_demand_genres"} */
alter table "dvdrental"."transformation"."top_5_in_demand_genres" rename to "top_5_in_demand_genres__dbt_backup"
[0m06:22:31.862078 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m06:22:31.862396 [debug] [Thread-4 (]: On model.crossborder.top_5_volume_of_sales_by_country: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_5_volume_of_sales_by_country"} */
alter table "dvdrental"."transformation"."top_5_volume_of_sales_by_country" rename to "top_5_volume_of_sales_by_country__dbt_backup"
[0m06:22:31.864532 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.bottom_five_customer_base_by_country"
[0m06:22:31.864750 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m06:22:31.864955 [debug] [Thread-5 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m06:22:31.865169 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m06:22:31.865386 [debug] [Thread-1 (]: On model.crossborder.bottom_five_customer_base_by_country: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.bottom_five_customer_base_by_country"} */
alter table "dvdrental"."transformation"."bottom_five_customer_base_by_country__dbt_tmp" rename to "bottom_five_customer_base_by_country"
[0m06:22:31.867200 [debug] [Thread-2 (]: Using postgres connection "model.crossborder.rental_perfomance"
[0m06:22:31.867398 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m06:22:31.869019 [debug] [Thread-5 (]: Using postgres connection "model.crossborder.top_loyal_customers"
[0m06:22:31.870699 [debug] [Thread-3 (]: Using postgres connection "model.crossborder.top_5_in_demand_genres"
[0m06:22:31.871248 [debug] [Thread-2 (]: On model.crossborder.rental_perfomance: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.rental_perfomance"} */
alter table "dvdrental"."transformation"."rental_perfomance__dbt_tmp" rename to "rental_perfomance"
[0m06:22:31.871516 [debug] [Thread-1 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m06:22:31.873215 [debug] [Thread-4 (]: Using postgres connection "model.crossborder.top_5_volume_of_sales_by_country"
[0m06:22:31.873445 [debug] [Thread-5 (]: On model.crossborder.top_loyal_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_loyal_customers"} */
alter table "dvdrental"."transformation"."top_loyal_customers__dbt_tmp" rename to "top_loyal_customers"
[0m06:22:31.873677 [debug] [Thread-3 (]: On model.crossborder.top_5_in_demand_genres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_5_in_demand_genres"} */
alter table "dvdrental"."transformation"."top_5_in_demand_genres__dbt_tmp" rename to "top_5_in_demand_genres"
[0m06:22:31.884984 [debug] [Thread-1 (]: On model.crossborder.bottom_five_customer_base_by_country: COMMIT
[0m06:22:31.885211 [debug] [Thread-2 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m06:22:31.885438 [debug] [Thread-4 (]: On model.crossborder.top_5_volume_of_sales_by_country: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_5_volume_of_sales_by_country"} */
alter table "dvdrental"."transformation"."top_5_volume_of_sales_by_country__dbt_tmp" rename to "top_5_volume_of_sales_by_country"
[0m06:22:31.885728 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.bottom_five_customer_base_by_country"
[0m06:22:31.886557 [debug] [Thread-2 (]: On model.crossborder.rental_perfomance: COMMIT
[0m06:22:31.886807 [debug] [Thread-5 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m06:22:31.886995 [debug] [Thread-3 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m06:22:31.887181 [debug] [Thread-1 (]: On model.crossborder.bottom_five_customer_base_by_country: COMMIT
[0m06:22:31.887379 [debug] [Thread-2 (]: Using postgres connection "model.crossborder.rental_perfomance"
[0m06:22:31.887565 [debug] [Thread-4 (]: SQL status: ALTER TABLE in 0.0 seconds
[0m06:22:31.888365 [debug] [Thread-5 (]: On model.crossborder.top_loyal_customers: COMMIT
[0m06:22:31.889159 [debug] [Thread-3 (]: On model.crossborder.top_5_in_demand_genres: COMMIT
[0m06:22:31.889399 [debug] [Thread-2 (]: On model.crossborder.rental_perfomance: COMMIT
[0m06:22:31.890285 [debug] [Thread-4 (]: On model.crossborder.top_5_volume_of_sales_by_country: COMMIT
[0m06:22:31.890512 [debug] [Thread-1 (]: SQL status: COMMIT in 0.0 seconds
[0m06:22:31.890705 [debug] [Thread-5 (]: Using postgres connection "model.crossborder.top_loyal_customers"
[0m06:22:31.890910 [debug] [Thread-3 (]: Using postgres connection "model.crossborder.top_5_in_demand_genres"
[0m06:22:31.891141 [debug] [Thread-4 (]: Using postgres connection "model.crossborder.top_5_volume_of_sales_by_country"
[0m06:22:31.894815 [debug] [Thread-1 (]: Applying DROP to: "dvdrental"."transformation"."bottom_five_customer_base_by_country__dbt_backup"
[0m06:22:31.895041 [debug] [Thread-2 (]: SQL status: COMMIT in 0.0 seconds
[0m06:22:31.895227 [debug] [Thread-5 (]: On model.crossborder.top_loyal_customers: COMMIT
[0m06:22:31.895421 [debug] [Thread-3 (]: On model.crossborder.top_5_in_demand_genres: COMMIT
[0m06:22:31.895613 [debug] [Thread-4 (]: On model.crossborder.top_5_volume_of_sales_by_country: COMMIT
[0m06:22:31.898727 [debug] [Thread-1 (]: Using postgres connection "model.crossborder.bottom_five_customer_base_by_country"
[0m06:22:31.900060 [debug] [Thread-2 (]: Applying DROP to: "dvdrental"."transformation"."rental_perfomance__dbt_backup"
[0m06:22:31.900466 [debug] [Thread-1 (]: On model.crossborder.bottom_five_customer_base_by_country: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.bottom_five_customer_base_by_country"} */
drop view if exists "dvdrental"."transformation"."bottom_five_customer_base_by_country__dbt_backup" cascade
[0m06:22:31.900923 [debug] [Thread-2 (]: Using postgres connection "model.crossborder.rental_perfomance"
[0m06:22:31.901132 [debug] [Thread-3 (]: SQL status: COMMIT in 0.0 seconds
[0m06:22:31.901313 [debug] [Thread-5 (]: SQL status: COMMIT in 0.0 seconds
[0m06:22:31.901508 [debug] [Thread-4 (]: SQL status: COMMIT in 0.0 seconds
[0m06:22:31.901734 [debug] [Thread-2 (]: On model.crossborder.rental_perfomance: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.rental_perfomance"} */
drop view if exists "dvdrental"."transformation"."rental_perfomance__dbt_backup" cascade
[0m06:22:31.903133 [debug] [Thread-3 (]: Applying DROP to: "dvdrental"."transformation"."top_5_in_demand_genres__dbt_backup"
[0m06:22:31.903333 [debug] [Thread-1 (]: SQL status: DROP VIEW in 0.0 seconds
[0m06:22:31.904658 [debug] [Thread-5 (]: Applying DROP to: "dvdrental"."transformation"."top_loyal_customers__dbt_backup"
[0m06:22:31.905962 [debug] [Thread-4 (]: Applying DROP to: "dvdrental"."transformation"."top_5_volume_of_sales_by_country__dbt_backup"
[0m06:22:31.906423 [debug] [Thread-3 (]: Using postgres connection "model.crossborder.top_5_in_demand_genres"
[0m06:22:31.907829 [debug] [Thread-1 (]: On model.crossborder.bottom_five_customer_base_by_country: Close
[0m06:22:31.908282 [debug] [Thread-5 (]: Using postgres connection "model.crossborder.top_loyal_customers"
[0m06:22:31.908704 [debug] [Thread-4 (]: Using postgres connection "model.crossborder.top_5_volume_of_sales_by_country"
[0m06:22:31.908947 [debug] [Thread-3 (]: On model.crossborder.top_5_in_demand_genres: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_5_in_demand_genres"} */
drop view if exists "dvdrental"."transformation"."top_5_in_demand_genres__dbt_backup" cascade
[0m06:22:31.909204 [debug] [Thread-5 (]: On model.crossborder.top_loyal_customers: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_loyal_customers"} */
drop view if exists "dvdrental"."transformation"."top_loyal_customers__dbt_backup" cascade
[0m06:22:31.910093 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8bf579f-30d3-4aa2-89c5-843c32b50ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c67590>]}
[0m06:22:31.910341 [debug] [Thread-4 (]: On model.crossborder.top_5_volume_of_sales_by_country: /* {"app": "dbt", "dbt_version": "1.8.1", "profile_name": "crossborder", "target_name": "dev", "node_id": "model.crossborder.top_5_volume_of_sales_by_country"} */
drop view if exists "dvdrental"."transformation"."top_5_volume_of_sales_by_country__dbt_backup" cascade
[0m06:22:31.910817 [info ] [Thread-1 (]: 1 of 5 OK created sql view model transformation.bottom_five_customer_base_by_country  [[32mCREATE VIEW[0m in 0.15s]
[0m06:22:31.911244 [debug] [Thread-1 (]: Finished running node model.crossborder.bottom_five_customer_base_by_country
[0m06:22:31.915297 [debug] [Thread-4 (]: SQL status: DROP VIEW in 0.0 seconds
[0m06:22:31.916028 [debug] [Thread-4 (]: On model.crossborder.top_5_volume_of_sales_by_country: Close
[0m06:22:31.916231 [debug] [Thread-3 (]: SQL status: DROP VIEW in 0.0 seconds
[0m06:22:31.916438 [debug] [Thread-5 (]: SQL status: DROP VIEW in 0.0 seconds
[0m06:22:31.916718 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8bf579f-30d3-4aa2-89c5-843c32b50ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071b0a50>]}
[0m06:22:31.917378 [debug] [Thread-3 (]: On model.crossborder.top_5_in_demand_genres: Close
[0m06:22:31.918040 [debug] [Thread-5 (]: On model.crossborder.top_loyal_customers: Close
[0m06:22:31.918712 [info ] [Thread-4 (]: 4 of 5 OK created sql view model transformation.top_5_volume_of_sales_by_country  [[32mCREATE VIEW[0m in 0.15s]
[0m06:22:31.919056 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8bf579f-30d3-4aa2-89c5-843c32b50ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c66d90>]}
[0m06:22:31.919384 [debug] [Thread-4 (]: Finished running node model.crossborder.top_5_volume_of_sales_by_country
[0m06:22:31.919619 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8bf579f-30d3-4aa2-89c5-843c32b50ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071b17d0>]}
[0m06:22:31.919828 [debug] [Thread-2 (]: SQL status: DROP VIEW in 0.0 seconds
[0m06:22:31.920188 [info ] [Thread-3 (]: 3 of 5 OK created sql view model transformation.top_5_in_demand_genres ......... [[32mCREATE VIEW[0m in 0.15s]
[0m06:22:31.920602 [info ] [Thread-5 (]: 5 of 5 OK created sql view model transformation.top_loyal_customers ............ [[32mCREATE VIEW[0m in 0.15s]
[0m06:22:31.921383 [debug] [Thread-2 (]: On model.crossborder.rental_perfomance: Close
[0m06:22:31.921717 [debug] [Thread-3 (]: Finished running node model.crossborder.top_5_in_demand_genres
[0m06:22:31.922032 [debug] [Thread-5 (]: Finished running node model.crossborder.top_loyal_customers
[0m06:22:31.922313 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8bf579f-30d3-4aa2-89c5-843c32b50ac9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071ffbd0>]}
[0m06:22:31.922720 [info ] [Thread-2 (]: 2 of 5 OK created sql view model transformation.rental_perfomance .............. [[32mCREATE VIEW[0m in 0.16s]
[0m06:22:31.923031 [debug] [Thread-2 (]: Finished running node model.crossborder.rental_perfomance
[0m06:22:31.923855 [debug] [MainThread]: Using postgres connection "master"
[0m06:22:31.924039 [debug] [MainThread]: On master: BEGIN
[0m06:22:31.924203 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m06:22:31.933620 [debug] [MainThread]: SQL status: BEGIN in 0.0 seconds
[0m06:22:31.933992 [debug] [MainThread]: On master: COMMIT
[0m06:22:31.934169 [debug] [MainThread]: Using postgres connection "master"
[0m06:22:31.934332 [debug] [MainThread]: On master: COMMIT
[0m06:22:31.934629 [debug] [MainThread]: SQL status: COMMIT in 0.0 seconds
[0m06:22:31.934827 [debug] [MainThread]: On master: Close
[0m06:22:31.935093 [debug] [MainThread]: Connection 'master' was properly closed.
[0m06:22:31.935254 [debug] [MainThread]: Connection 'model.crossborder.bottom_five_customer_base_by_country' was properly closed.
[0m06:22:31.935405 [debug] [MainThread]: Connection 'model.crossborder.rental_perfomance' was properly closed.
[0m06:22:31.935555 [debug] [MainThread]: Connection 'model.crossborder.top_5_in_demand_genres' was properly closed.
[0m06:22:31.935694 [debug] [MainThread]: Connection 'model.crossborder.top_5_volume_of_sales_by_country' was properly closed.
[0m06:22:31.935831 [debug] [MainThread]: Connection 'model.crossborder.top_loyal_customers' was properly closed.
[0m06:22:31.936070 [info ] [MainThread]: 
[0m06:22:31.936280 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 0.35 seconds (0.35s).
[0m06:22:31.936942 [debug] [MainThread]: Command end result
[0m06:22:31.956253 [info ] [MainThread]: 
[0m06:22:31.956638 [info ] [MainThread]: [32mCompleted successfully[0m
[0m06:22:31.956836 [info ] [MainThread]: 
[0m06:22:31.957036 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m06:22:31.958829 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7228472, "process_user_time": 1.25476, "process_kernel_time": 0.208939, "process_mem_max_rss": "122322944", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m06:22:31.959294 [debug] [MainThread]: Command `dbt run` succeeded at 06:22:31.959228 after 0.72 seconds
[0m06:22:31.959604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102a62110>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062b7610>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067a7710>]}
[0m06:22:31.959870 [debug] [MainThread]: Flushing usage events
